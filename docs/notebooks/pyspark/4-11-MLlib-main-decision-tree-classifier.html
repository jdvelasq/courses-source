

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Identificación de créditos riesgosos &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Diagnóstico del cáncer de seno usando redes neuronales" href="4-12-MLlib-main-mlp-classifier.html" />
    <link rel="prev" title="Pronóstico de la popularidad de libros" href="4-10-MLlib-main-logistic-regression.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../analitica-de-grandes-datos/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/grades.html">Laboratorios de Programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/course-info.html">Información del curso</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/content.html">Sesiones</a> &raquo;</li>
        
      <li>Identificación de créditos riesgosos</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/pyspark/4-11-MLlib-main-decision-tree-classifier.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Identificación-de-créditos-riesgosos">
<h1>Identificación de créditos riesgosos<a class="headerlink" href="#Identificación-de-créditos-riesgosos" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>60 min</em> | Ultima modificación: Noviembre 5, 2020</p></li>
</ul>
<div class="section" id="Descripción-del-problema">
<h2>Descripción del problema<a class="headerlink" href="#Descripción-del-problema" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las entidades financieras desean mejorar sus procedimientos de aprobación de créditos con el fin de disminuir los riesgos de no pago de la deuda, lo que acarrea pérdidas a la entidad. El problema real consiste en poder decidir si se aprueba o no un crédito particular con base en información que puede ser fácilmente recolectada por teléfono o en la web.</p>
<p>Se tiene una muestra de 1000 observaciones. Cada registro contiene 20 atributos que recopilan información tanto sobre el crédito como sobre la salud financiera del solicitante. La información fue recolectada por una firma alemana y se puede descargar de <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data">https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data</a>).</p>
<p>Los atributos y sus valores son los siguientes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Attribute 1:  (qualitative)
         Status of existing checking account
         A11 :      ... &lt;    0 DM
         A12 : 0 &lt;= ... &lt;  200 DM
         A13 :      ... &gt;= 200 DM /
               salary assignments for at least 1 year
         A14 : no checking account

Attribute 2:  (numerical)
         Duration in month

Attribute 3:  (qualitative)
         Credit history
         A30 : no credits taken/
               all credits paid back duly
         A31 : all credits at this bank paid back duly
         A32 : existing credits paid back duly till now
         A33 : delay in paying off in the past
         A34 : critical account/
               other credits existing (not at this bank)

Attribute 4:  (qualitative)
         Purpose
         A40 : car (new)
         A41 : car (used)
         A42 : furniture/equipment
         A43 : radio/television
         A44 : domestic appliances
         A45 : repairs
         A46 : education
         A47 : (vacation - does not exist?)
         A48 : retraining
         A49 : business
         A410 : others

Attribute 5:  (numerical)
         Credit amount

Attribute 6:  (qualitative)
         Savings account/bonds
         A61 :          ... &lt;  100 DM
         A62 :   100 &lt;= ... &lt;  500 DM
         A63 :   500 &lt;= ... &lt; 1000 DM
         A64 :          .. &gt;= 1000 DM
         A65 :   unknown/ no savings account

Attribute 7:  (qualitative)
         Present employment since
         A71 : unemployed
         A72 :       ... &lt; 1 year
         A73 : 1  &lt;= ... &lt; 4 years
         A74 : 4  &lt;= ... &lt; 7 years
         A75 :       .. &gt;= 7 years

Attribute 8:  (numerical)
         Installment rate in percentage of disposable income

Attribute 9:  (qualitative)
         Personal status and sex
         A91 : male   : divorced/separated
         A92 : female : divorced/separated/married
         A93 : male   : single
         A94 : male   : married/widowed
         A95 : female : single

Attribute 10: (qualitative)
         Other debtors / guarantors
         A101 : none
         A102 : co-applicant
         A103 : guarantor

Attribute 11: (numerical)
         Present residence since

Attribute 12: (qualitative)
         Property
         A121 : real estate
         A122 : if not A121 : building society savings agreement/
                  life insurance
         A123 : if not A121/A122 : car or other, not in attribute 6
         A124 : unknown / no property

Attribute 13: (numerical)
         Age in years

Attribute 14: (qualitative)
         Other installment plans
         A141 : bank
         A142 : stores
         A143 : none

Attribute 15: (qualitative)
         Housing
         A151 : rent
         A152 : own
         A153 : for free

Attribute 16: (numerical)
         Number of existing credits at this bank

Attribute 17: (qualitative)
         Job
         A171 : unemployed/ unskilled  - non-resident
         A172 : unskilled - resident
         A173 : skilled employee / official
         A174 : management/ self-employed/
                highly qualified employee/ officer

Attribute 18: (numerical)
         Number of people being liable to provide maintenance for

Attribute 19: (qualitative)
         Telephone
         A191 : none
         A192 : yes, registered under the customers name

Attribute 20: (qualitative)
         foreign worker
         A201 : yes
         A202 : no
</pre></div>
</div>
</div>
<div class="section" id="Preparación-y-carga-de-datos">
<h2>Preparación y carga de datos<a class="headerlink" href="#Preparación-y-carga-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>wget https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/credit.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--2020-11-01 15:48:59--  https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/credit.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 199.232.48.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|199.232.48.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 133638 (131K) [text/plain]
Saving to: ‘credit.csv.2’

credit.csv.2        100%[===================&gt;] 130.51K  --.-KB/s    in 0.1s

2020-11-01 15:49:00 (974 KB/s) - ‘credit.csv.2’ saved [133638/133638]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Mueve el archivo de datos al hdfs</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -copyFromLocal credit.csv /tmp/credit.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
copyFromLocal: `/tmp/credit.csv&#39;: File exists
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Carga de las librerías de Spark</span>
<span class="c1">##</span>
<span class="kn">import</span> <span class="nn">findspark</span>
<span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span><span class="p">,</span> <span class="n">SparkContext</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>

<span class="n">findspark</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="n">APP_NAME</span> <span class="o">=</span> <span class="s2">&quot;spark-app&quot;</span>

<span class="n">conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="n">APP_NAME</span><span class="p">)</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">)</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Lectura del archivo.</span>
<span class="c1">##</span>
<span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="s2">&quot;/tmp/credit.csv&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Número de registros cargados</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Tipos de datos de los campos del DataFrame</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
root
 |-- checking_balance: string (nullable = true)
 |-- months_loan_duration: integer (nullable = true)
 |-- credit_history: string (nullable = true)
 |-- purpose: string (nullable = true)
 |-- amount: integer (nullable = true)
 |-- savings_balance: string (nullable = true)
 |-- employment_length: string (nullable = true)
 |-- installment_rate: integer (nullable = true)
 |-- personal_status: string (nullable = true)
 |-- other_debtors: string (nullable = true)
 |-- residence_history: integer (nullable = true)
 |-- property: string (nullable = true)
 |-- age: integer (nullable = true)
 |-- installment_plan: string (nullable = true)
 |-- housing: string (nullable = true)
 |-- existing_credits: integer (nullable = true)
 |-- default: integer (nullable = true)
 |-- dependents: integer (nullable = true)
 |-- telephone: string (nullable = true)
 |-- foreign_worker: string (nullable = true)
 |-- job: string (nullable = true)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Contenido del archivo</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+----------------+--------------------+--------------+----------+------+---------------+-----------------+----------------+---------------+-------------+-----------------+--------------------+---+----------------+--------+----------------+-------+----------+---------+--------------+--------------------+
|checking_balance|months_loan_duration|credit_history|   purpose|amount|savings_balance|employment_length|installment_rate|personal_status|other_debtors|residence_history|            property|age|installment_plan| housing|existing_credits|default|dependents|telephone|foreign_worker|                 job|
+----------------+--------------------+--------------+----------+------+---------------+-----------------+----------------+---------------+-------------+-----------------+--------------------+---+----------------+--------+----------------+-------+----------+---------+--------------+--------------------+
|          &lt; 0 DM|                   6|      critical|  radio/tv|  1169|        unknown|          &gt; 7 yrs|               4|    single male|         none|                4|         real estate| 67|            none|     own|               2|      1|         1|      yes|           yes|    skilled employee|
|      1 - 200 DM|                  48|        repaid|  radio/tv|  5951|       &lt; 100 DM|        1 - 4 yrs|               2|         female|         none|                2|         real estate| 22|            none|     own|               1|      2|         1|     none|           yes|    skilled employee|
|         unknown|                  12|      critical| education|  2096|       &lt; 100 DM|        4 - 7 yrs|               2|    single male|         none|                3|         real estate| 49|            none|     own|               1|      1|         2|     none|           yes|  unskilled resident|
|          &lt; 0 DM|                  42|        repaid| furniture|  7882|       &lt; 100 DM|        4 - 7 yrs|               2|    single male|    guarantor|                4|building society ...| 45|            none|for free|               1|      1|         2|     none|           yes|    skilled employee|
|          &lt; 0 DM|                  24|       delayed| car (new)|  4870|       &lt; 100 DM|        1 - 4 yrs|               3|    single male|         none|                4|        unknown/none| 53|            none|for free|               2|      2|         2|     none|           yes|    skilled employee|
|         unknown|                  36|        repaid| education|  9055|        unknown|        1 - 4 yrs|               2|    single male|         none|                4|        unknown/none| 35|            none|for free|               1|      1|         2|      yes|           yes|  unskilled resident|
|         unknown|                  24|        repaid| furniture|  2835|  501 - 1000 DM|          &gt; 7 yrs|               3|    single male|         none|                4|building society ...| 53|            none|     own|               1|      1|         1|     none|           yes|    skilled employee|
|      1 - 200 DM|                  36|        repaid|car (used)|  6948|       &lt; 100 DM|        1 - 4 yrs|               2|    single male|         none|                2|               other| 35|            none|    rent|               1|      1|         1|      yes|           yes|mangement self-em...|
|         unknown|                  12|        repaid|  radio/tv|  3059|      &gt; 1000 DM|        4 - 7 yrs|               2|  divorced male|         none|                4|         real estate| 61|            none|     own|               1|      1|         1|     none|           yes|  unskilled resident|
|      1 - 200 DM|                  30|      critical| car (new)|  5234|       &lt; 100 DM|       unemployed|               4|   married male|         none|                2|               other| 28|            none|     own|               2|      2|         1|     none|           yes|mangement self-em...|
|      1 - 200 DM|                  12|        repaid| car (new)|  1295|       &lt; 100 DM|        0 - 1 yrs|               3|         female|         none|                1|               other| 25|            none|    rent|               1|      2|         1|     none|           yes|    skilled employee|
|          &lt; 0 DM|                  48|        repaid|  business|  4308|       &lt; 100 DM|        0 - 1 yrs|               3|         female|         none|                4|building society ...| 24|            none|    rent|               1|      2|         1|     none|           yes|    skilled employee|
|      1 - 200 DM|                  12|        repaid|  radio/tv|  1567|       &lt; 100 DM|        1 - 4 yrs|               1|         female|         none|                1|               other| 22|            none|     own|               1|      1|         1|      yes|           yes|    skilled employee|
|          &lt; 0 DM|                  24|      critical| car (new)|  1199|       &lt; 100 DM|          &gt; 7 yrs|               4|    single male|         none|                4|               other| 60|            none|     own|               2|      2|         1|     none|           yes|  unskilled resident|
|          &lt; 0 DM|                  15|        repaid| car (new)|  1403|       &lt; 100 DM|        1 - 4 yrs|               2|         female|         none|                4|               other| 28|            none|    rent|               1|      1|         1|     none|           yes|    skilled employee|
|          &lt; 0 DM|                  24|        repaid|  radio/tv|  1282|   101 - 500 DM|        1 - 4 yrs|               4|         female|         none|                2|               other| 32|            none|     own|               1|      2|         1|     none|           yes|  unskilled resident|
|         unknown|                  24|      critical|  radio/tv|  2424|        unknown|          &gt; 7 yrs|               4|    single male|         none|                4|building society ...| 53|            none|     own|               2|      1|         1|     none|           yes|    skilled employee|
|          &lt; 0 DM|                  30|  fully repaid|  business|  8072|        unknown|        0 - 1 yrs|               2|    single male|         none|                3|               other| 25|            bank|     own|               3|      1|         1|     none|           yes|    skilled employee|
|      1 - 200 DM|                  24|        repaid|car (used)| 12579|       &lt; 100 DM|          &gt; 7 yrs|               4|         female|         none|                2|        unknown/none| 44|            none|for free|               1|      2|         1|      yes|           yes|mangement self-em...|
|         unknown|                  24|        repaid|  radio/tv|  3430|  501 - 1000 DM|          &gt; 7 yrs|               3|    single male|         none|                2|               other| 31|            none|     own|               1|      1|         2|      yes|           yes|    skilled employee|
+----------------+--------------------+--------------+----------+------+---------------+-----------------+----------------+---------------+-------------+-----------------+--------------------+---+----------------+--------+----------------+-------+----------+---------+--------------+--------------------+
only showing top 20 rows

</pre></div></div>
</div>
</div>
<div class="section" id="Análisis-Exploratorio">
<h2>Análisis Exploratorio<a class="headerlink" href="#Análisis-Exploratorio" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>pip3 -q install pandas
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Algunas de las columnas son numéricas y</span>
<span class="c1">## las otras son factores.</span>
<span class="c1">## DM corresponde a Deutsche Marks</span>
<span class="c1">## se verifican algunos valores versus el code book.</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;checking_balance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>checking_balance</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>unknown</td>
      <td>394</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt; 0 DM</td>
      <td>274</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&gt; 200 DM</td>
      <td>63</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1 - 200 DM</td>
      <td>269</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">spark_df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;savings_balance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>savings_balance</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>unknown</td>
      <td>183</td>
    </tr>
    <tr>
      <th>1</th>
      <td>101 - 500 DM</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&lt; 100 DM</td>
      <td>603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>501 - 1000 DM</td>
      <td>63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&gt; 1000 DM</td>
      <td>48</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## El monto del préstamo va desde 250 DM hasta 18.424 DM</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;amount&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>summary</th>
      <th>amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>3271.258</td>
    </tr>
    <tr>
      <th>2</th>
      <td>stddev</td>
      <td>2822.736875960441</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>250</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max</td>
      <td>18424</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La duración del préstamo va desde 4 hasta 72 meses</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;months_loan_duration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>summary</th>
      <th>months_loan_duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>20.903</td>
    </tr>
    <tr>
      <th>2</th>
      <td>stddev</td>
      <td>12.058814452756371</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max</td>
      <td>72</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La columna default indica si hubo problemas</span>
<span class="c1">## en el pago del préstamo (1- pago, 2- no pago)</span>
<span class="c1">## esta es la columna que se desea pronosticar</span>
<span class="c1">## 1-si, 2-no</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>summary</th>
      <th>default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>1.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>stddev</td>
      <td>0.4584868702702515</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Reemplaza {1,2} por {0,1}</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">when</span>

<span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">when</span><span class="p">(</span><span class="n">spark_df</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">spark_df</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]))</span>
<span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">when</span><span class="p">(</span><span class="n">spark_df</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">spark_df</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]))</span>

<span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>summary</th>
      <th>default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>stddev</td>
      <td>0.45848687027025153</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Preprocesamiento">
<h2>Preprocesamiento<a class="headerlink" href="#Preprocesamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">StringIndexer</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="s2">&quot;checking_balance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;credit_history&quot;</span><span class="p">,</span>
    <span class="s2">&quot;purpose&quot;</span><span class="p">,</span>
    <span class="s2">&quot;savings_balance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;employment_length&quot;</span><span class="p">,</span>
    <span class="s2">&quot;personal_status&quot;</span><span class="p">,</span>
    <span class="s2">&quot;other_debtors&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property&quot;</span><span class="p">,</span>
    <span class="s2">&quot;installment_plan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;housing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;telephone&quot;</span><span class="p">,</span>
    <span class="s2">&quot;foreign_worker&quot;</span><span class="p">,</span>
    <span class="s2">&quot;job&quot;</span><span class="p">,</span>
<span class="p">]:</span>

    <span class="c1">##</span>
    <span class="c1">## Se construye un codificador para transformar</span>
    <span class="c1">## los strings a enteros (similar a factores en R)</span>
    <span class="c1">##</span>
    <span class="n">stringIndexer</span> <span class="o">=</span> <span class="n">StringIndexer</span><span class="p">(</span>
        <span class="n">inputCol</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
        <span class="n">outputCol</span><span class="o">=</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">##</span>
    <span class="c1">## Se aplica el codificador a las columnas</span>
    <span class="c1">## del dataset</span>
    <span class="c1">##</span>
    <span class="n">spark_df</span> <span class="o">=</span> <span class="n">stringIndexer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spark_df</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">spark_df</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Columnas resultantes</span>
<span class="c1">##</span>
<span class="n">spark_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;checking_balance&#39;, &#39;string&#39;),
 (&#39;months_loan_duration&#39;, &#39;int&#39;),
 (&#39;credit_history&#39;, &#39;string&#39;),
 (&#39;purpose&#39;, &#39;string&#39;),
 (&#39;amount&#39;, &#39;int&#39;),
 (&#39;savings_balance&#39;, &#39;string&#39;),
 (&#39;employment_length&#39;, &#39;string&#39;),
 (&#39;installment_rate&#39;, &#39;int&#39;),
 (&#39;personal_status&#39;, &#39;string&#39;),
 (&#39;other_debtors&#39;, &#39;string&#39;),
 (&#39;residence_history&#39;, &#39;int&#39;),
 (&#39;property&#39;, &#39;string&#39;),
 (&#39;age&#39;, &#39;int&#39;),
 (&#39;installment_plan&#39;, &#39;string&#39;),
 (&#39;housing&#39;, &#39;string&#39;),
 (&#39;existing_credits&#39;, &#39;int&#39;),
 (&#39;default&#39;, &#39;int&#39;),
 (&#39;dependents&#39;, &#39;int&#39;),
 (&#39;telephone&#39;, &#39;string&#39;),
 (&#39;foreign_worker&#39;, &#39;string&#39;),
 (&#39;job&#39;, &#39;string&#39;),
 (&#39;checking_balance_&#39;, &#39;double&#39;),
 (&#39;credit_history_&#39;, &#39;double&#39;),
 (&#39;purpose_&#39;, &#39;double&#39;),
 (&#39;savings_balance_&#39;, &#39;double&#39;),
 (&#39;employment_length_&#39;, &#39;double&#39;),
 (&#39;personal_status_&#39;, &#39;double&#39;),
 (&#39;other_debtors_&#39;, &#39;double&#39;),
 (&#39;property_&#39;, &#39;double&#39;),
 (&#39;installment_plan_&#39;, &#39;double&#39;),
 (&#39;housing_&#39;, &#39;double&#39;),
 (&#39;telephone_&#39;, &#39;double&#39;),
 (&#39;foreign_worker_&#39;, &#39;double&#39;),
 (&#39;job_&#39;, &#39;double&#39;)]
</pre></div></div>
</div>
<div class="section" id="Nombres-de-las-columnas-de-interes">
<h3>Nombres de las columnas de interes<a class="headerlink" href="#Nombres-de-las-columnas-de-interes" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Columnas que contiene el dataframe</span>
<span class="c1">##</span>
<span class="n">inputCols</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">]</span>
<span class="n">inputCols</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;checking_balance&#39;,
 &#39;months_loan_duration&#39;,
 &#39;credit_history&#39;,
 &#39;purpose&#39;,
 &#39;amount&#39;,
 &#39;savings_balance&#39;,
 &#39;employment_length&#39;,
 &#39;installment_rate&#39;,
 &#39;personal_status&#39;,
 &#39;other_debtors&#39;,
 &#39;residence_history&#39;,
 &#39;property&#39;,
 &#39;age&#39;,
 &#39;installment_plan&#39;,
 &#39;housing&#39;,
 &#39;existing_credits&#39;,
 &#39;default&#39;,
 &#39;dependents&#39;,
 &#39;telephone&#39;,
 &#39;foreign_worker&#39;,
 &#39;job&#39;,
 &#39;checking_balance_&#39;,
 &#39;credit_history_&#39;,
 &#39;purpose_&#39;,
 &#39;savings_balance_&#39;,
 &#39;employment_length_&#39;,
 &#39;personal_status_&#39;,
 &#39;other_debtors_&#39;,
 &#39;property_&#39;,
 &#39;installment_plan_&#39;,
 &#39;housing_&#39;,
 &#39;telephone_&#39;,
 &#39;foreign_worker_&#39;,
 &#39;job_&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Elimina las columnas originales y deja solo las transformadas</span>
<span class="c1">##</span>
<span class="n">inputCols</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">inputCols</span> <span class="k">if</span> <span class="n">a</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inputCols</span><span class="p">]</span>
<span class="n">inputCols</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;months_loan_duration&#39;,
 &#39;amount&#39;,
 &#39;installment_rate&#39;,
 &#39;residence_history&#39;,
 &#39;age&#39;,
 &#39;existing_credits&#39;,
 &#39;default&#39;,
 &#39;dependents&#39;,
 &#39;checking_balance_&#39;,
 &#39;credit_history_&#39;,
 &#39;purpose_&#39;,
 &#39;savings_balance_&#39;,
 &#39;employment_length_&#39;,
 &#39;personal_status_&#39;,
 &#39;other_debtors_&#39;,
 &#39;property_&#39;,
 &#39;installment_plan_&#39;,
 &#39;housing_&#39;,
 &#39;telephone_&#39;,
 &#39;foreign_worker_&#39;,
 &#39;job_&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Elimina la columna default</span>
<span class="c1">##</span>
<span class="n">inputCols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="n">inputCols</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;months_loan_duration&#39;,
 &#39;amount&#39;,
 &#39;installment_rate&#39;,
 &#39;residence_history&#39;,
 &#39;age&#39;,
 &#39;existing_credits&#39;,
 &#39;dependents&#39;,
 &#39;checking_balance_&#39;,
 &#39;credit_history_&#39;,
 &#39;purpose_&#39;,
 &#39;savings_balance_&#39;,
 &#39;employment_length_&#39;,
 &#39;personal_status_&#39;,
 &#39;other_debtors_&#39;,
 &#39;property_&#39;,
 &#39;installment_plan_&#39;,
 &#39;housing_&#39;,
 &#39;telephone_&#39;,
 &#39;foreign_worker_&#39;,
 &#39;job_&#39;]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Ensamble-de-las-columnas">
<h2>Ensamble de las columnas<a class="headerlink" href="#Ensamble-de-las-columnas" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">VectorAssembler</span>

<span class="n">vectorAssembler</span> <span class="o">=</span> <span class="n">VectorAssembler</span><span class="p">(</span>
    <span class="n">inputCols</span><span class="o">=</span><span class="n">inputCols</span><span class="p">,</span>
    <span class="n">outputCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">spark_df</span> <span class="o">=</span> <span class="n">vectorAssembler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">spark_df</span><span class="p">)</span>

<span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+--------------------+
|            features|
+--------------------+
|[6.0,1169.0,4.0,4...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|[42.0,7882.0,2.0,...|
|(20,[0,1,2,3,4,5,...|
|[36.0,9055.0,2.0,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|[30.0,5234.0,4.0,...|
|(20,[0,1,2,3,4,5,...|
|[48.0,4308.0,3.0,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|(20,[0,1,2,3,4,5,...|
|[30.0,8072.0,2.0,...|
|[24.0,12579.0,4.0...|
|(20,[0,1,2,3,4,5,...|
+--------------------+
only showing top 20 rows

</pre></div></div>
</div>
<div class="section" id="Conjuntos-de-datos">
<h3>Conjuntos de datos<a class="headerlink" href="#Conjuntos-de-datos" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se usa el 90% de los datos para entrenamiento</span>
<span class="c1">## y el 10% restante para prueba</span>
<span class="c1">##</span>
<span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span><span class="p">)</span> <span class="o">=</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">randomSplit</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Decision-tree-classifier">
<h3>Decision tree classifier<a class="headerlink" href="#Decision-tree-classifier" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Construcción del arbol de clasificación</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.classification</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="c1">##</span>
<span class="c1">## Se construye el arbol</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span>
    <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
    <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction_DTC&quot;</span><span class="p">,</span>
    <span class="n">probabilityCol</span><span class="o">=</span><span class="s1">&#39;probability_DTC&#39;</span><span class="p">,</span>
    <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s1">&#39;rawPrediction_DTC&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Entrenamiento</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Pronóstico</span>
<span class="c1">##</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Métricas de desempeño</span>
<span class="c1">##</span>
<span class="kn">import</span> <span class="nn">pyspark.sql.functions</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.evaluation</span> <span class="kn">import</span> <span class="n">MulticlassMetrics</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">FloatType</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.evaluation</span> <span class="kn">import</span> <span class="n">MulticlassClassificationEvaluator</span>


<span class="k">def</span> <span class="nf">print_stats</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">prediction_col</span><span class="p">):</span>

    <span class="n">evaluator</span> <span class="o">=</span> <span class="n">MulticlassClassificationEvaluator</span><span class="p">(</span>
        <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">predictionCol</span><span class="o">=</span><span class="n">prediction_col</span><span class="p">,</span>
        <span class="n">metricName</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train Error = </span><span class="si">%g</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">train_df</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Error = </span><span class="si">%g</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_df</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">:</span>

        <span class="n">predictionAndLabels</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">prediction_col</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">])</span>
        <span class="n">predictionAndLabels</span> <span class="o">=</span> <span class="n">predictionAndLabels</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="n">prediction_col</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">prediction_col</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">FloatType</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="n">predictionAndLabels</span> <span class="o">=</span> <span class="n">predictionAndLabels</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
            <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">FloatType</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="n">MulticlassMetrics</span><span class="p">(</span><span class="n">predictionAndLabels</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">confusionMatrix</span><span class="p">()</span><span class="o">.</span><span class="n">toArray</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">print_stats</span><span class="p">(</span><span class="n">dataframes</span><span class="o">=</span><span class="p">[</span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span><span class="p">],</span> <span class="n">prediction_col</span> <span class="o">=</span> <span class="s1">&#39;prediction_DTC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train Error = 0.209071
Test Error = 0.270833

[[604.  32.]
 [157. 111.]]

[[57.  7.]
 [19. 13.]]

</pre></div></div>
</div>
</div>
<div class="section" id="Random-forest-classifier">
<h3>Random forest classifier<a class="headerlink" href="#Random-forest-classifier" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Construcción del arbol de clasificación</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.classification</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1">##</span>
<span class="c1">## Se construye el arbol</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span>
    <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
    <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction_RFC&quot;</span><span class="p">,</span>
    <span class="n">probabilityCol</span><span class="o">=</span><span class="s1">&#39;probability_RFC&#39;</span><span class="p">,</span>
    <span class="n">rawPredictionCol</span><span class="o">=</span><span class="s1">&#39;rawPrediction_RFC&#39;</span><span class="p">,</span>
    <span class="n">numTrees</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Entrenamiento</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Pronóstico</span>
<span class="c1">##</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>

<span class="n">print_stats</span><span class="p">(</span><span class="n">dataframes</span><span class="o">=</span><span class="p">[</span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span><span class="p">],</span> <span class="n">prediction_col</span> <span class="o">=</span> <span class="s1">&#39;prediction_RFC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train Error = 0.19469
Test Error = 0.25

[[624.  12.]
 [164. 104.]]

[[63.  1.]
 [23.  9.]]

</pre></div></div>
</div>
</div>
<div class="section" id="Gradient-boosted-tree-classifier">
<h3>Gradient-boosted tree classifier<a class="headerlink" href="#Gradient-boosted-tree-classifier" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Construcción del arbol de clasificación</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.classification</span> <span class="kn">import</span> <span class="n">GBTClassifier</span>

<span class="c1">##</span>
<span class="c1">## Se construye el arbol</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">GBTClassifier</span><span class="p">(</span>
    <span class="n">featuresCol</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span>
    <span class="n">labelCol</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">predictionCol</span><span class="o">=</span><span class="s2">&quot;prediction_GBTC&quot;</span><span class="p">,</span>
    <span class="n">maxIter</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Entrenamiento</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Pronóstico</span>
<span class="c1">##</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>

<span class="n">print_stats</span><span class="p">(</span><span class="n">dataframes</span><span class="o">=</span><span class="p">[</span><span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span><span class="p">],</span> <span class="n">prediction_col</span> <span class="o">=</span> <span class="s1">&#39;prediction_GBTC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train Error = 0.0752212
Test Error = 0.21875

[[616.  20.]
 [ 48. 220.]]

[[56.  8.]
 [13. 19.]]

</pre></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>