

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Estimación de parámetros óptimos en modelos de regresión usando R &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Uso de TensorBoard desde R" href="tensorboard-en-r.html" />
    <link rel="prev" title="Ejecución de TensorFlow en R" href="fundamentos-de-tensorflow-en-r.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a> &raquo;</li>
        
          <li><a href="../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a> &raquo;</li>
        
      <li>Estimación de parámetros óptimos en modelos de regresión usando R</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/tensorflow-in-r/estimacion-de-parametros-optimos-en-modelos-de-regresion-R.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Estimación-de-parámetros-óptimos-en-modelos-de-regresión-usando-R">
<h1>Estimación de parámetros óptimos en modelos de regresión usando R<a class="headerlink" href="#Estimación-de-parámetros-óptimos-en-modelos-de-regresión-usando-R" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Tal como se indicó en el documento anterior, las técnicas de optimización basadas en el gradiente son comúnmente usadas en la optimización de muchos tipos de modelos de redes neuronales. En este documento se aborda el proceso de obtención de parámetros para un modelo de regresión lineal usando gradientes. De esta forma, es posible ilustrar el proceso de obtención de parámetros óptimos de un modelo mediante la minimización de una función de pérdida, que corresponde al mismo procedimiento
comúnmente utilizado en redes neuronales artificiales.</p>
<p>Al finalizar este documento, el lector estará en capacidad de:</p>
<ul class="simple">
<li><p>Describir el modelo matemático y la operación de la optimización del gradiente aplicado a un modelo de regresión.</p></li>
<li><p>Implementar la optimización del gradiente aplicado a regresión en R.</p></li>
<li><p>Reconocer la diferencia entre el aprendizaje Batch y el aprendizaje Online.</p></li>
</ul>
<div class="section" id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se tienen los resultados de un conjunto de datos que relacionan las variables <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(d\)</span>, a partir de los cuales se desea derivar un modelo para pronosticar <span class="math notranslate nohighlight">\(d\)</span> en función de nuevos valores de <span class="math notranslate nohighlight">\(x\)</span>. Específicamente, se desean encontra los parámetros <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span> del siguiente modelo de regresión entre las variables <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span>:</p>
<div class="math notranslate nohighlight">
\[y = w_1 x + w_0 + e\]</div>
<p>a partir de la siguiente tabla de observaciones, donde <span class="math notranslate nohighlight">\(d\)</span> es el valor real o deseado, <span class="math notranslate nohighlight">\(x\)</span> es la variable independiente, <span class="math notranslate nohighlight">\(y\)</span> es su aproximación usando el modelo de regresión descrito, y <span class="math notranslate nohighlight">\(e\)</span> es el error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">x</span>         <span class="n">d</span>
<span class="o">----------------</span>
<span class="mf">0.1087</span>    <span class="mf">0.9519</span>
<span class="mf">0.2698</span>    <span class="mf">1.1237</span>
<span class="mf">0.3765</span>    <span class="mf">1.2360</span>
<span class="mf">0.2146</span>    <span class="mf">1.0526</span>
<span class="mf">0.9155</span>    <span class="mf">2.0743</span>
<span class="mf">0.0246</span>    <span class="mf">0.7906</span>
<span class="mf">0.0221</span>    <span class="mf">0.7603</span>
<span class="mf">0.8632</span>    <span class="mf">2.0533</span>
<span class="mf">0.6460</span>    <span class="mf">1.6887</span>
<span class="mf">0.2092</span>    <span class="mf">1.0563</span>
<span class="mf">0.8567</span>    <span class="mf">2.0991</span>
<span class="mf">0.1591</span>    <span class="mf">0.8953</span>
<span class="mf">0.9647</span>    <span class="mf">2.1917</span>
<span class="mf">0.6231</span>    <span class="mf">1.6266</span>
<span class="mf">0.7460</span>    <span class="mf">1.8508</span>
<span class="mf">0.3654</span>    <span class="mf">1.2828</span>
<span class="mf">0.3065</span>    <span class="mf">1.2283</span>
<span class="mf">0.6886</span>    <span class="mf">1.8722</span>
<span class="mf">0.4966</span>    <span class="mf">1.4657</span>
<span class="mf">0.2008</span>    <span class="mf">1.0418</span>
<span class="mf">0.2618</span>    <span class="mf">1.1097</span>
<span class="mf">0.7607</span>    <span class="mf">1.7826</span>
<span class="mf">0.1563</span>    <span class="mf">0.9711</span>
<span class="mf">0.4424</span>    <span class="mf">1.4267</span>
<span class="mf">0.7731</span>    <span class="mf">1.8248</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## A continuación se cargan los valores a R para su</span>
<span class="c1">## uso posterior</span>
<span class="c1">##</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.1087</span><span class="p">,</span>  <span class="m">0.2698</span><span class="p">,</span>  <span class="m">0.3765</span><span class="p">,</span>  <span class="m">0.2146</span><span class="p">,</span>  <span class="m">0.9155</span><span class="p">,</span>
       <span class="m">0.0246</span><span class="p">,</span>  <span class="m">0.0221</span><span class="p">,</span>  <span class="m">0.8632</span><span class="p">,</span>  <span class="m">0.6460</span><span class="p">,</span>  <span class="m">0.2092</span><span class="p">,</span>
       <span class="m">0.8567</span><span class="p">,</span>  <span class="m">0.1591</span><span class="p">,</span>  <span class="m">0.9647</span><span class="p">,</span>  <span class="m">0.6231</span><span class="p">,</span>  <span class="m">0.7460</span><span class="p">,</span>
       <span class="m">0.3654</span><span class="p">,</span>  <span class="m">0.3065</span><span class="p">,</span>  <span class="m">0.6886</span><span class="p">,</span>  <span class="m">0.4966</span><span class="p">,</span>  <span class="m">0.2008</span><span class="p">,</span>
       <span class="m">0.2618</span><span class="p">,</span>  <span class="m">0.7607</span><span class="p">,</span>  <span class="m">0.1563</span><span class="p">,</span>  <span class="m">0.4424</span><span class="p">,</span>  <span class="m">0.7731</span><span class="p">)</span>

<span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.9519</span><span class="p">,</span>  <span class="m">1.1237</span><span class="p">,</span>  <span class="m">1.2360</span><span class="p">,</span>  <span class="m">1.0526</span><span class="p">,</span>  <span class="m">2.0743</span><span class="p">,</span>
       <span class="m">0.7906</span><span class="p">,</span>  <span class="m">0.7603</span><span class="p">,</span>  <span class="m">2.0533</span><span class="p">,</span>  <span class="m">1.6887</span><span class="p">,</span>  <span class="m">1.0563</span><span class="p">,</span>
       <span class="m">2.0991</span><span class="p">,</span>  <span class="m">0.8953</span><span class="p">,</span>  <span class="m">2.1917</span><span class="p">,</span>  <span class="m">1.6266</span><span class="p">,</span>  <span class="m">1.8508</span><span class="p">,</span>
       <span class="m">1.2828</span><span class="p">,</span>  <span class="m">1.2283</span><span class="p">,</span>  <span class="m">1.8722</span><span class="p">,</span>  <span class="m">1.4657</span><span class="p">,</span>  <span class="m">1.0418</span><span class="p">,</span>
       <span class="m">1.1097</span><span class="p">,</span>  <span class="m">1.7826</span><span class="p">,</span>  <span class="m">0.9711</span><span class="p">,</span>  <span class="m">1.4267</span><span class="p">,</span>  <span class="m">1.8248</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Solución">
<h2>Solución<a class="headerlink" href="#Solución" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Definición-del-problema-matemático">
<h3>Definición del problema matemático<a class="headerlink" href="#Definición-del-problema-matemático" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En un modelo de regresión se desean encontrar los parámetros <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span> de la recta</p>
<div class="math notranslate nohighlight">
\[y_i = w_0 + w_1 * x_i\]</div>
<p>que minimicen la suma de los errores cuadráticos entre el valor real <span class="math notranslate nohighlight">\(d_i\)</span> y el valor pronósticado <span class="math notranslate nohighlight">\(y_i\)</span> para cada valor posible de la variable <span class="math notranslate nohighlight">\(x_i\)</span>, tal como se ilustra en la gráfica de abajo. El error <span class="math notranslate nohighlight">\(e_i\)</span> se define como <span class="math notranslate nohighlight">\(d_i - y_i\)</span>.</p>
<p><img alt="reg" src="../../_images/OptimLinReg-01.jpg" /></p>
<p>Esto es, se desea encontrar la combinación de parámetros <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span> que minimice:</p>
<div class="math notranslate nohighlight">
\[\text{SSE} = \sum_i (d_i - y_i)^2 = \sum_i (d_i - (w_0 + w_1 x_i))^2\]</div>
<p>Note que en la ecuación anterior, los valores de <span class="math notranslate nohighlight">\(x_i\)</span> y <span class="math notranslate nohighlight">\(d_i\)</span> son constantes que corresponden a la tabla de datos presentada en la formulación del problema, mientras que las variables son <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span>, de tal forma que:</p>
<div class="math notranslate nohighlight">
\[\text{SSE}(w_0, w_1) = \sum_i (d_i - w_0 - w_1 x_i)^2\]</div>
</div>
<div class="section" id="Implementación-de-la-función-de-pérdida">
<h3>Implementación de la función de pérdida<a class="headerlink" href="#Implementación-de-la-función-de-pérdida" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La ecuación anterior (SSE) retorna la suma del error cuadrático para diferentes valores de <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span>, calculada sobre el conjunto de datos existentes. Su implementación computacional es la siguiente:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Sumatoria del error cuadrático</span>
<span class="c1">##</span>
<span class="n">SSE</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">sum</span><span class="p">((</span><span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="n">w0</span> <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span><span class="n">^2</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Forma-de-la-superficie-de-la-función-de-pérdida-(SSE)">
<h3>Forma de la superficie de la función de pérdida (SSE)<a class="headerlink" href="#Forma-de-la-superficie-de-la-función-de-pérdida-(SSE)" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ya que la función SSE depende únicamente de los valores de <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span>, es posible graficar su forma.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">f.3D</span> <span class="o">&lt;-</span>
<span class="nf">function</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">30</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&quot;gray85&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">K</span> <span class="o">&lt;-</span> <span class="m">30</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-0.5</span><span class="p">,</span> <span class="m">3.0</span><span class="p">,</span> <span class="m">3.5</span> <span class="o">/</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-0.5</span><span class="p">,</span> <span class="m">3.0</span><span class="p">,</span> <span class="m">3.5</span> <span class="o">/</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">outer</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="nf">Vectorize</span><span class="p">(</span><span class="n">SSE</span><span class="p">))</span>
    <span class="nf">palette</span><span class="p">(</span><span class="nf">gray</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">20</span> <span class="o">/</span> <span class="m">20</span><span class="p">))</span>
    <span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">repr.plot.height</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
    <span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
    <span class="nf">persp</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">shade</span> <span class="o">=</span> <span class="n">s</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">f.3D</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_15_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_15_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Contorno</span>
<span class="c1">##</span>
<span class="n">plot_contour</span> <span class="o">&lt;-</span>
<span class="nf">function</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">K</span> <span class="o">&lt;-</span> <span class="m">30</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-0.5</span><span class="p">,</span> <span class="m">3.0</span><span class="p">,</span> <span class="m">3.5</span> <span class="o">/</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-0.5</span><span class="p">,</span> <span class="m">3.0</span><span class="p">,</span> <span class="m">3.5</span> <span class="o">/</span> <span class="n">K</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">outer</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="nf">Vectorize</span><span class="p">(</span><span class="n">SSE</span><span class="p">))</span>
    <span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">repr.plot.height</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
    <span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
    <span class="nf">par</span><span class="p">(</span><span class="n">pty</span><span class="o">=</span><span class="s">&quot;s&quot;</span><span class="p">)</span>
    <span class="nf">contour</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="m">60</span><span class="p">,</span> <span class="m">90</span><span class="p">))</span>
<span class="p">}</span>
<span class="nf">plot_contour</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_16_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_16_0.png" />
</div>
</div>
<p>En términos de optimización, se desea encontrar las coordenadas <span class="math notranslate nohighlight">\((w_0, w_1)\)</span> del punto más bajo (error mínimo) de la superficie de error.</p>
</div>
<div class="section" id="Minimización-numérica">
<h3>Minimización numérica<a class="headerlink" href="#Minimización-numérica" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para realizar la optimización numérica de la función <span class="math notranslate nohighlight">\(\text{SSE}(w_0, w_1)\)</span> se utiliza el método del gradiente descendente. Para iniciar, los parámetros <span class="math notranslate nohighlight">\(w_0\)</span> y <span class="math notranslate nohighlight">\(w_1\)</span> se agrupan en el vector de parámetros <span class="math notranslate nohighlight">\(\mathbf{w}=[w_0, w_1]'\)</span>, tal que:</p>
<div class="math notranslate nohighlight">
\[\text{SSE}(w_0, w_1) = \text{SSE}(\mathbf{w})\]</div>
<p>Ahora, como el método es iterativo, se parte de un vector de valores aleatorios, el cual es mejorado en cada iteración, de tal forma que con los valores de <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> en la iteración <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(\mathbf{w}_k\)</span> se obtienen a partir de los valores en la iteración <span class="math notranslate nohighlight">\(k-1\)</span> como:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_k = \mathbf{w}_{k-1} - \mu \frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})\]</div>
<p>donde <span class="math notranslate nohighlight">\(\mu\)</span> se define como el tamaño de paso o coeficiente de aprendizaje. Note que</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{w}_k = \left[
  \begin{array}{c}
  w_0
  \\
  w_1
  \end{array}
\right]_k
=
\left[
  \begin{array}{c}
  w_{0,k}
  \\
  w_{1,k}
  \end{array}
\right]\end{split}\]</div>
</div>
<div class="section" id="Derivación-del-gradiente-algebraico">
<h3>Derivación del gradiente algebraico<a class="headerlink" href="#Derivación-del-gradiente-algebraico" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El gradiente de la función de error se calcula como:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1}) =
\left[
  \begin{array}{c}
  \sum_i \frac{d}{d w_0} [d_i - w_{0,k-1} - w_{1,k-1} x_i]^2
  \\
  \sum_i \frac{d}{d w_1} [d_i - w_{0,k-1} - w_{1,k-1} x_i]^2
  \end{array}
\right]
=
\left[
  \begin{array}{c}
  \sum_i 2 [d_i - w_{0,k-1} - w_{1,k-1} x_i](-1)
  \\
  \sum_i 2 [d_i - w_{0,k-1} - w_{1,k-1} x_i] (-x_i)
  \end{array}
\right]\end{split}\]</div>
<p>Si se tiene en cuenta que <span class="math notranslate nohighlight">\(e_{i,k-1} = d_i - w_{0,k-1} - w_{1,k-1} x_i\)</span>, entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}) =
\left[
  \begin{array}{c}
  -2 \sum_i  e_{i,k-1}
  \\
  -2 \sum_i  e_{i,k-1} x_i
  \end{array}
\right]\end{split}\]</div>
</div>
<div class="section" id="Implementación-del-cómputo-del-gradiente">
<h3>Implementación del cómputo del gradiente<a class="headerlink" href="#Implementación-del-cómputo-del-gradiente" title="Enlazar permanentemente con este título">¶</a></h3>
<p>De esta forma, la función que computa el gradiente se implementa como:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">gSSE</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">## calculo del error</span>
    <span class="n">e</span> <span class="o">&lt;-</span> <span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="n">w0</span> <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1">## gradientes</span>
    <span class="n">gw0</span> <span class="o">&lt;-</span> <span class="m">-2</span> <span class="o">*</span> <span class="nf">sum</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">gw1</span> <span class="o">&lt;-</span> <span class="m">-2</span> <span class="o">*</span> <span class="nf">sum</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

    <span class="nf">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span><span class="p">))</span>
<span class="p">}</span>
<span class="nf">gSSE</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="c1">## se verifica que la implementación sea correcta</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ol class=list-inline>
    <li>-48.0098</li>
    <li>-24.14473716</li>
</ol></div>
</div>
</div>
<div class="section" id="Proceso-iterativo-de-mejora-de-los-pesos">
<h3>Proceso iterativo de mejora de los pesos<a class="headerlink" href="#Proceso-iterativo-de-mejora-de-los-pesos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>A partir de las definiciones y cómputos anteriores, es posible implementar el proceso iterativo de mejora de los pesos usando la ecuación:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_k = \mathbf{w}_{k-1} - \mu \frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">mejora</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">## evalua la función de error en el punto actual</span>
    <span class="n">r</span> <span class="o">&lt;-</span> <span class="nf">gSSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>

    <span class="c1">## extrae las componentes del gradiente</span>
    <span class="n">gW0</span> <span class="o">&lt;-</span> <span class="n">r[1]</span>
    <span class="n">gW1</span> <span class="o">&lt;-</span> <span class="n">r[2]</span>

    <span class="c1">## computa las mejoras de cada w</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gW0</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">w1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gW1</span>

    <span class="c1">## retorna el nuevo w mejorado</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Optimización-numérica-usando-el-gradiente">
<h3>Optimización numérica usando el gradiente<a class="headerlink" href="#Optimización-numérica-usando-el-gradiente" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para realizar la optimización numérica, se parte de unos pesos iniciales aleatorios. Para efectos ilustrativos se supondra que <span class="math notranslate nohighlight">\(w_0 = 0.5\)</span> y <span class="math notranslate nohighlight">\(w_1 = 3.0\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Punto de inicio</span>
<span class="n">w0</span> <span class="o">&lt;-</span> <span class="m">0.5</span>
<span class="n">w1</span> <span class="o">&lt;-</span> <span class="m">3.0</span>

<span class="c1">## Valores en cada iteración</span>
<span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
<span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
<span class="n">history_f</span>  <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">SSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>

<span class="c1">## Se realizan 20 iteraciones</span>
<span class="nf">for</span><span class="p">(</span> <span class="n">epoch</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">## Este es propiamente el proceso de</span>
    <span class="c1">## optimización. La tasa de aprendizaje</span>
    <span class="c1">## es 0.03</span>
    <span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="m">0.03</span><span class="p">)</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">w[1]</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">w[2]</span>

    <span class="c1">## Se alamcenan los valores calculados</span>
    <span class="c1">## en cada iteración</span>
    <span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">)</span>
    <span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
    <span class="n">history_f</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="nf">SSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">## Se imprime y se grafican los valores encontrados</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&#39;\nValores encontrados\n\n  w0 = &#39;</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="s">&#39;\n  w1 = &#39;</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
<span class="nf">plot_contour</span><span class="p">()</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 =  0.6755312
  w1 =  1.643269
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_30_1.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_30_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;l&#39;</span><span class="p">);</span> <span class="nf">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_31_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_31_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">##  A continuación se grafican la recta</span>
<span class="c1">##  de mínimos cuadrados encontrada.</span>
<span class="c1">##</span>

<span class="c1">##  Se generan los puntos</span>
<span class="n">z</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">to</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">length.out</span> <span class="o">=</span> <span class="m">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="n">w0</span> <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">z</span>

<span class="c1">## se grafican los datos originales</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">);</span>

<span class="c1">## se grafica la recta encontrada</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_32_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_32_0.png" />
</div>
</div>
</div>
<div class="section" id="Implementación-usando-TensorFlow">
<h3>Implementación usando TensorFlow<a class="headerlink" href="#Implementación-usando-TensorFlow" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Borra el directorio de trabajo en cada corrida</span>
<span class="c1">##</span>
<span class="nf">system</span><span class="p">(</span><span class="s">&quot;rm -rf /tmp/example&quot;</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">##  Preparación</span>
<span class="c1">##</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tensorflow</span><span class="p">)</span>

<span class="c1">## Crea una gráfica</span>
<span class="n">graph</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">Graph</span><span class="p">()</span>

<span class="nf">with</span><span class="p">(</span><span class="n">graph</span><span class="o">$</span><span class="nf">as_default</span><span class="p">(),</span> <span class="p">{</span>
    <span class="c1">##</span>
    <span class="c1">## datos</span>
    <span class="c1">##</span>
    <span class="n">x_</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">d_</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">constant</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="c1">## parámetros</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">Variable</span><span class="p">(</span><span class="m">2.5</span><span class="p">)</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">Variable</span><span class="p">(</span><span class="m">2.5</span><span class="p">)</span>

    <span class="c1">## Define el modelo</span>
    <span class="n">m</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">add</span><span class="p">(</span><span class="n">tf</span><span class="o">$</span><span class="nf">multiply</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">w1</span><span class="p">),</span> <span class="n">w0</span><span class="p">)</span>

    <span class="c1">## Define la función de error</span>
    <span class="n">sse</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">$</span><span class="nf">square</span><span class="p">(</span><span class="n">d_</span> <span class="o">-</span> <span class="n">m</span><span class="p">))</span> <span class="c1"># sum of the squared errors</span>

    <span class="c1">## Hace un resumen del SSE</span>
    <span class="n">tf</span><span class="o">$</span><span class="n">summary</span><span class="o">$</span><span class="nf">scalar</span><span class="p">(</span><span class="s">&#39;SSE&#39;</span><span class="p">,</span> <span class="n">sse</span><span class="p">)</span>
    <span class="n">resumen</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="n">summary</span><span class="o">$</span><span class="nf">merge_all</span><span class="p">()</span>

    <span class="c1">## Inicializa el optimizador</span>
    <span class="n">optimizer</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="n">train</span><span class="o">$</span><span class="nf">GradientDescentOptimizer</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="m">0.03</span><span class="p">)</span>

    <span class="c1">## Minimiza la función de error</span>
    <span class="n">opt</span> <span class="o">&lt;-</span> <span class="n">optimizer</span><span class="o">$</span><span class="nf">minimize</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

    <span class="c1">## Ejecución. Crea una sesión para realizar los cómputos</span>
    <span class="n">sess</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="nf">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

    <span class="c1">## Crea el directorio donde se almacenarán los resultados</span>
    <span class="n">writer</span> <span class="o">&lt;-</span> <span class="n">tf</span><span class="o">$</span><span class="n">summary</span><span class="o">$</span><span class="nf">FileWriter</span><span class="p">(</span><span class="s">&#39;/tmp/example&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>

    <span class="c1">## estima el modelo</span>
    <span class="nf">with</span><span class="p">(</span><span class="n">tf</span><span class="o">$</span><span class="nf">Session</span><span class="p">()</span> <span class="o">%as%</span> <span class="n">sess</span><span class="p">,</span> <span class="p">{</span>
        <span class="n">sess</span><span class="o">$</span><span class="nf">run</span><span class="p">(</span><span class="n">tf</span><span class="o">$</span><span class="nf">global_variables_initializer</span><span class="p">())</span>
        <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">){</span>
            <span class="n">summary</span> <span class="o">&lt;-</span> <span class="n">sess</span><span class="o">$</span><span class="nf">run</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">resumen</span><span class="p">))</span>
            <span class="n">writer</span><span class="o">$</span><span class="nf">add_summary</span><span class="p">(</span><span class="n">summary[[2]]</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">cat</span><span class="p">(</span><span class="s">&#39;\nValores encontrados\n\n  w0 =&#39;</span><span class="p">,</span> <span class="n">sess</span><span class="o">$</span><span class="nf">run</span><span class="p">(</span><span class="n">w0</span><span class="p">),</span> <span class="s">&#39;\n  w1 = &#39;</span><span class="p">,</span><span class="n">sess</span><span class="o">$</span><span class="nf">run</span><span class="p">(</span><span class="n">w1</span><span class="p">))</span>
    <span class="p">})</span>
    <span class="n">writer</span><span class="o">$</span><span class="nf">flush</span><span class="p">()</span>
    <span class="n">writer</span><span class="o">$</span><span class="nf">close</span><span class="p">()</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 = 0.7803193
  w1 =  1.535985
</pre></div></div>
</div>
<p>La gráfica de flujo de datos generada es la siguiente:</p>
<p><img alt="OptimModReg-01.pgn" src="../../_images/OptimModReg-01.png" /></p>
<p>La evolución del SSE por iteración es:</p>
<p><img alt="OptimModReg-02.pgn" src="../../_images/OptimModReg-02.png" /></p>
</div>
<div class="section" id="Aprendizaje-Batch-vs-Aprendizaje-Online">
<h3>Aprendizaje Batch vs Aprendizaje Online<a class="headerlink" href="#Aprendizaje-Batch-vs-Aprendizaje-Online" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En aprendizaje de máquinas, el término <em>Batch</em> se refiere a que los parámetros del modelo son actualizados con base a una corrección neta computada sobre todo el conjunto de datos de entrenamiento; este es el caso presentado en este documento, para el cual</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_k
 = \mathbf{w}_{k-1} - \mu \frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})
 = \mathbf{w}_{k-1} - \mu  \sum_i \frac{\partial}{\partial \mathbf{w}} (d_i - w_{0,k-1} - w_{1, k-1} x_i)^2\]</div>
<p>Sin embargo, el algoritmo del gradiente también puede ser usado con el error instantáneo para el conjunto de entrada <span class="math notranslate nohighlight">\(i\)</span>, o <span class="math notranslate nohighlight">\(e_{i,k}(w_{0,i,k}, w_{1,i,k}) = d_i - w_{0,i,k-1} - w_{1,i,k-1}\)</span> que es una función dependiente del vector <span class="math notranslate nohighlight">\(\mathbf{w}\)</span>. De esta forma, la correción de los parámetros se realizar por cada patrón o ejemplo <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_{i,k}
  = \mathbf{w}_{i,k-1} - \mu \frac{\partial}{\partial \mathbf{w}} e_{i,k-1}^2(\mathbf{w}_{i, k-1})\]</div>
<p>La ecuación anterior simplemente significa que se computa la corrección para un patrón o ejemplo <span class="math notranslate nohighlight">\(i\)</span> para los parámetros actuales; luego, se actualizan los parámetros, y se procede a presentar otro patrón a la red.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Datos</span>
<span class="c1">##</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.1087</span><span class="p">,</span>  <span class="m">0.2698</span><span class="p">,</span>  <span class="m">0.3765</span><span class="p">,</span>  <span class="m">0.2146</span><span class="p">,</span>  <span class="m">0.9155</span><span class="p">,</span>
       <span class="m">0.0246</span><span class="p">,</span>  <span class="m">0.0221</span><span class="p">,</span>  <span class="m">0.8632</span><span class="p">,</span>  <span class="m">0.6460</span><span class="p">,</span>  <span class="m">0.2092</span><span class="p">,</span>
       <span class="m">0.8567</span><span class="p">,</span>  <span class="m">0.1591</span><span class="p">,</span>  <span class="m">0.9647</span><span class="p">,</span>  <span class="m">0.6231</span><span class="p">,</span>  <span class="m">0.7460</span><span class="p">,</span>
       <span class="m">0.3654</span><span class="p">,</span>  <span class="m">0.3065</span><span class="p">,</span>  <span class="m">0.6886</span><span class="p">,</span>  <span class="m">0.4966</span><span class="p">,</span>  <span class="m">0.2008</span><span class="p">,</span>
       <span class="m">0.2618</span><span class="p">,</span>  <span class="m">0.7607</span><span class="p">,</span>  <span class="m">0.1563</span><span class="p">,</span>  <span class="m">0.4424</span><span class="p">,</span>  <span class="m">0.7731</span><span class="p">)</span>

<span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.9519</span><span class="p">,</span>  <span class="m">1.1237</span><span class="p">,</span>  <span class="m">1.2360</span><span class="p">,</span>  <span class="m">1.0526</span><span class="p">,</span>  <span class="m">2.0743</span><span class="p">,</span>
       <span class="m">0.7906</span><span class="p">,</span>  <span class="m">0.7603</span><span class="p">,</span>  <span class="m">2.0533</span><span class="p">,</span>  <span class="m">1.6887</span><span class="p">,</span>  <span class="m">1.0563</span><span class="p">,</span>
       <span class="m">2.0991</span><span class="p">,</span>  <span class="m">0.8953</span><span class="p">,</span>  <span class="m">2.1917</span><span class="p">,</span>  <span class="m">1.6266</span><span class="p">,</span>  <span class="m">1.8508</span><span class="p">,</span>
       <span class="m">1.2828</span><span class="p">,</span>  <span class="m">1.2283</span><span class="p">,</span>  <span class="m">1.8722</span><span class="p">,</span>  <span class="m">1.4657</span><span class="p">,</span>  <span class="m">1.0418</span><span class="p">,</span>
       <span class="m">1.1097</span><span class="p">,</span>  <span class="m">1.7826</span><span class="p">,</span>  <span class="m">0.9711</span><span class="p">,</span>  <span class="m">1.4267</span><span class="p">,</span>  <span class="m">1.8248</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">##  Calcula el gradiente para el punto actual (u, v)</span>
<span class="c1">##</span>
<span class="n">gOnline</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">){</span>

    <span class="c1">## calcula el vector de errores</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span>

    <span class="c1">## gradientes</span>
    <span class="n">gw0</span> <span class="o">=</span> <span class="m">-2</span> <span class="o">*</span> <span class="n">e</span>
    <span class="n">gw1</span> <span class="o">=</span> <span class="m">-2</span> <span class="o">*</span> <span class="n">e</span> <span class="o">*</span> <span class="n">u</span>

    <span class="nf">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span><span class="p">))</span>
<span class="p">}</span>

<span class="n">mejora</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">mu</span><span class="p">){</span>

    <span class="c1">## computa el gradiente para los parámetros actuales</span>
    <span class="n">gw</span> <span class="o">&lt;-</span> <span class="nf">gOnline</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
    <span class="n">gw0</span> <span class="o">&lt;-</span> <span class="n">gw[1]</span>
    <span class="n">gw1</span> <span class="o">&lt;-</span> <span class="n">gw[2]</span>

    <span class="c1">## realiza la corrección de los parámetros</span>
    <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw0</span>
    <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">w1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw1</span>

    <span class="c1">## retorna los parámetros corregidos</span>
    <span class="nf">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">##</span>
<span class="c1">## Punto de inicio</span>
<span class="c1">##</span>
<span class="n">w0</span> <span class="o">&lt;-</span> <span class="m">0.5</span>
<span class="n">w1</span> <span class="o">&lt;-</span> <span class="m">3.0</span>

<span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
<span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
<span class="n">history_f</span>  <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>

<span class="c1">## Se realizan 20 iteraciones sobre el</span>
<span class="c1">## todo el conjunto de datos disponibles</span>
<span class="nf">for</span><span class="p">(</span><span class="n">epoch</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">## Se recorren secuencialmente todos</span>
    <span class="c1">## los patrones xi, yi</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">p</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">x[p]</span><span class="p">,</span> <span class="n">d[p]</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="m">0.03</span><span class="p">)</span>
        <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">w[1]</span>
        <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">w[2]</span>

        <span class="c1">## se almacena la historia de puntos recorridos</span>
        <span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">)</span>
        <span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
        <span class="n">history_f</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="p">(</span><span class="n">d[p]</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">x[p]</span><span class="p">)</span><span class="n">^2</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&#39;\nValores encontrados\n\n  w0 = &#39;</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="s">&#39;\n  w1 = &#39;</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
<span class="nf">plot_contour</span><span class="p">()</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 =  0.6542495
  w1 =  1.6428
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_41_1.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_41_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">);</span> <span class="nf">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_42_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_42_0.png" />
</div>
</div>
<div class="section" id="Gradiente-Descendente-Estocástico">
<h4>Gradiente Descendente Estocástico<a class="headerlink" href="#Gradiente-Descendente-Estocástico" title="Enlazar permanentemente con este título">¶</a></h4>
<p>El método del gradiente descendente estocástico es el método de aprendizaje online en el que los patrones son seleccionados aleatoriamente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Punto de inicio</span>
<span class="c1">##</span>
<span class="n">w0</span> <span class="o">=</span> <span class="m">0.5</span>
<span class="n">w1</span> <span class="o">=</span> <span class="m">3.0</span>

<span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
<span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
<span class="n">history_f</span>  <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>

<span class="c1">## se recorre 20 veces el conjunto de datos</span>
<span class="nf">for</span><span class="p">(</span><span class="n">epoch</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">## se recorre el conjunto de datos</span>
    <span class="c1">## en un orden aleatorio</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">p</span> <span class="n">in</span> <span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="p">{</span>
        <span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">x[p]</span><span class="p">,</span> <span class="n">d[p]</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="m">0.03</span><span class="p">)</span>
        <span class="n">w0</span> <span class="o">&lt;-</span> <span class="n">w[1]</span>
        <span class="n">w1</span> <span class="o">&lt;-</span> <span class="n">w[2]</span>

        <span class="c1">## se almacena la historia</span>
        <span class="n">history_w0</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">w0</span><span class="p">)</span>
        <span class="n">history_w1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
        <span class="n">history_f</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="p">(</span><span class="n">d[p]</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">x[p]</span><span class="p">)</span><span class="n">^2</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&#39;\nValores encontrados\n\n  w0 = &#39;</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="s">&#39;\n  w1 = &#39;</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
<span class="nf">plot_contour</span><span class="p">()</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 =  0.6638676
  w1 =  1.648665
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_45_1.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_45_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">);</span> <span class="nf">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_46_0.png" src="../../_images/notebooks_tensorflow-in-r_estimacion-de-parametros-optimos-en-modelos-de-regresion-R_46_0.png" />
</div>
</div>
<p>Ya que la función de pérdida suele tener puntos de mínima local, se prefiere utilizar el método del gradiente descendente estocástico para escapar de dichos puntos de mínima local y converger al punto de mínima global (punto de mejor ajuste del modelo).</p>
<hr class="docutils" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>