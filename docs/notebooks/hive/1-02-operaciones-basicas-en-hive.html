

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Operaciones básicas en Hive &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Procesamiento de datos con Hive" href="2-03-procesamiento-de-datos-con-hive.html" />
    <link rel="prev" title="Conteo de palabras en Apache Hive" href="1-01-conteo-de-palabras-en-hive.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../analitica-de-grandes-datos/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/grades.html">Laboratorios de Programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/course-info.html">Información del curso</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/content.html">Sesiones</a> &raquo;</li>
        
      <li>Operaciones básicas en Hive</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/hive/1-02-operaciones-basicas-en-hive.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Operaciones-básicas-en-Hive">
<h1>Operaciones básicas en Hive<a class="headerlink" href="#Operaciones-básicas-en-Hive" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>30 min</em> | Última modificación: Junio 22, 2019</p></li>
</ul>
<p>Este tutorial esta basado en <a class="reference external" href="https://es.hortonworks.com/tutorial/beginners-guide-to-apache-pig/">https://es.hortonworks.com/tutorial/beginners-guide-to-apache-pig/</a></p>
<p>En este tutorial se ejemplifica:</p>
<ul class="simple">
<li><p>La carga de datos.</p></li>
<li><p>El uso básico de consultas.</p></li>
<li><p>La exportación de resultados.</p></li>
</ul>
<div class="section" id="Ejecución-de-Hive-en-un-contenedor-de-Docker">
<h2>Ejecución de Hive en un contenedor de Docker<a class="headerlink" href="#Ejecución-de-Hive-en-un-contenedor-de-Docker" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p>Usando el directorio de trabajo de la máquina local:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;$PWD&quot;</span><span class="p">:</span><span class="o">/</span><span class="n">datalake</span>  <span class="o">--</span><span class="n">name</span> <span class="n">hive</span> <span class="o">-</span><span class="n">p</span> <span class="mi">50070</span><span class="p">:</span><span class="mi">50070</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8088</span><span class="p">:</span><span class="mi">8088</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5000</span><span class="p">:</span><span class="mi">5000</span> <span class="n">jdvelasq</span><span class="o">/</span><span class="n">hive</span><span class="p">:</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">pseudo</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Usando un volumen de Docker (llamado <code class="docutils literal notranslate"><span class="pre">datalake</span></code>):</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="n">datalake</span><span class="p">:</span><span class="o">/</span><span class="n">datalake</span> <span class="o">--</span><span class="n">name</span> <span class="n">hive</span>  <span class="o">-</span><span class="n">p</span> <span class="mi">50070</span><span class="p">:</span><span class="mi">50070</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8088</span><span class="p">:</span><span class="mi">8088</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5000</span><span class="p">:</span><span class="mi">5000</span> <span class="n">jdvelasq</span><span class="o">/</span><span class="n">hive</span><span class="p">:</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">pseudo</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Consola conectada a un contendor que ya está corriendo:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">hive</span> <span class="n">bash</span>
</pre></div>
</div>
</div>
<div class="section" id="Preparación">
<h2>Preparación<a class="headerlink" href="#Preparación" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En este tutorial se usa el magic <code class="docutils literal notranslate"><span class="pre">bigdata</span></code> para usar interactivamente Hive desde un notebook de Jupyter. El parámetro <code class="docutils literal notranslate"><span class="pre">timeout</span></code> es el tiempo máximo de espera de procesamiento antes de que se reporte un error por procesamiento.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> bigdata
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">timeout</span> 300
</pre></div>
</div>
</div>
<p>Los datos se encuentran almacenados en la carpeta <code class="docutils literal notranslate"><span class="pre">drivers</span></code> del directorio actual. A continución se procede a crear la carpeta <code class="docutils literal notranslate"><span class="pre">/tmp/drivers</span></code> en el sistema de archivos de Hadoop (HDFS).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>wget https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/drivers/truck_event_text_partition.csv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--2019-11-14 23:42:05--  https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/drivers/truck_event_text_partition.csv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 199.232.48.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|199.232.48.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2272077 (2.2M) [text/plain]
Saving to: &#39;truck_event_text_partition.csv&#39;

truck_event_text_pa 100%[===================&gt;]   2.17M  2.59MB/s    in 0.8s

2019-11-14 23:42:07 (2.59 MB/s) - &#39;truck_event_text_partition.csv&#39; saved [2272077/2272077]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## Borra la carpeta si existe</span>
<span class="o">!</span>hdfs dfs -rm -r -f /tmp/drivers

<span class="c1">##</span>
<span class="c1">## Crea la carpeta drivers en el HDFS</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -mkdir /tmp/drivers

<span class="c1">##</span>
<span class="c1">## Copia los archivos al HDFS</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -copyFromLocal truck_event_text_partition.csv  /tmp/drivers/truck_event_text_partition.csv

<span class="c1">##</span>
<span class="c1">## Lista los archivos al HDFS para verificar</span>
<span class="c1">## que los archivos fueron copiados correctamente.</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -ls /tmp/drivers/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-rw-r--r--   1 root supergroup    2272077 2019-11-14 23:42 /tmp/drivers/truck_event_text_partition.csv
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-de-los-datos-de-los-eventos-de-los-conductores">
<h2>Carga de los datos de los eventos de los conductores<a class="headerlink" href="#Carga-de-los-datos-de-los-eventos-de-los-conductores" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En el siguiente código se crea crea la tabla de eventos de los conductores en el sistema; la primera instrucción borra la tabla si ya existe. Note que se debe especificar que los campos en las filas están delimitados por comas para que Hive los importe correctamente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE IF EXISTS truck_events;

CREATE TABLE truck_events (driverId       INT,
                           truckId        INT,
                           eventTime      STRING,
                           eventType      STRING,
                           longitude      DOUBLE,
                           latitude       DOUBLE,
                           eventKey       STRING,
                           correlationId  STRING,
                           driverName     STRING,
                           routeId        BIGINT,
                           routeName      STRING,
                           eventDate      STRING)

ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;,&#39;
TBLPROPERTIES (&quot;skip.header.line.count&quot;=&quot;1&quot;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS truck_events;
OK
Time taken: 3.98 seconds
CREATE TABLE truck_events (driverId       INT,
                           truckId        INT,
                           eventTime      STRING,
                           eventType      STRING,
                           longitude      DOUBLE,
                           latitude       DOUBLE,
                           eventKey       STRING,
                           correlationId  STRING,
                           driverName     STRING,
                           routeId        BIGINT,
                           routeName      STRING,
                           eventDate      STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;,&#39;
TBLPROPERTIES (&#34;skip.header.line.count&#34;=&#34;1&#34;);
OK
Time taken: 0.777 seconds
</pre></div></div>
</div>
<p>Se verifican las tablas existentes en la base de datos.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SHOW TABLES;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SHOW TABLES;
OK
docs
truck_events
word_counts
Time taken: 0.093 seconds, Fetched: 3 row(s)
</pre></div></div>
</div>
<p>A continuación se muestra la información detallada de creación de la tabla <code class="docutils literal notranslate"><span class="pre">truck_events</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SHOW CREATE TABLE truck_events;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SHOW CREATE TABLE truck_events;
OK
CREATE TABLE `truck_events`(
  `driverid` int,
  `truckid` int,
  `eventtime` string,
  `eventtype` string,
  `longitude` double,
  `latitude` double,
  `eventkey` string,
  `correlationid` string,
  `drivername` string,
  `routeid` bigint,
  `routename` string,
  `eventdate` string)
ROW FORMAT SERDE
  &#39;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#39;
WITH SERDEPROPERTIES (
  &#39;field.delim&#39;=&#39;,&#39;,
  &#39;serialization.format&#39;=&#39;,&#39;)
STORED AS INPUTFORMAT
  &#39;org.apache.hadoop.mapred.TextInputFormat&#39;
OUTPUTFORMAT
  &#39;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#39;
LOCATION
  &#39;hdfs://0.0.0.0:9000/user/hive/warehouse/truck_events&#39;
TBLPROPERTIES (
  &#39;skip.header.line.count&#39;=&#39;1&#39;,
  &#39;transient_lastDdlTime&#39;=&#39;1573774948&#39;)
Time taken: 0.273 seconds, Fetched: 27 row(s)
</pre></div></div>
</div>
<p>También es posible visualizar los campos y su contenido con el comando <code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DESCRIBE truck_events;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DESCRIBE truck_events;
OK
driverid                int
truckid                 int
eventtime               string
eventtype               string
longitude               double
latitude                double
eventkey                string
correlationid           string
drivername              string
routeid                 bigint
routename               string
eventdate               string
Time taken: 0.045 seconds, Fetched: 12 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-de-datos">
<h2>Carga de datos<a class="headerlink" href="#Carga-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La carga de datos se realiza con la siguiente consulta.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
LOAD DATA INPATH &#39;/tmp/drivers/truck_event_text_partition.csv&#39; OVERWRITE
INTO TABLE truck_events;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LOAD DATA INPATH &#39;/tmp/drivers/truck_event_text_partition.csv&#39; OVERWRITE
INTO TABLE truck_events;
Loading data to table default.truck_events
OK
Time taken: 0.744 seconds
</pre></div></div>
</div>
<p>Se verifican las propieades de la tabla después de la carga de datos.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SHOW TBLPROPERTIES truck_events;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SHOW TBLPROPERTIES truck_events;
OK
numFiles        1
numRows 0
rawDataSize     0
skip.header.line.count  1
totalSize       2272077
transient_lastDdlTime   1573774949
Time taken: 0.03 seconds, Fetched: 6 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Visualización-de-datos">
<h2>Visualización de datos<a class="headerlink" href="#Visualización-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La visualización se realiza mediante consultas con <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT * FROM truck_events LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT * FROM truck_events LIMIT 10;
OK
14      25      59:21.4 Normal  -94.58  37.03   14|25|9223370572464814373       3.66E+18        Adis Cesir      160405074       Joplin to Kansas City Route 2   2016-05-27-22
18      16      59:21.7 Normal  -89.66  39.78   18|16|9223370572464814089       3.66E+18        Grant Liu       1565885487      Springfield to KC Via Hanibal   2016-05-27-22
27      105     59:21.7 Normal  -90.21  38.65   27|105|9223370572464814070      3.66E+18        Mark Lochbihler 1325562373      Springfield to KC Via Columbia Route 2  2016-05-27-22
11      74      59:21.7 Normal  -90.2   38.65   11|74|9223370572464814123       3.66E+18        Jamie Engesser  1567254452      Saint Louis to Memphis Route2   2016-05-27-22
22      87      59:21.7 Normal  -90.04  35.19   22|87|9223370572464814101       3.66E+18        Nadeem Asghar   1198242881       Saint Louis to Chicago Route2  2016-05-27-22
22      87      59:22.3 Normal  -90.37  35.21   22|87|9223370572464813486       3.66E+18        Nadeem Asghar   1198242881       Saint Louis to Chicago Route2  2016-05-27-22
23      68      59:22.4 Normal  -89.91  40.86   23|68|9223370572464813450       3.66E+18        Adam Diaz       160405074       Joplin to Kansas City Route 2   2016-05-27-22
11      74      59:22.5 Normal  -89.74  39.1    11|74|9223370572464813355       3.66E+18        Jamie Engesser  1567254452      Saint Louis to Memphis Route2   2016-05-27-22
20      41      59:22.5 Normal  -93.36  41.69   20|41|9223370572464813344       3.66E+18        Chris Harris    160779139       Des Moines to Chicago Route 2   2016-05-27-22
32      42      59:22.5 Normal  -90.37  35.21   32|42|9223370572464813296       3.66E+18        Ryan Templeton  1090292248      Peoria to Ceder Rapids Route 2  2016-05-27-22
Time taken: 1.113 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Obtención-de-un-subconjunto-de-datos">
<h2>Obtención de un subconjunto de datos<a class="headerlink" href="#Obtención-de-un-subconjunto-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En hive es posible un subconjunto de datos y almacenarlo en una nueva tabla a partir de una consulta que permita obtener los datos deseados. En el siguiente código, se crea la tabla <code class="docutils literal notranslate"><span class="pre">truck_events_subset</span></code> con los primeros 100 registros de la tabla <code class="docutils literal notranslate"><span class="pre">truck_events</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE IF EXISTS truck_events_subset;

CREATE TABLE truck_events_subset
AS
    SELECT *
    FROM truck_events
    LIMIT 100;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS truck_events_subset;
OK
Time taken: 0.008 seconds
CREATE TABLE truck_events_subset
AS
    SELECT *
    FROM truck_events
    LIMIT 100;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114234231_aa3b3b9a-d3db-493d-85f3-4d873df2fc4a
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&lt;number&gt;
In order to set a constant number of reducers:
  set mapreduce.job.reduces=&lt;number&gt;
Starting Job = job_1573774297554_0006, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0006/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0006
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2019-11-14 23:42:38,953 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:42:43,223 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.26 sec
2019-11-14 23:42:48,485 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 2.97 sec
MapReduce Total cumulative CPU time: 2 seconds 970 msec
Ended Job = job_1573774297554_0006
Moving data to directory hdfs://0.0.0.0:9000/user/hive/warehouse/truck_events_subset
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 2.97 sec   HDFS Read: 28725 HDFS Write: 13676 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 970 msec
OK
Time taken: 18.59 seconds
</pre></div></div>
</div>
<p>El código anterior es equivalente al siguiente, donde se usa <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> en <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> para indicar que la nueva tabla <code class="docutils literal notranslate"><span class="pre">truck_events_subset</span></code> tiene la misma estructura de la tabla existente <code class="docutils literal notranslate"><span class="pre">truck_events</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>

DROP TABLE IF EXISTS truck_events_subset;

CREATE TABLE truck_events_subset LIKE truck_events;

INSERT OVERWRITE TABLE truck_events_subset
SELECT
    *
FROM
    truck_events
LIMIT
    100;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS truck_events_subset;
OK
Time taken: 0.269 seconds
CREATE TABLE truck_events_subset LIKE truck_events;
OK
Time taken: 0.061 seconds
INSERT OVERWRITE TABLE truck_events_subset
SELECT
    *
FROM
    truck_events
LIMIT
    100;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114234250_52b61a88-2397-4c40-8975-5f93c8eca79e
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&lt;number&gt;
In order to set a constant number of reducers:
  set mapreduce.job.reduces=&lt;number&gt;
Starting Job = job_1573774297554_0007, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0007/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0007
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2019-11-14 23:43:00,379 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:43:04,580 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.2 sec
2019-11-14 23:43:09,820 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 2.8 sec
MapReduce Total cumulative CPU time: 2 seconds 800 msec
Ended Job = job_1573774297554_0007
Loading data to table default.truck_events_subset
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 2.8 sec   HDFS Read: 29426 HDFS Write: 13676 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 800 msec
OK
Time taken: 20.401 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT * FROM truck_events_subset LIMIT 5;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT * FROM truck_events_subset LIMIT 5;
OK
31      18      59:36.3 Normal  -94.58  37.03   31|18|9223370572464799462       3.66E+18        Rommel Garcia   1594289134      Memphis to Little Rock Route 2  2016-05-27-22
18      16      59:36.3 Normal  -92.42  39.76   18|16|9223370572464799486       3.66E+18        Grant Liu       1565885487      Springfield to KC Via Hanibal   2016-05-27-22
26      57      59:35.9 Normal  -92.74  37.6    26|57|9223370572464799895       3.66E+18        Michael Aube    1325712174      Saint Louis to Tulsa Route2     2016-05-27-22
14      25      59:35.8 Normal  -94.46  37.16   14|25|9223370572464800006       3.66E+18        Adis Cesir      160405074       Joplin to Kansas City Route 2   2016-05-27-22
27      105     59:35.6 Normal  -92.85  38.93   27|105|9223370572464800175      3.66E+18        Mark Lochbihler 1325562373      Springfield to KC Via Columbia Route 2  2016-05-27-22
Time taken: 0.1 seconds, Fetched: 5 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="id1">
<h2>Obtención de un subconjunto de datos<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En el siguiente código se obtienen algunas columnas de la tabla <code class="docutils literal notranslate"><span class="pre">truck_events_subset</span></code> para ser almacenadas en una tabla diferente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>

DROP TABLE IF EXISTS specific_columns;

CREATE TABLE specific_columns
AS
    SELECT
        driverId,
        eventTime,
        eventType
    FROM
        truck_events_subset;

SELECT * FROM specific_columns LIMIT 5;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS specific_columns;
OK
Time taken: 0.008 seconds
CREATE TABLE specific_columns
AS
    SELECT
        driverId,
        eventTime,
        eventType
    FROM
        truck_events_subset;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114234311_31e15baa-b4c5-43db-8e2e-9869a1e864a9
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there&#39;s no reduce operator
Starting Job = job_1573774297554_0008, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0008/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0008
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2019-11-14 23:43:22,087 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:43:26,254 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.21 sec
MapReduce Total cumulative CPU time: 1 seconds 210 msec
Ended Job = job_1573774297554_0008
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to directory hdfs://0.0.0.0:9000/user/hive/warehouse/.hive-staging_hive_2019-11-14_23-43-11_877_7266039308226205704-1/-ext-10002
Moving data to directory hdfs://0.0.0.0:9000/user/hive/warehouse/specific_columns
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1   Cumulative CPU: 1.21 sec   HDFS Read: 18146 HDFS Write: 1883 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 210 msec
OK
Time taken: 15.784 seconds
SELECT * FROM specific_columns LIMIT 5;
OK
31      59:36.3 Normal
18      59:36.3 Normal
26      59:35.9 Normal
14      59:35.8 Normal
27      59:35.6 Normal
Time taken: 0.086 seconds, Fetched: 5 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Escritura-de-la-tabla-en-el-HDFS">
<h2>Escritura de la tabla en el HDFS<a class="headerlink" href="#Escritura-de-la-tabla-en-el-HDFS" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Seguidamente, se procede a escribir el contenido de la tabla en el directorio <code class="docutils literal notranslate"><span class="pre">/tmp/drivers/specific-columns</span></code> del HDFS.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
INSERT OVERWRITE DIRECTORY &#39;/tmp/drivers/specific-columns&#39;
ROW FORMAT DELIMITED FIELDS TERMINATED BY &#39;,&#39;
SELECT
    *
FROM
    specific_columns;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INSERT OVERWRITE DIRECTORY &#39;/tmp/drivers/specific-columns&#39;
ROW FORMAT DELIMITED FIELDS TERMINATED BY &#39;,&#39;
SELECT
    *
FROM
    specific_columns;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114234328_b45a3c77-76b9-4ce6-975c-fd25941d9010
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there&#39;s no reduce operator
Starting Job = job_1573774297554_0009, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0009/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0009
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2019-11-14 23:43:38,228 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:43:43,473 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.57 sec
MapReduce Total cumulative CPU time: 1 seconds 570 msec
Ended Job = job_1573774297554_0009
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to directory hdfs://0.0.0.0:9000/tmp/drivers/specific-columns/.hive-staging_hive_2019-11-14_23-43-28_153_2409794566538603448-1/-ext-10000
Moving data to directory /tmp/drivers/specific-columns
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1   Cumulative CPU: 1.57 sec   HDFS Read: 5509 HDFS Write: 1800 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 570 msec
OK
Time taken: 16.412 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se visualiza el contenido del directorio</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -ls /tmp/drivers/specific-columns/
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 1 items
-rwxr-xr-x   1 root supergroup       1800 2019-11-14 23:43 /tmp/drivers/specific-columns/000000_0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se visualiza la parte final del archivo</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -tail /tmp/drivers/specific-columns/000000_0
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
,59:29.6,Normal
13,59:29.5,Normal
27,59:29.3,Normal
17,59:29.2,Normal
12,59:29.1,Normal
15,59:28.8,Normal
16,59:28.8,Normal
13,59:28.5,Normal
23,59:28.4,Normal
11,59:28.3,Normal
30,59:28.0,Normal
24,59:27.9,Normal
25,59:27.8,Normal
28,59:27.7,Normal
27,59:27.7,Normal
13,59:27.6,Normal
23,59:27.4,Normal
25,59:27.0,Normal
26,59:27.0,Normal
28,59:26.9,Normal
10,59:26.8,Normal
22,59:26.6,Normal
23,59:26.6,Normal
25,59:26.2,Normal
27,59:25.9,Normal
19,59:25.9,Normal
13,59:25.9,Normal
21,59:25.7,Normal
16,59:25.3,Normal
26,59:25.2,Normal
19,59:25.1,Normal
18,59:25.0,Normal
22,59:25.0,Normal
29,59:24.7,Normal
25,59:24.3,Normal
24,59:24.3,Normal
32,59:24.2,Normal
22,59:24.2,Normal
14,59:24.2,Normal
25,59:23.5,Normal
31,59:23.5,Normal
16,59:23.4,Normal
15,59:23.4,Normal
28,59:23.3,Normal
14,59:23.3,Normal
17,59:23.2,Normal
27,59:22.6,Normal
32,59:22.5,Normal
20,59:22.5,Normal
11,59:22.5,Normal
23,59:22.4,Normal
22,59:22.3,Normal
22,59:21.7,Normal
11,59:21.7,Normal
27,59:21.7,Normal
18,59:21.7,Normal
14,59:21.4,Normal
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE drivers;
DROP TABLE specific_columns;
DROP TABLE temp_drivers;
DROP TABLE temp_timesheet;
DROP TABLE timesheet;
DROP TABLE truck_events;
DROP TABLE truck_events_subset;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE drivers;
OK
Time taken: 0.069 seconds
DROP TABLE specific_columns;
OK
Time taken: 0.071 seconds
DROP TABLE temp_drivers;
OK
Time taken: 0.011 seconds
DROP TABLE temp_timesheet;
OK
Time taken: 0.011 seconds
DROP TABLE timesheet;
OK
Time taken: 0.008 seconds
DROP TABLE truck_events;
OK
Time taken: 0.057 seconds
DROP TABLE truck_events_subset;
OK
Time taken: 0.059 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm *.csv *.log
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
rm: cannot remove &#39;*hql&#39;: No such file or directory
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>