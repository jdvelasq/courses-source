

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Manejo de Datos Complejos y Tablas Particionadas &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Conteo de palabras en Apache Hive en modo standalone" href="2-08-standalone.html" />
    <link rel="prev" title="Carga de datos en distintos formatos" href="2-06-carga-de-datos-en-distintos-formatos.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../analitica-de-grandes-datos/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/grades.html">Laboratorios de Programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../analitica-de-grandes-datos/course-info.html">Información del curso</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a> &raquo;</li>
        
          <li><a href="../../analitica-de-grandes-datos/content.html">Sesiones</a> &raquo;</li>
        
      <li>Manejo de Datos Complejos y Tablas Particionadas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/hive/2-07-manejo-de-datos-complejos.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Manejo-de-Datos-Complejos-y-Tablas-Particionadas">
<h1>Manejo de Datos Complejos y Tablas Particionadas<a class="headerlink" href="#Manejo-de-Datos-Complejos-y-Tablas-Particionadas" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>30 min</em> | Última modificación: Noviembre 08, 2019</p></li>
</ul>
<p>A diferencia de los gestores tradicionales de bases de datos, Hive permite la creación de datos complejos que pueden ser almacenados en los campos de las tablas. Debido a que las tablas pueden ser muy grandes, Hive también permite hacer la partición de las tablas en archivos separados a partir uno o más campos claves optimizando las consultas, ya que las búsquedas se pueden realizar sobre particiones específicas de una tabla.</p>
<p>En este tutorial se ejemplifica:</p>
<ul class="simple">
<li><p>La creación de un archivo de texto con datos complejos para ser cargado y consultado en Hive.</p></li>
<li><p>La creación de tablas con datos complejos.</p></li>
<li><p>La construcción de consultas sobre campos complejos.</p></li>
<li><p>La creación de tablas particionadas y la inserción de registros en ellas.</p></li>
</ul>
<div class="section" id="Ejecución-de-Hive-en-un-contenedor-de-Docker">
<h2>Ejecución de Hive en un contenedor de Docker<a class="headerlink" href="#Ejecución-de-Hive-en-un-contenedor-de-Docker" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p>Usando el directorio de trabajo de la máquina local:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;$PWD&quot;</span><span class="p">:</span><span class="o">/</span><span class="n">datalake</span>  <span class="o">--</span><span class="n">name</span> <span class="n">hive</span> <span class="o">-</span><span class="n">p</span> <span class="mi">50070</span><span class="p">:</span><span class="mi">50070</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8088</span><span class="p">:</span><span class="mi">8088</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5000</span><span class="p">:</span><span class="mi">5000</span> <span class="n">jdvelasq</span><span class="o">/</span><span class="n">hive</span><span class="p">:</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">pseudo</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Usando un volumen de Docker (llamado <code class="docutils literal notranslate"><span class="pre">datalake</span></code>):</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="n">datalake</span><span class="p">:</span><span class="o">/</span><span class="n">datalake</span> <span class="o">--</span><span class="n">name</span> <span class="n">hive</span>  <span class="o">-</span><span class="n">p</span> <span class="mi">50070</span><span class="p">:</span><span class="mi">50070</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8088</span><span class="p">:</span><span class="mi">8088</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5000</span><span class="p">:</span><span class="mi">5000</span> <span class="n">jdvelasq</span><span class="o">/</span><span class="n">hive</span><span class="p">:</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">pseudo</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Consola conectada a un contendor que ya está corriendo:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">exec</span> <span class="o">-</span><span class="n">it</span> <span class="n">hive</span> <span class="n">bash</span>
</pre></div>
</div>
</div>
<div class="section" id="Información-utilizada">
<h2>Información utilizada<a class="headerlink" href="#Información-utilizada" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La información utilizada corresponde al ranking de popularidad de lenguajes de programación publicado por IEEE en sus sitios web:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://spectrum.ieee.org/at-work/innovation/the-2018-top-programming-languages">https://spectrum.ieee.org/at-work/innovation/the-2018-top-programming-languages</a></p></li>
<li><p><a class="reference external" href="http://sites.ieee.org/houston/article-2017-top-programming-languages/">http://sites.ieee.org/houston/article-2017-top-programming-languages/</a></p></li>
<li><p><a class="reference external" href="https://spectrum.ieee.org/static/interactive-the-top-programming-languages-2016">https://spectrum.ieee.org/static/interactive-the-top-programming-languages-2016</a></p></li>
<li><p><a class="reference external" href="https://spectrum.ieee.org/static/interactive-the-top-programming-languages-2015/">https://spectrum.ieee.org/static/interactive-the-top-programming-languages-2015/</a></p></li>
<li><p><a class="reference external" href="https://spectrum.ieee.org/static/interactive-the-top-programming-languages">https://spectrum.ieee.org/static/interactive-the-top-programming-languages</a></p></li>
</ul>
<p>El archivo presentado a continuación fue construído manualmente para propósitos ilustrativos. Las columnas son:</p>
<ul class="simple">
<li><p>El nombre del lenguaje de programación.</p></li>
<li><p>La puntuación obtenida para cada año entre 2014 y 2018.</p></li>
<li><p>Las categorías en que aparece el lenguaje (Web, Mobile, Enterprise, Embedded).</p></li>
</ul>
<p>El formato es explicado más adelante.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>wget https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/language-score.tsv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--2019-11-14 23:56:52--  https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/language-score.tsv
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 199.232.48.133
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|199.232.48.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3490 (3.4K) [text/plain]
Saving to: &#39;language-score.tsv&#39;

language-score.tsv  100%[===================&gt;]   3.41K  --.-KB/s    in 0.005s

2019-11-14 23:56:53 (756 KB/s) - &#39;language-score.tsv&#39; saved [3490/3490]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cat language-score.tsv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ABAP    2018#22.8,2017#28.9,2016#15.9,2015#24.6,2014#20.8       Enterprise
Actionscript    2018#0.6,2017#0.0,2016#3.3,2015#6.8,2014#22.0   Web,Mobile
Ada     2018#20.9,2017#29.9,2016#20.5,2015#32.8,2014#30.1       Enterprise,Embedded
Arduino 2018#69.0,2017#74.4,2016#69.5,2015#63.0,2014#62.9       Embedded
Assembly        2018#74.1,2017#73.4,2016#68.0,2015#67.9,2014#66.9       Embedded
C       2018#96.7,2017#99.7,2016#100.0,2015#99.9,2014#99.2      Mobile,Enterprise,Embedded
C#      2018#89.4,2017#88.8,2016#86.4,2015#91.8,2014#92.2       Web,Mobile,Enterprise
C++     2018#99.7,2017#97.4,2016#95.8,2015#99.6,2014#95.5       Mobile, Enterprise, Embedded
Clojure 2018#25.6,2017#28.8,2016#22.0,2015#30.9,2014#36.0       Web,Enterprise
Cobol   2018#24.6,2017#29.2,2016#17.9,2015#19.0,2014#30.6       Enterprise
Cuda    2018#43.0,2017#56.5,2016#52.3,2015#48.6,2014#   Enterprise
D       2018#40.6,2017#41.5,2016#37.7,2015#44.6,2014#49.9       Web,Embedded
Delphi  2018#38.7,2017#,2016#41.7,2015#39.4,2014#40.2   Mobile,Enterprise
Erlang  2018#26.9,2017#31.5,2016#27.0,2015#30.6,2014#32.1       Enterprise,Embedded
Forth   2018#0.0,2017#5.7,2016#0.0,2015#8.5,2014#2.3    Embedded
Fortran 2018#49.5,2017#43.2,2016#40.9,2015#39.7,2014#45.5       Enterprise
Go      2018#76.4,2017#77.2,2016#71.5,2015#67.9,2014#59.8       Web,Enterprise
Haskell 2018#48.6,2017#50.8,2016#43.0,2015#39.2,2014#44.8       Enterprise,Embedded
HTML    2018#71.2,2017#68.0,2016#66.7,2015#54.3,2014#64.1       Web
J       2018#18.1,2017#14.2,2016#10.4,2015#7.7,2014#13.6        Enterprise
Java    2018#97.5,2017#99.4,2016#98.1,2015#100,2014#100 Web,Mobile,Enterprise
JavaScript      2018#82.6,2017#86.2,2016#81.9,2015#83.0,2014#84.9       Web,Mobile
Julia   2018#35.1,2017#40.6,2016#31.4,2015#17.4,2014#   Enterprise
LabView 2018#32.7,2017#36.4,2016#32.6,2015#30.9 Enterprise,Embedded
Ladder Logic    2018#11.5,2017#6.0,2016#26.2,2015#21.8,2014#20.2        Embedded
Lisp    2018#33.3,2017#33.9,2016#33.6,2015#40.4,2014#43.7       Enterprise
Lua     2018#49.8,2017#54.9,2016#50.9,2015#45.9,2014#47.8       Web,Enterprise
Matlab  2018#72.8,2017#70.4,2016#68.7,2015#72.4,2014#73.1       Enterprise
Objective-C     2018#50.5,2017#48.4,2016#52.4,2015#58.7,2014#63.7       Mobile,Enterprise
Ocaml   2018#14.4,2017#13.7,2016#3.2,2015#0.0,2014#18.5 Web,Enterprise
Perl    2018#57.4,2017#59.1,2016#57.5,2015#66.9,2014#69.6       Web,Enterprise
PHP     2018#84.9,2017#82.3,2016#82.4,2015#84.5,2014#84.6       Web
Processing      2018#53.1,2017#52.7,2016#50.3,2015#49.2,2014#52.0       Web,Enterprise
Prolog  2018#33.2,2017#36.5,2016#25.0,2015#23.2,2014#38.6       Enterprise
Python  2018#100.0,2017#100,2016#97.9,2015#95.8,2014#93.4       Web,Enterprise,Embedded
R       2018#82.9,2017#88.8,2016#87.7,2015#84.7,2014#74.1       Enterprise
Ruby    2018#71.4,2017#73.9,2016#74.0,2015#75.3,2014#79.3       Web,Enterprise
Rust    2018#41.8,2017#55.0,2016#42.2,2015#29.6,2014#   Web,Enterprise
SAS     2018#25.6,2017#30.7,2016#21.7,2015#43.7,2014#37.1       Enterprise
Scala   2018#72.1,2017#70.0,2016#66.3,2015#62.4,2014#62.7       Web,Mobile
Scheme  2018#18.8,2017#24.5,2016#14.5,2015#14.8,2014#27.8       Mobile,Enterprise
Shell   2018#66.1,2017#68.6,2016#52.7,2015#71.4,2014#63.3       Enterprise
SQL     2018#49.3,2017#52.8,2016#48.8,2015#70.9,2014#71.6       Enterprise
Swift   2018#53.9,2017#76.5,2016#67.6,2015#62.4 Mobile,Enterprise
TCL     2018#21.9,2017#16.2,2016#8.7,2015#11.6,2014#23.1        Enterprise,Embedded
Verilog 2018#41.2,2017#35.6,2016#25.1,2015#23.7,2014#33.8       Embedded
VHDL    2018#45.4,2017#39.9,2016#33.3,2015#35.4,2014#42.6       Embedded
Visual Basic    2018#45.1,2017#58.9,2016#55.7,2015#63.4,2014#66.0       Enterprise
ASP.NET 2014#35.9       Web
CoffeeScript    2014#25.5       Web
Apex Code       2014#18.0       Enterprise
Eiffel  2014#6.4        Enterprise
Scilab  2014#1.0        Enterprise
NetLogo 2014#0.0        Enterprise
</pre></div></div>
</div>
</div>
<div class="section" id="Preparación">
<h2>Preparación<a class="headerlink" href="#Preparación" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se carga la extensión para enviar interactivamente comandos a Hive. Se fija el tiempo máximo de espera en 300 segundos.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> bigdata
<span class="o">%</span><span class="k">timeout</span> 300
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se mueve el archivo al HDFS</span>
<span class="c1">##</span>
<span class="o">!</span>hdfs dfs -copyFromLocal language-score.tsv /tmp/language-score.tsv
</pre></div>
</div>
</div>
</div>
<div class="section" id="Creación-de-la-tabla-journals">
<h2>Creación de la tabla <code class="docutils literal notranslate"><span class="pre">journals</span></code><a class="headerlink" href="#Creación-de-la-tabla-journals" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A continuación se crea la tabla para almacenar la información, con las siguientes características (revise el archivo <code class="docutils literal notranslate"><span class="pre">languagescore.tsv</span></code>):</p>
<ul class="simple">
<li><p>El campo <code class="docutils literal notranslate"><span class="pre">language</span></code> es un STRING que contiene el nombre del lenguaje de programación.</p></li>
<li><p>El campo <code class="docutils literal notranslate"><span class="pre">ranking</span></code> es un MAP que tiene como clave el año (tipo INT) y como valor asociado el puntaje (popularidad) de dicho año (tipo FLOAT).</p></li>
<li><p>El campo <code class="docutils literal notranslate"><span class="pre">categories</span></code> es un ARRAY conformado por una lista de STRINGS separados por comas que corresponden a las categorías a las que está asociado el lenguaje de programación.</p></li>
<li><p>Los campos están delimitados por tabulador (<code class="docutils literal notranslate"><span class="pre">\t</span></code>).</p></li>
<li><p>Los registros (líneas) están terminados por <code class="docutils literal notranslate"><span class="pre">\n</span></code>.</p></li>
<li><p>Los elementos (COLLECTION ITEMS) del ARRAY (campo <code class="docutils literal notranslate"><span class="pre">categories</span></code>) y del MAP (campo ranking) están separados entre si por <code class="docutils literal notranslate"><span class="pre">,</span></code>.</p></li>
<li><p>Para los campos tipo MAP, las claves y sus valores asociados están separados por <code class="docutils literal notranslate"><span class="pre">#</span></code>.</p></li>
<li><p>La tabla se almacenará en la carpeta <code class="docutils literal notranslate"><span class="pre">/tmp/hive-journals</span></code> del HDFS como un archivo de texto.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE IF EXISTS languages;

CREATE TABLE languages (
    language   STRING,
    ranking    MAP&lt;INT,FLOAT&gt;,
    categories ARRAY&lt;STRING&gt;
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;\t&#39;
COLLECTION ITEMS TERMINATED BY &#39;,&#39;
MAP KEYS TERMINATED BY &#39;#&#39;
LINES TERMINATED BY &#39;\n&#39;
STORED AS TEXTFILE
LOCATION &#39;/tmp/hive-journals&#39;;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS languages;
OK
Time taken: 4.221 seconds
CREATE TABLE languages (
    language   STRING,
    ranking    MAP&lt;INT,FLOAT&gt;,
    categories ARRAY&lt;STRING&gt;
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;\t&#39;
COLLECTION ITEMS TERMINATED BY &#39;,&#39;
MAP KEYS TERMINATED BY &#39;#&#39;
LINES TERMINATED BY &#39;\n&#39;
STORED AS TEXTFILE
LOCATION &#39;/tmp/hive-journals&#39;;
OK
Time taken: 0.645 seconds
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-de-datos">
<h2>Carga de datos<a class="headerlink" href="#Carga-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se cargan los datos en la forma usual.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
LOAD DATA INPATH &#39;/tmp/language-score.tsv&#39; INTO TABLE languages;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LOAD DATA INPATH &#39;/tmp/language-score.tsv&#39; INTO TABLE languages;
Loading data to table default.languages
OK
Time taken: 1.054 seconds
</pre></div></div>
</div>
<p>Se muestran los primeros 10 registros para verificar que la tabla fue cargada exitósamente. Note que los campos MAP (columna ranking), aparecen delimitados por <code class="docutils literal notranslate"><span class="pre">{</span></code> y <code class="docutils literal notranslate"><span class="pre">}</span></code>, donde las parejas clave-valor están separadas entre si por comas, y la separación entre la clave y el valor se hace mediante <code class="docutils literal notranslate"><span class="pre">:</span></code>. Los ARRAY están delimitados por <code class="docutils literal notranslate"><span class="pre">[</span></code> y <code class="docutils literal notranslate"><span class="pre">]</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT * FROM languages LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT * FROM languages LIMIT 10;
OK
ABAP    {2018:22.8,2017:28.9,2016:15.9,2015:24.6,2014:20.8}     [&#34;Enterprise&#34;]
Actionscript    {2018:0.6,2017:0.0,2016:3.3,2015:6.8,2014:22.0} [&#34;Web&#34;,&#34;Mobile&#34;]
Ada     {2018:20.9,2017:29.9,2016:20.5,2015:32.8,2014:30.1}     [&#34;Enterprise&#34;,&#34;Embedded&#34;]
Arduino {2018:69.0,2017:74.4,2016:69.5,2015:63.0,2014:62.9}     [&#34;Embedded&#34;]
Assembly        {2018:74.1,2017:73.4,2016:68.0,2015:67.9,2014:66.9}     [&#34;Embedded&#34;]
C       {2018:96.7,2017:99.7,2016:100.0,2015:99.9,2014:99.2}    [&#34;Mobile&#34;,&#34;Enterprise&#34;,&#34;Embedded&#34;]
C#      {2018:89.4,2017:88.8,2016:86.4,2015:91.8,2014:92.2}     [&#34;Web&#34;,&#34;Mobile&#34;,&#34;Enterprise&#34;]
C++     {2018:99.7,2017:97.4,2016:95.8,2015:99.6,2014:95.5}     [&#34;Mobile&#34;,&#34; Enterprise&#34;,&#34; Embedded&#34;]
Clojure {2018:25.6,2017:28.8,2016:22.0,2015:30.9,2014:36.0}     [&#34;Web&#34;,&#34;Enterprise&#34;]
Cobol   {2018:24.6,2017:29.2,2016:17.9,2015:19.0,2014:30.6}     [&#34;Enterprise&#34;]
Time taken: 1.112 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Almacenamiento-de-la-tabla-en-el-HDFS">
<h2>Almacenamiento de la tabla en el HDFS<a class="headerlink" href="#Almacenamiento-de-la-tabla-en-el-HDFS" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La tabla es almacenada en la carpeta <code class="docutils literal notranslate"><span class="pre">/tmp/hive-journals</span></code>, tal como se indicó en su creación.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -ls /tmp/hive-journals/
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 1 items
-rwxrwxrwx   1 root supergroup       3490 2019-11-14 23:56 /tmp/hive-journals/language-score.tsv
</pre></div></div>
</div>
<p>La tabla ahora es administrada por Hive y conserva el mismo formato que se indicó en su creación.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -tail /tmp/hive-journals/language-score.tsv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8.8,2016#87.7,2015#84.7,2014#74.1       Enterprise
Ruby    2018#71.4,2017#73.9,2016#74.0,2015#75.3,2014#79.3       Web,Enterprise
Rust    2018#41.8,2017#55.0,2016#42.2,2015#29.6,2014#   Web,Enterprise
SAS     2018#25.6,2017#30.7,2016#21.7,2015#43.7,2014#37.1       Enterprise
Scala   2018#72.1,2017#70.0,2016#66.3,2015#62.4,2014#62.7       Web,Mobile
Scheme  2018#18.8,2017#24.5,2016#14.5,2015#14.8,2014#27.8       Mobile,Enterprise
Shell   2018#66.1,2017#68.6,2016#52.7,2015#71.4,2014#63.3       Enterprise
SQL     2018#49.3,2017#52.8,2016#48.8,2015#70.9,2014#71.6       Enterprise
Swift   2018#53.9,2017#76.5,2016#67.6,2015#62.4 Mobile,Enterprise
TCL     2018#21.9,2017#16.2,2016#8.7,2015#11.6,2014#23.1        Enterprise,Embedded
Verilog 2018#41.2,2017#35.6,2016#25.1,2015#23.7,2014#33.8       Embedded
VHDL    2018#45.4,2017#39.9,2016#33.3,2015#35.4,2014#42.6       Embedded
Visual Basic    2018#45.1,2017#58.9,2016#55.7,2015#63.4,2014#66.0       Enterprise
ASP.NET 2014#35.9       Web
CoffeeScript    2014#25.5       Web
Apex Code       2014#18.0       Enterprise
Eiffel  2014#6.4        Enterprise
Scilab  2014#1.0        Enterprise
NetLogo 2014#0.0        Enterprise
</pre></div></div>
</div>
</div>
<div class="section" id="Popularidad-por-año">
<h2>Popularidad por año<a class="headerlink" href="#Popularidad-por-año" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En la siguiente consulta se obtienen los diez lenguajes de programación más populares para el año 2017. En Hive no es posible aplicar ORDER BY sobre un valor de un MAP, por lo que se crea una subconsulta que crea una tabla, llamada <code class="docutils literal notranslate"><span class="pre">table1</span></code>, en donde el ranking para el año 2017 se nombra como <code class="docutils literal notranslate"><span class="pre">ranking2017</span></code> con el fin de poder realizar el ordenamiento.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT
    language,
    ranking2017
FROM (
    SELECT
        language,
        ranking[2017] AS ranking2017
    FROM
        languages
) table1
ORDER BY
    ranking2017 DESC
LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT
    language,
    ranking2017
FROM (
    SELECT
        language,
        ranking[2017] AS ranking2017
    FROM
        languages
) table1
ORDER BY
    ranking2017 DESC
LIMIT 10;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114235715_a9bdce9c-7983-4bd1-97e6-4620d23a15ca
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&lt;number&gt;
In order to set a constant number of reducers:
  set mapreduce.job.reduces=&lt;number&gt;
Starting Job = job_1573774297554_0029, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0029/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0029
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2019-11-14 23:57:21,579 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:57:26,885 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.95 sec
2019-11-14 23:57:32,163 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 3.26 sec
MapReduce Total cumulative CPU time: 3 seconds 260 msec
Ended Job = job_1573774297554_0029
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 3.26 sec   HDFS Read: 11890 HDFS Write: 305 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 260 msec
OK
Python  100.0
C       99.7
Java    99.4
C++     97.4
R       88.8
C#      88.8
JavaScript      86.2
PHP     82.3
Go      77.2
Swift   76.5
Time taken: 17.751 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Popularidad-por-Categoría-y-por-Año">
<h2>Popularidad por Categoría y por Año<a class="headerlink" href="#Popularidad-por-Categoría-y-por-Año" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En la siguiente consulta se obtienen los lenguajes más populares para la categoría <code class="docutils literal notranslate"><span class="pre">Mobile</span></code> en el año 2017. En este caso, se usa la función <code class="docutils literal notranslate"><span class="pre">array_contains(categories,</span> <span class="pre">'Mobile')</span></code> que retorna verdadero si <code class="docutils literal notranslate"><span class="pre">Mobile</span></code> aparece en <code class="docutils literal notranslate"><span class="pre">categories</span></code>. Las funciones disponibles pueden ser consultadas en <a class="reference external" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-StringFunctions">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-StringFunctions</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT
    language,
    ranking2018,
    ranking2017,
    ranking2016
FROM (
    SELECT
        language,
        ranking[2018] AS ranking2018,
        ranking[2017] AS ranking2017,
        ranking[2016] AS ranking2016
    FROM
        languages
    WHERE
        array_contains(categories, &#39;Mobile&#39;)
) table1
LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT
    language,
    ranking2018,
    ranking2017,
    ranking2016
FROM (
    SELECT
        language,
        ranking[2018] AS ranking2018,
        ranking[2017] AS ranking2017,
        ranking[2016] AS ranking2016
    FROM
        languages
    WHERE
        array_contains(categories, &#39;Mobile&#39;)
) table1
LIMIT 10;
OK
Actionscript    0.6     0.0     3.3
C       96.7    99.7    100.0
C#      89.4    88.8    86.4
C++     99.7    97.4    95.8
Delphi  38.7    NULL    41.7
Java    97.5    99.4    98.1
JavaScript      82.6    86.2    81.9
Objective-C     50.5    48.4    52.4
Scala   72.1    70.0    66.3
Scheme  18.8    24.5    14.5
Time taken: 0.275 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Expansión-de-la-tabla-por-categoría">
<h2>Expansión de la tabla por categoría<a class="headerlink" href="#Expansión-de-la-tabla-por-categoría" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Es posible generar un registro por cada valor de un campo complejo. En el siguiente ejemplo, se expande la tabla por cada valor del campo <code class="docutils literal notranslate"><span class="pre">categories</span></code>. El proceso de expansión es realizado mediante la instrucción <code class="docutils literal notranslate"><span class="pre">LATERAL</span> <span class="pre">VIEW</span></code> que genera un valor por cada categoría en el campo <code class="docutils literal notranslate"><span class="pre">categories</span></code>, el cual es combinado con el resto de los campos indicados de la instrucción <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT
    language,
    ranking[2018],
    c0
FROM
    languages
LATERAL VIEW
    explode(categories) languages AS c0
LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT
    language,
    ranking[2018],
    c0
FROM
    languages
LATERAL VIEW
    explode(categories) languages AS c0
LIMIT 10;
OK
ABAP    22.8    Enterprise
Actionscript    0.6     Web
Actionscript    0.6     Mobile
Ada     20.9    Enterprise
Ada     20.9    Embedded
Arduino 69.0    Embedded
Assembly        74.1    Embedded
C       96.7    Mobile
C       96.7    Enterprise
C       96.7    Embedded
Time taken: 0.068 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Expansión-de-la-tabla-por-categoría-y-popularidad">
<h2>Expansión de la tabla por categoría y popularidad<a class="headerlink" href="#Expansión-de-la-tabla-por-categoría-y-popularidad" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En el siguiente código, se genera la tabla <code class="docutils literal notranslate"><span class="pre">detail</span></code> que contiene las columnas:</p>
<ul class="simple">
<li><p>Lenguaje</p></li>
<li><p>Año</p></li>
<li><p>Puntaje</p></li>
<li><p>Categoría</p></li>
</ul>
<p>La tabla es llenada mediante la expansión de las columnas <code class="docutils literal notranslate"><span class="pre">ranking</span></code> y <code class="docutils literal notranslate"><span class="pre">categories</span></code>. Note que en este código, primero, se realiza una subconsulta para expandir por el campo <code class="docutils literal notranslate"><span class="pre">categories</span></code> y luego en la consulta principal se expande por el campo <code class="docutils literal notranslate"><span class="pre">ranking</span></code>;</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE IF EXISTS detail;

CREATE TABLE detail
AS
    SELECT
        language,
        key AS year,
        value AS popularity,
        category
    FROM (
        SELECT
            language,
            ranking,
            category
        FROM
            languages
        LATERAL VIEW
            explode(categories) languages AS category
    ) t0
    LATERAL VIEW
        explode(ranking) t0
;

SELECT * FROM detail LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS detail;
OK
Time taken: 0.009 seconds
CREATE TABLE detail
AS
    SELECT
        language,
        key AS year,
        value AS popularity,
        category
    FROM (
        SELECT
            language,
            ranking,
            category
        FROM
            languages
        LATERAL VIEW
            explode(categories) languages AS category
    ) t0
    LATERAL VIEW
        explode(ranking) t0
;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114235736_aa156095-7295-4b4a-8420-f91e9b640297
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there&#39;s no reduce operator
Starting Job = job_1573774297554_0030, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0030/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0030
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2019-11-14 23:57:43,976 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:57:49,235 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.22 sec
MapReduce Total cumulative CPU time: 1 seconds 220 msec
Ended Job = job_1573774297554_0030
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to directory hdfs://0.0.0.0:9000/user/hive/warehouse/.hive-staging_hive_2019-11-14_23-57-36_248_681205234592942397-1/-ext-10001
Moving data to directory hdfs://0.0.0.0:9000/user/hive/warehouse/detail
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1   Cumulative CPU: 1.22 sec   HDFS Read: 9853 HDFS Write: 9876 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 220 msec
OK
Time taken: 14.394 seconds
SELECT * FROM detail LIMIT 10;
OK
ABAP    2018    22.8    Enterprise
ABAP    2017    28.9    Enterprise
ABAP    2016    15.9    Enterprise
ABAP    2015    24.6    Enterprise
ABAP    2014    20.8    Enterprise
Actionscript    2018    0.6     Web
Actionscript    2017    0.0     Web
Actionscript    2016    3.3     Web
Actionscript    2015    6.8     Web
Actionscript    2014    22.0    Web
Time taken: 0.093 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
<p>La instrucción <code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code> permite ver los tipos de datos de la tabla.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DESCRIBE detail;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DESCRIBE detail;
OK
language                string
year                    int
popularity              float
category                string
Time taken: 0.029 seconds, Fetched: 4 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Construcción-de-campos-compuestos">
<h2>Construcción de campos compuestos<a class="headerlink" href="#Construcción-de-campos-compuestos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>También es posible crear datos complejos a partir de los campos de una tabla. En la siguiente consulta, se construye un ARRAY mediante la función <code class="docutils literal notranslate"><span class="pre">collect_set()</span></code> agrupando las catetorias por lenguaje de la tabla <code class="docutils literal notranslate"><span class="pre">detail</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT
    language,
    collect_set(category)
FROM
    detail
GROUP BY
    language
LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT
    language,
    collect_set(category)
FROM
    detail
GROUP BY
    language
LIMIT 10;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114235751_b499f3e7-48a5-430f-8180-103364522333
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&lt;number&gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&lt;number&gt;
In order to set a constant number of reducers:
  set mapreduce.job.reduces=&lt;number&gt;
Starting Job = job_1573774297554_0031, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0031/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0031
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 1
2019-11-14 23:58:00,070 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:58:05,290 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.42 sec
2019-11-14 23:58:09,528 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 2.71 sec
MapReduce Total cumulative CPU time: 2 seconds 710 msec
Ended Job = job_1573774297554_0031
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1  Reduce: 1   Cumulative CPU: 2.71 sec   HDFS Read: 18995 HDFS Write: 426 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 710 msec
OK
ABAP    [&#34;Enterprise&#34;]
ASP.NET [&#34;Web&#34;]
Actionscript    [&#34;Web&#34;,&#34;Mobile&#34;]
Ada     [&#34;Enterprise&#34;,&#34;Embedded&#34;]
Apex Code       [&#34;Enterprise&#34;]
Arduino [&#34;Embedded&#34;]
Assembly        [&#34;Embedded&#34;]
C       [&#34;Mobile&#34;,&#34;Enterprise&#34;,&#34;Embedded&#34;]
C#      [&#34;Web&#34;,&#34;Mobile&#34;,&#34;Enterprise&#34;]
C++     [&#34;Mobile&#34;,&#34; Enterprise&#34;,&#34; Embedded&#34;]
Time taken: 20.304 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
<p>En la siguiente consulta, se construye un MAP a partir del año y la popularidad del lenguaje.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SELECT
    language,
    map(year, popularity) as p,
    category
FROM
    detail
LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SELECT
    language,
    map(year, popularity) as p,
    category
FROM
    detail
LIMIT 10;
OK
ABAP    {2018:22.8}     Enterprise
ABAP    {2017:28.9}     Enterprise
ABAP    {2016:15.9}     Enterprise
ABAP    {2015:24.6}     Enterprise
ABAP    {2014:20.8}     Enterprise
Actionscript    {2018:0.6}      Web
Actionscript    {2017:0.0}      Web
Actionscript    {2016:3.3}      Web
Actionscript    {2015:6.8}      Web
Actionscript    {2014:22.0}     Web
Time taken: 0.13 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
</div>
<div class="section" id="Particionamiento">
<h2>Particionamiento<a class="headerlink" href="#Particionamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Como ya se indicó, las tablas pueden partirse físicamente dependiendo del valor de uno o más campos usados como claves. Esto permite que las búsquedas sean más eficientes, ya que las consultas operan sobre las partficiones. En el siguiente código, se crea la tabla <code class="docutils literal notranslate"><span class="pre">detailpart</span></code> en que la partición está dada por el campo <code class="docutils literal notranslate"><span class="pre">year</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE IF EXISTS detailpart;

CREATE TABLE detailpart (
    language   STRING,
    popularity DOUBLE,
    category   STRING
)
PARTITIONED BY (year INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;\t&#39;
COLLECTION ITEMS TERMINATED BY &#39;,&#39;
MAP KEYS TERMINATED BY &#39;#&#39;
LINES TERMINATED BY &#39;\n&#39;
STORED AS TEXTFILE
LOCATION &#39;/tmp/hive-partitioned&#39;;
;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE IF EXISTS detailpart;
OK
Time taken: 0.007 seconds
CREATE TABLE detailpart (
    language   STRING,
    popularity DOUBLE,
    category   STRING
)
PARTITIONED BY (year INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY &#39;\t&#39;
COLLECTION ITEMS TERMINATED BY &#39;,&#39;
MAP KEYS TERMINATED BY &#39;#&#39;
LINES TERMINATED BY &#39;\n&#39;
STORED AS TEXTFILE
LOCATION &#39;/tmp/hive-partitioned&#39;;
OK
Time taken: 0.046 seconds
;
</pre></div></div>
</div>
<p>Seguidamente, se llena la tabla <code class="docutils literal notranslate"><span class="pre">detailpart</span></code> con la información almacenada en la tabla <code class="docutils literal notranslate"><span class="pre">detail</span></code>. Note que se indicar una instrucción <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">OVERWRITE</span></code> por cada valor posible de la partición (columna <code class="docutils literal notranslate"><span class="pre">year</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
FROM detail
INSERT OVERWRITE TABLE detailpart PARTITION(year=2018)
SELECT
    language,
    popularity,
    category
WHERE
    year=2018
INSERT OVERWRITE TABLE detailpart PARTITION(year=2017)
SELECT
    language,
    popularity,
    category
WHERE
    year=2017
INSERT OVERWRITE TABLE detailpart PARTITION(year=2016)
SELECT
    language,
    popularity,
    category
WHERE
    year=2016
INSERT OVERWRITE TABLE detailpart PARTITION(year=2015)
SELECT
    language,
    popularity,
    category
WHERE
    year=2015
INSERT OVERWRITE TABLE detailpart PARTITION(year=2014)
SELECT
    language,
    popularity,
    category
WHERE
    year=2014
;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FROM detail
INSERT OVERWRITE TABLE detailpart PARTITION(year=2018)
SELECT
    language,
    popularity,
    category
WHERE
    year=2018
INSERT OVERWRITE TABLE detailpart PARTITION(year=2017)
SELECT
    language,
    popularity,
    category
WHERE
    year=2017
INSERT OVERWRITE TABLE detailpart PARTITION(year=2016)
SELECT
    language,
    popularity,
    category
WHERE
    year=2016
INSERT OVERWRITE TABLE detailpart PARTITION(year=2015)
SELECT
    language,
    popularity,
    category
WHERE
    year=2015
INSERT OVERWRITE TABLE detailpart PARTITION(year=2014)
SELECT
    language,
    popularity,
    category
WHERE
    year=2014
;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114235815_7e54c49c-3fa6-48a9-a14e-e3b41298938c
Total jobs = 11
Launching Job 1 out of 11
Number of reduce tasks is set to 0 since there&#39;s no reduce operator
Starting Job = job_1573774297554_0032, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0032/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0032
Hadoop job information for Stage-5: number of mappers: 1; number of reducers: 0
2019-11-14 23:58:21,328 Stage-5 map = 0%,  reduce = 0%
2019-11-14 23:58:26,553 Stage-5 map = 100%,  reduce = 0%, Cumulative CPU 2.48 sec
MapReduce Total cumulative CPU time: 2 seconds 480 msec
Ended Job = job_1573774297554_0032
Stage-8 is selected by condition resolver.
Stage-7 is filtered out by condition resolver.
Stage-9 is filtered out by condition resolver.
Stage-14 is selected by condition resolver.
Stage-13 is filtered out by condition resolver.
Stage-15 is filtered out by condition resolver.
Stage-20 is selected by condition resolver.
Stage-19 is filtered out by condition resolver.
Stage-21 is filtered out by condition resolver.
Stage-26 is selected by condition resolver.
Stage-25 is filtered out by condition resolver.
Stage-27 is filtered out by condition resolver.
Stage-32 is selected by condition resolver.
Stage-31 is filtered out by condition resolver.
Stage-33 is filtered out by condition resolver.
Moving data to directory hdfs://0.0.0.0:9000/tmp/hive-partitioned/year=2018/.hive-staging_hive_2019-11-14_23-58-15_037_5152171077483528852-1/-ext-10000
Moving data to directory hdfs://0.0.0.0:9000/tmp/hive-partitioned/year=2017/.hive-staging_hive_2019-11-14_23-58-15_037_5152171077483528852-1/-ext-10002
Moving data to directory hdfs://0.0.0.0:9000/tmp/hive-partitioned/year=2016/.hive-staging_hive_2019-11-14_23-58-15_037_5152171077483528852-1/-ext-10004
Moving data to directory hdfs://0.0.0.0:9000/tmp/hive-partitioned/year=2015/.hive-staging_hive_2019-11-14_23-58-15_037_5152171077483528852-1/-ext-10006
Moving data to directory hdfs://0.0.0.0:9000/tmp/hive-partitioned/year=2014/.hive-staging_hive_2019-11-14_23-58-15_037_5152171077483528852-1/-ext-10008
Loading data to table default.detailpart partition (year=2018)
Loading data to table default.detailpart partition (year=2017)
Loading data to table default.detailpart partition (year=2016)
Loading data to table default.detailpart partition (year=2015)
Loading data to table default.detailpart partition (year=2014)
MapReduce Jobs Launched:
Stage-Stage-5: Map: 1   Cumulative CPU: 2.48 sec   HDFS Read: 18792 HDFS Write: 12254 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 480 msec
OK
Time taken: 14.112 seconds
</pre></div></div>
</div>
<p>A conitnuación se verifican las particiones creadas.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
SHOW PARTITIONS detailpart;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SHOW PARTITIONS detailpart;
OK
year=2014
year=2015
year=2016
year=2017
year=2018
Time taken: 0.045 seconds, Fetched: 5 row(s)
</pre></div></div>
</div>
<p>En una tabla particionada, se crea un subdirectorio por cada uno de los valores posibles que puede tomar el campo usado para especificar la partición; es así, como existe un directorio para <code class="docutils literal notranslate"><span class="pre">year=2014</span></code>, otro para <code class="docutils literal notranslate"><span class="pre">year=2015</span></code> y así sucesivamente.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -ls /tmp/hive-partitioned
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 5 items
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/hive-partitioned/year=2014
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/hive-partitioned/year=2015
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/hive-partitioned/year=2016
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/hive-partitioned/year=2017
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/hive-partitioned/year=2018
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -ls /tmp/hive-partitioned/year<span class="o">=</span><span class="m">2014</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 1 items
-rwxrwxrwx   1 root supergroup       2347 2019-11-14 23:58 /tmp/hive-partitioned/year=2014/000000_0
</pre></div></div>
</div>
<p>Note que <code class="docutils literal notranslate"><span class="pre">year</span></code> ya no es parte del contenido de la tabla.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -tail /tmp/hive-partitioned/year<span class="o">=</span><span class="m">2014</span>/000000_0
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mobile
Objective-C     63.70000076293945       Enterprise
Ocaml   18.5    Web
Ocaml   18.5    Enterprise
Perl    69.5999984741211        Web
Perl    69.5999984741211        Enterprise
PHP     84.5999984741211        Web
Processing      52.0    Web
Processing      52.0    Enterprise
Prolog  38.599998474121094      Enterprise
Python  93.4000015258789        Web
Python  93.4000015258789        Enterprise
Python  93.4000015258789        Embedded
R       74.0999984741211        Enterprise
Ruby    79.30000305175781       Web
Ruby    79.30000305175781       Enterprise
Rust    \N      Web
Rust    \N      Enterprise
SAS     37.099998474121094      Enterprise
Scala   62.70000076293945       Web
Scala   62.70000076293945       Mobile
Scheme  27.799999237060547      Mobile
Scheme  27.799999237060547      Enterprise
Shell   63.29999923706055       Enterprise
SQL     71.5999984741211        Enterprise
TCL     23.100000381469727      Enterprise
TCL     23.100000381469727      Embedded
Verilog 33.79999923706055       Embedded
VHDL    42.599998474121094      Embedded
Visual Basic    66.0    Enterprise
ASP.NET 35.900001525878906      Web
CoffeeScript    25.5    Web
Apex Code       18.0    Enterprise
Eiffel  6.400000095367432       Enterprise
Scilab  1.0     Enterprise
NetLogo 0.0     Enterprise
</pre></div></div>
</div>
</div>
<div class="section" id="Tablas-externas">
<h2>Tablas externas<a class="headerlink" href="#Tablas-externas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las tablas creadas hasta el momento son completamente manejadas por <code class="docutils literal notranslate"><span class="pre">Hive</span></code>. Sin embargo, estas tablas no son convenientes para compartir directamente información con otras aplicaciones, ya que <code class="docutils literal notranslate"><span class="pre">Hive</span></code> administra los datos. Para analizar la información generada por otras aplicaciones resulta más conveniente usar tablas externas.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
CREATE EXTERNAL TABLE externaltbl
LIKE
    languages
LOCATION &#39;/tmp/externaltbl&#39;;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CREATE EXTERNAL TABLE externaltbl
LIKE
    languages
LOCATION &#39;/tmp/externaltbl&#39;;
OK
Time taken: 0.043 seconds
</pre></div></div>
</div>
<p>La carga de datos se realizar como en los ejemplos anteriores.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
FROM languages
INSERT OVERWRITE TABLE externaltbl
SELECT
    language,
    ranking,
    categories;

SELECT * FROM externaltbl LIMIT 10;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FROM languages
INSERT OVERWRITE TABLE externaltbl
SELECT
    language,
    ranking,
    categories;
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = root_20191114235837_9c7d4ac3-9ef6-4fcf-9616-26cbbe145631
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there&#39;s no reduce operator
Starting Job = job_1573774297554_0033, Tracking URL = http://0982451e3758:8088/proxy/application_1573774297554_0033/
Kill Command = /usr/local/hadoop/bin/hadoop job  -kill job_1573774297554_0033
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2019-11-14 23:58:41,748 Stage-1 map = 0%,  reduce = 0%
2019-11-14 23:58:46,984 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 1.19 sec
MapReduce Total cumulative CPU time: 1 seconds 190 msec
Ended Job = job_1573774297554_0033
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to directory hdfs://0.0.0.0:9000/tmp/externaltbl/.hive-staging_hive_2019-11-14_23-58-37_081_2701677704143997727-1/-ext-10000
Loading data to table default.externaltbl
MapReduce Jobs Launched:
Stage-Stage-1: Map: 1   Cumulative CPU: 1.19 sec   HDFS Read: 7777 HDFS Write: 3581 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 190 msec
OK
Time taken: 11.269 seconds
SELECT * FROM externaltbl LIMIT 10;
OK
ABAP    {2018:22.8,2017:28.9,2016:15.9,2015:24.6,2014:20.8}     [&#34;Enterprise&#34;]
Actionscript    {2018:0.6,2017:0.0,2016:3.3,2015:6.8,2014:22.0} [&#34;Web&#34;,&#34;Mobile&#34;]
Ada     {2018:20.9,2017:29.9,2016:20.5,2015:32.8,2014:30.1}     [&#34;Enterprise&#34;,&#34;Embedded&#34;]
Arduino {2018:69.0,2017:74.4,2016:69.5,2015:63.0,2014:62.9}     [&#34;Embedded&#34;]
Assembly        {2018:74.1,2017:73.4,2016:68.0,2015:67.9,2014:66.9}     [&#34;Embedded&#34;]
C       {2018:96.7,2017:99.7,2016:100.0,2015:99.9,2014:99.2}    [&#34;Mobile&#34;,&#34;Enterprise&#34;,&#34;Embedded&#34;]
C#      {2018:89.4,2017:88.8,2016:86.4,2015:91.8,2014:92.2}     [&#34;Web&#34;,&#34;Mobile&#34;,&#34;Enterprise&#34;]
C++     {2018:99.7,2017:97.4,2016:95.8,2015:99.6,2014:95.5}     [&#34;Mobile&#34;,&#34; Enterprise&#34;,&#34; Embedded&#34;]
Clojure {2018:25.6,2017:28.8,2016:22.0,2015:30.9,2014:36.0}     [&#34;Web&#34;,&#34;Enterprise&#34;]
Cobol   {2018:24.6,2017:29.2,2016:17.9,2015:19.0,2014:30.6}     [&#34;Enterprise&#34;]
Time taken: 0.079 seconds, Fetched: 10 row(s)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -ls /tmp/externaltbl
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 1 items
-rwxrwxrwx   1 root supergroup       3504 2019-11-14 23:58 /tmp/externaltbl/000000_0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -tail /tmp/externaltbl/000000_0
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8,2016#87.7,2015#84.7,2014#74.1 Enterprise
Ruby    2018#71.4,2017#73.9,2016#74.0,2015#75.3,2014#79.3       Web,Enterprise
Rust    2018#41.8,2017#55.0,2016#42.2,2015#29.6,2014#\N Web,Enterprise
SAS     2018#25.6,2017#30.7,2016#21.7,2015#43.7,2014#37.1       Enterprise
Scala   2018#72.1,2017#70.0,2016#66.3,2015#62.4,2014#62.7       Web,Mobile
Scheme  2018#18.8,2017#24.5,2016#14.5,2015#14.8,2014#27.8       Mobile,Enterprise
Shell   2018#66.1,2017#68.6,2016#52.7,2015#71.4,2014#63.3       Enterprise
SQL     2018#49.3,2017#52.8,2016#48.8,2015#70.9,2014#71.6       Enterprise
Swift   2018#53.9,2017#76.5,2016#67.6,2015#62.4 Mobile,Enterprise
TCL     2018#21.9,2017#16.2,2016#8.7,2015#11.6,2014#23.1        Enterprise,Embedded
Verilog 2018#41.2,2017#35.6,2016#25.1,2015#23.7,2014#33.8       Embedded
VHDL    2018#45.4,2017#39.9,2016#33.3,2015#35.4,2014#42.6       Embedded
Visual Basic    2018#45.1,2017#58.9,2016#55.7,2015#63.4,2014#66.0       Enterprise
ASP.NET 2014#35.9       Web
CoffeeScript    2014#25.5       Web
Apex Code       2014#18.0       Enterprise
Eiffel  2014#6.4        Enterprise
Scilab  2014#1.0        Enterprise
NetLogo 2014#0.0        Enterprise
</pre></div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Borrado-de-las-tablas">
<h2>Borrado de las tablas<a class="headerlink" href="#Borrado-de-las-tablas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cuando se borra la tabla <code class="docutils literal notranslate"><span class="pre">languages</span></code> también se borra la carpeta correspondiente del HDFS.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">hive</span>
DROP TABLE languages;
DROP TABLE detail;
DROP TABLE detailpart;
DROP TABLE externaltbl;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DROP TABLE languages;
OK
Time taken: 0.459 seconds
DROP TABLE detail;
OK
Time taken: 0.06 seconds
DROP TABLE detailpart;
OK
Time taken: 0.237 seconds
DROP TABLE externaltbl;
OK
Time taken: 0.04 seconds
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>hdfs dfs -ls /tmp/
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found 5 items
drwxr-xr-x   - root supergroup          0 2019-11-14 23:47 /tmp/drivers
drwxrwxrwx   - root supergroup          0 2019-11-14 23:58 /tmp/externaltbl
drwxrwx---   - root supergroup          0 2019-11-14 23:32 /tmp/hadoop-yarn
drwxrwxrwx   - root supergroup          0 2019-11-14 23:33 /tmp/hive
drwxrwxrwx   - root supergroup          0 2019-11-14 23:35 /tmp/output
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>rm *.tsv *.log
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>