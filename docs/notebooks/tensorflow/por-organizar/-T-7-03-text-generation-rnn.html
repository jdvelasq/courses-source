

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Generación de texto usando una RNN &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>Generación de texto usando una RNN</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/tensorflow/por-organizar/-T-7-03-text-generation-rnn.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Generación-de-texto-usando-una-RNN">
<h1>Generación de texto usando una RNN<a class="headerlink" href="#Generación-de-texto-usando-una-RNN" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>60 min</em> | Última modificación: Julio 13, 2019.</p></li>
</ul>
<p>Adaptado de <a class="reference external" href="https://www.tensorflow.org/tutorials/sequences/text_generation?hl=es">https://www.tensorflow.org/tutorials/sequences/text_generation?hl=es</a></p>
<div class="section" id="Dependencias">
<h2>Dependencias<a class="headerlink" href="#Dependencias" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">enable_eager_execution</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Dataset">
<h2>Dataset<a class="headerlink" href="#Dataset" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path_to_file</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span>
    <span class="s1">&#39;shakespeare.txt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://storage.googleapis.com/download.tensorflow.org/data/shakespeare.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading data from https://storage.googleapis.com/download.tensorflow.org/data/shakespeare.txt
1122304/1115394 [==============================] - 1s 0us/step
</pre></div></div>
</div>
</div>
<div class="section" id="Carga-de-datos">
<h2>Carga de datos<a class="headerlink" href="#Carga-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Length of text: </span><span class="si">{}</span><span class="s1"> characters&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length of text: 1115394 characters
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Take a look at the first 250 characters in text</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">250</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First Citizen:
Before we proceed any further, hear me speak.

All:
Speak, speak.

First Citizen:
You are all resolved rather to die than to famish?

All:
Resolved. resolved.

First Citizen:
First, you know Caius Marcius is chief enemy to the people.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The unique characters in the file</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> unique characters&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
65 unique characters
</pre></div></div>
</div>
</div>
<div class="section" id="Procesamiento-del-texto">
<h2>Procesamiento del texto<a class="headerlink" href="#Procesamiento-del-texto" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Vectorización">
<h3>Vectorización<a class="headerlink" href="#Vectorización" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating a mapping from unique characters to indices</span>
<span class="n">char2idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">u</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vocab</span><span class="p">)}</span>
<span class="n">idx2char</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>

<span class="n">text_as_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">char2idx</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">text</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">char</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">char2idx</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{:4s}</span><span class="s1">: </span><span class="si">{:3d}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">char</span><span class="p">),</span> <span class="n">char2idx</span><span class="p">[</span><span class="n">char</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  ...</span><span class="se">\n</span><span class="s1">}&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
  &#39;\n&#39;:   0,
  &#39; &#39; :   1,
  &#39;!&#39; :   2,
  &#39;$&#39; :   3,
  &#39;&amp;&#39; :   4,
  &#34;&#39;&#34; :   5,
  &#39;,&#39; :   6,
  &#39;-&#39; :   7,
  &#39;.&#39; :   8,
  &#39;3&#39; :   9,
  &#39;:&#39; :  10,
  &#39;;&#39; :  11,
  &#39;?&#39; :  12,
  &#39;A&#39; :  13,
  &#39;B&#39; :  14,
  &#39;C&#39; :  15,
  &#39;D&#39; :  16,
  &#39;E&#39; :  17,
  &#39;F&#39; :  18,
  &#39;G&#39; :  19,
  ...
}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show how the first 13 characters from the text are mapped to integers</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ---- characters mapped to int ---- &gt; </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">13</span><span class="p">]),</span> <span class="n">text_as_int</span><span class="p">[:</span><span class="mi">13</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;First Citizen&#39; ---- characters mapped to int ---- &gt; [18 47 56 57 58  1 15 47 58 47 64 43 52]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Ejemplos-de-entrenamiento-y-prueba">
<h2>Ejemplos de entrenamiento y prueba<a class="headerlink" href="#Ejemplos-de-entrenamiento-y-prueba" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The maximum length sentence we want for a single input in characters</span>
<span class="n">seq_length</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">examples_per_epoch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">//</span><span class="n">seq_length</span>

<span class="c1"># Create training examples / targets</span>
<span class="n">char_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">text_as_int</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">char_dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">numpy</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F
i
r
s
t
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequences</span> <span class="o">=</span> <span class="n">char_dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">seq_length</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sequences</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">numpy</span><span class="p">()])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;First Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou &#39;
&#39;are all resolved rather to die than to famish?\n\nAll:\nResolved. resolved.\n\nFirst Citizen:\nFirst, you k&#39;
&#34;now Caius Marcius is chief enemy to the people.\n\nAll:\nWe know&#39;t, we know&#39;t.\n\nFirst Citizen:\nLet us ki&#34;
&#34;ll him, and we&#39;ll have corn at our own price.\nIs&#39;t a verdict?\n\nAll:\nNo more talking on&#39;t; let it be d&#34;
&#39;one: away, away!\n\nSecond Citizen:\nOne word, good citizens.\n\nFirst Citizen:\nWe are accounted poor citi&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">split_input_target</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
    <span class="n">input_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">target_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">input_text</span><span class="p">,</span> <span class="n">target_text</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">sequences</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">split_input_target</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">input_example</span><span class="p">,</span> <span class="n">target_example</span> <span class="ow">in</span>  <span class="n">dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Input data: &#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">input_example</span><span class="o">.</span><span class="n">numpy</span><span class="p">()])))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Target data:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">target_example</span><span class="o">.</span><span class="n">numpy</span><span class="p">()])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Input data:  &#39;First Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou&#39;
Target data: &#39;irst Citizen:\nBefore we proceed any further, hear me speak.\n\nAll:\nSpeak, speak.\n\nFirst Citizen:\nYou &#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">input_idx</span><span class="p">,</span> <span class="n">target_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_example</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">target_example</span><span class="p">[:</span><span class="mi">5</span><span class="p">])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step </span><span class="si">{:4d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  input: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{:s}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_idx</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">input_idx</span><span class="p">])))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  expected output: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{:s}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_idx</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">target_idx</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Step    0
  input: 18 (&#39;F&#39;)
  expected output: 47 (&#39;i&#39;)
Step    1
  input: 47 (&#39;i&#39;)
  expected output: 56 (&#39;r&#39;)
Step    2
  input: 56 (&#39;r&#39;)
  expected output: 57 (&#39;s&#39;)
Step    3
  input: 57 (&#39;s&#39;)
  expected output: 58 (&#39;t&#39;)
Step    4
  input: 58 (&#39;t&#39;)
  expected output: 1 (&#39; &#39;)
</pre></div></div>
</div>
</div>
<div class="section" id="Batches">
<h2>Batches<a class="headerlink" href="#Batches" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Batch size</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">steps_per_epoch</span> <span class="o">=</span> <span class="n">examples_per_epoch</span><span class="o">//</span><span class="n">BATCH_SIZE</span>

<span class="c1"># Buffer size to shuffle the dataset</span>
<span class="c1"># (TF data is designed to work with possibly infinite sequences,</span>
<span class="c1"># so it doesn&#39;t attempt to shuffle the entire sequence in memory. Instead,</span>
<span class="c1"># it maintains a buffer in which it shuffles elements).</span>
<span class="n">BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">BUFFER_SIZE</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;DatasetV1Adapter shapes: ((64, 100), (64, 100)), types: (tf.int64, tf.int64)&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Modelo">
<h2>Modelo<a class="headerlink" href="#Modelo" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Length of the vocabulary in chars</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>

<span class="c1"># The embedding dimension</span>
<span class="n">embedding_dim</span> <span class="o">=</span> <span class="mi">256</span>

<span class="c1"># Number of RNN units</span>
<span class="n">rnn_units</span> <span class="o">=</span> <span class="mi">1024</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">is_gpu_available</span><span class="p">():</span>
    <span class="n">rnn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">CuDNNGRU</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">functools</span>
    <span class="n">rnn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GRU</span><span class="p">,</span>
        <span class="n">recurrent_activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">rnn_units</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span>
                                  <span class="n">batch_input_shape</span><span class="o">=</span><span class="p">[</span><span class="n">batch_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span>
        <span class="n">rnn</span><span class="p">(</span><span class="n">rnn_units</span><span class="p">,</span>
            <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">recurrent_initializer</span><span class="o">=</span><span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span>
            <span class="n">stateful</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span>
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">),</span>
    <span class="n">embedding_dim</span><span class="o">=</span><span class="n">embedding_dim</span><span class="p">,</span>
    <span class="n">rnn_units</span><span class="o">=</span><span class="n">rnn_units</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Prueba-del-modelo">
<h2>Prueba del modelo<a class="headerlink" href="#Prueba-del-modelo" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">input_example_batch</span><span class="p">,</span> <span class="n">target_example_batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">example_batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_example_batch</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">example_batch_predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;# (batch_size, sequence_length, vocab_size)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(64, 100, 65) # (batch_size, sequence_length, vocab_size)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding (Embedding)        (64, None, 256)           16640
_________________________________________________________________
gru (GRU)                    (64, None, 1024)          3935232
_________________________________________________________________
dense (Dense)                (64, None, 65)            66625
=================================================================
Total params: 4,018,497
Trainable params: 4,018,497
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">categorical</span><span class="p">(</span><span class="n">example_batch_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">sampled_indices</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sampled_indices</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([13, 32,  8, 31, 24,  9, 36, 24, 49, 30, 12, 11, 43, 47, 43, 11, 54,
       62, 16,  9, 45, 58, 57, 13, 10, 25, 58,  5, 45, 44, 12, 50, 56, 39,
       32, 44, 55, 43, 13, 59, 11, 40, 32, 23,  2, 62,  4, 45, 49, 30, 30,
       30, 20, 60, 45,  9,  8, 11,  0,  6, 18, 16,  3, 31, 28, 11, 49, 33,
       41, 37, 38,  7,  4, 17, 14,  8, 19, 50, 37, 24,  3, 54, 43,  9, 43,
       62, 27, 26, 20, 62, 10, 43, 16, 60, 29, 23, 14, 47, 62, 57])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">input_example_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]])))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Next Char Predictions: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">sampled_indices</span> <span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Input:
 &#39;nly face, which promiseth\nSuccessful fortune, steel thy melting heart\nTo hold thine own and leave th&#39;

Next Char Predictions:
 &#34;AT.SL3XLkR?;eie;pxD3gtsA:Mt&#39;gf?lraTfqeAu;bTK!x&amp;gkRRRHvg3.;\n,FD$SP;kUcYZ-&amp;EB.GlYL$pe3exONHx:eDvQKBixs&#34;
</pre></div></div>
</div>
</div>
<div class="section" id=" Entrenamiento-del-modelo">
<h2> Entrenamiento del modelo<a class="headerlink" href="# Entrenamiento-del-modelo" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">logits</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">sparse_categorical_crossentropy</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span>
                                                           <span class="n">logits</span><span class="p">,</span>
                                                           <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">example_batch_loss</span>  <span class="o">=</span> <span class="n">loss</span><span class="p">(</span>
    <span class="n">target_example_batch</span><span class="p">,</span>
    <span class="n">example_batch_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction shape: &quot;</span><span class="p">,</span> <span class="n">example_batch_predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot; # (batch_size, sequence_length, vocab_size)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scalar_loss:      &quot;</span><span class="p">,</span> <span class="n">example_batch_loss</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Prediction shape:  (64, 100, 65)  # (batch_size, sequence_length, vocab_size)
scalar_loss:       4.1749997
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(),</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Directory where the checkpoints will be saved</span>
<span class="n">checkpoint_dir</span> <span class="o">=</span> <span class="s1">&#39;./training_checkpoints&#39;</span>
<span class="c1"># Name of the checkpoint files</span>
<span class="n">checkpoint_prefix</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">,</span> <span class="s2">&quot;ckpt_</span><span class="si">{epoch}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">checkpoint_callback</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span>
    <span class="n">filepath</span><span class="o">=</span><span class="n">checkpoint_prefix</span><span class="p">,</span>
    <span class="n">save_weights_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">EPOCHS</span><span class="o">=</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">repeat</span><span class="p">(),</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span>
    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps_per_epoch</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint_callback</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/3
174/174 [==============================] - 560s 3s/step - loss: 2.7017
Epoch 2/3
174/174 [==============================] - 531s 3s/step - loss: 1.9358
Epoch 3/3
174/174 [==============================] - 520s 3s/step - loss: 1.6775
</pre></div></div>
</div>
</div>
<div class="section" id="Generación-de-textos">
<h2>Generación de textos<a class="headerlink" href="#Generación-de-textos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">latest_checkpoint</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;./training_checkpoints/ckpt_3&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">rnn_units</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">latest_checkpoint</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;sequential_1&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (1, None, 256)            16640
_________________________________________________________________
gru_1 (GRU)                  (1, None, 1024)           3935232
_________________________________________________________________
dense_1 (Dense)              (1, None, 65)             66625
=================================================================
Total params: 4,018,497
Trainable params: 4,018,497
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">generate_text</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">start_string</span><span class="p">):</span>
    <span class="c1"># Evaluation step (generating text using the learned model)</span>

    <span class="c1"># Number of characters to generate</span>
    <span class="n">num_generate</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Converting our start string to numbers (vectorizing)</span>
    <span class="n">input_eval</span> <span class="o">=</span> <span class="p">[</span><span class="n">char2idx</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start_string</span><span class="p">]</span>
    <span class="n">input_eval</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">input_eval</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Empty string to store our results</span>
    <span class="n">text_generated</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Low temperatures results in more predictable text.</span>
    <span class="c1"># Higher temperatures results in more surprising text.</span>
    <span class="c1"># Experiment to find the best setting.</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Here batch size == 1</span>
    <span class="n">model</span><span class="o">.</span><span class="n">reset_states</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_generate</span><span class="p">):</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_eval</span><span class="p">)</span>
        <span class="c1"># remove the batch dimension</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># using a multinomial distribution to predict the word returned by the model</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">/</span> <span class="n">temperature</span>
        <span class="n">predicted_id</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

        <span class="c1"># We pass the predicted word as the next input to the model</span>
        <span class="c1"># along with the previous hidden state</span>
        <span class="n">input_eval</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">([</span><span class="n">predicted_id</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">text_generated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx2char</span><span class="p">[</span><span class="n">predicted_id</span><span class="p">])</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">start_string</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_generated</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">generate_text</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">start_string</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;ROMEO: &quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: Logging before flag parsing goes to stderr.
W0713 04:23:36.927299 140546208786240 deprecation.py:323] From &lt;ipython-input-32-d2043beadb11&gt;:28: multinomial (from tensorflow.python.ops.random_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.random.categorical` instead.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ROMEO: illess, tite be kine here dot the heirs, that I love, forthura&#39;s citured
My tontuch he&#39;s pecreatiness, peace who some to are my wast.
Ald, you most thy se?
To mens love thanks that dear: brother
Unde, sir, ficuled, gistion, I love, Some it
Thy dies truitors him: to him.
Go alight where you have me, till this.

HARTIONS:
Openst you&#39;ll hered-wark to bade you most shalt weapt
Wo&#39;ld he so to which done.

DuRCHOSSA:
You dim wither; finewill; herdendy than it, playfed
We would batide on me, if it slow forniel
Provised my lord, till you sended. Terrshay,
Will I have fought he his done-to figlt?
But their wars, with wither beart to sbeath,
Dead not the wortdes rugged latt, sent, I Lodtand you.

MIRCAUNIA:
I&#39; this you slaught to hels night.
Out ebent.

TARILIUS:
Which, sold by our given!&#39;O:
Confior, as this diesten to the cold:
I&#39;ll take to privire knowngy.
Come, pity servant up&#39;d I
make an ond confliartitoby tribunds he was notabe lott
of yourdmand,
Jetone upon earthallow that would be this
ni
</pre></div></div>
</div>
</div>
<div class="section" id=" Personalización-del-entrenamiento">
<h2> Personalización del entrenamiento<a class="headerlink" href="# Personalización-del-entrenamiento" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span>
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">),</span>
    <span class="n">embedding_dim</span><span class="o">=</span><span class="n">embedding_dim</span><span class="p">,</span>
    <span class="n">rnn_units</span><span class="o">=</span><span class="n">rnn_units</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Training step</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># initializing the hidden state at the start of every epoch</span>
    <span class="c1"># initially hidden is None</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">reset_states</span><span class="p">()</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">batch_n</span><span class="p">,</span> <span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
            <span class="c1"># feeding the hidden state back into the model</span>
            <span class="c1"># This is the interesting step</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">sparse_softmax_cross_entropy</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>

        <span class="n">grads</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">batch_n</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1"> Batch </span><span class="si">{}</span><span class="s1"> Loss </span><span class="si">{:.4f}</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_n</span><span class="p">,</span> <span class="n">loss</span><span class="p">))</span>

    <span class="c1"># saving (checkpoint) the model every 5 epochs</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">checkpoint_prefix</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">=</span><span class="n">epoch</span><span class="p">))</span>

    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1"> Loss </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">loss</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Time taken for 1 epoch </span><span class="si">{}</span><span class="s1"> sec</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>

<span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">checkpoint_prefix</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">=</span><span class="n">epoch</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
W0713 04:23:54.989645 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer
W0713 04:23:54.990790 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer
W0713 04:23:54.991653 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.global_step
W0713 04:23:54.992785 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer.beta1_power
W0713 04:23:54.993620 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer.beta2_power
W0713 04:23:54.994517 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-0.embeddings
W0713 04:23:54.995149 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-2.kernel
W0713 04:23:54.996005 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-2.bias
W0713 04:23:54.996820 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-1.cell.kernel
W0713 04:23:54.997497 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-1.cell.recurrent_kernel
W0713 04:23:54.998423 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;m&#39; for (root).layer_with_weights-1.cell.bias
W0713 04:23:54.998963 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-0.embeddings
W0713 04:23:54.999600 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-2.kernel
W0713 04:23:55.000453 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-2.bias
W0713 04:23:55.000999 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-1.cell.kernel
W0713 04:23:55.001714 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-1.cell.recurrent_kernel
W0713 04:23:55.002363 140546208786240 util.py:244] Unresolved object in checkpoint: (root).optimizer.optimizer&#39;s state &#39;v&#39; for (root).layer_with_weights-1.cell.bias
W0713 04:23:55.003088 140546208786240 util.py:252] A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/alpha/guide/checkpoints#loading_mechanics for details.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1 Batch 0 Loss 4.1757
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-36-f4eab3d5c489&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>             <span class="ansi-red-fg"># feeding the hidden state back into the model</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>             <span class="ansi-red-fg"># This is the interesting step</span>
<span class="ansi-green-fg">---&gt; 15</span><span class="ansi-red-fg">             </span>predictions <span class="ansi-blue-fg">=</span> model<span class="ansi-blue-fg">(</span>inp<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span>             loss <span class="ansi-blue-fg">=</span> tf<span class="ansi-blue-fg">.</span>losses<span class="ansi-blue-fg">.</span>sparse_softmax_cross_entropy<span class="ansi-blue-fg">(</span>target<span class="ansi-blue-fg">,</span> predictions<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, inputs, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    677</span>           with base_layer_utils.autocast_context_manager(
<span class="ansi-green-intense-fg ansi-bold">    678</span>               input_list, self._mixed_precision_policy.should_cast_variables):
<span class="ansi-green-fg">--&gt; 679</span><span class="ansi-red-fg">             </span>outputs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>call<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    680</span>           self<span class="ansi-blue-fg">.</span>_handle_activity_regularization<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> outputs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    681</span>           self<span class="ansi-blue-fg">.</span>_set_mask_metadata<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> outputs<span class="ansi-blue-fg">,</span> previous_mask<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/sequential.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, training, mask)</span>
<span class="ansi-green-intense-fg ansi-bold">    245</span>       <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>built<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>         self<span class="ansi-blue-fg">.</span>_init_graph_network<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>inputs<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>outputs<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 247</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> super<span class="ansi-blue-fg">(</span>Sequential<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>call<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> training<span class="ansi-blue-fg">=</span>training<span class="ansi-blue-fg">,</span> mask<span class="ansi-blue-fg">=</span>mask<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span>
<span class="ansi-green-intense-fg ansi-bold">    249</span>     outputs <span class="ansi-blue-fg">=</span> inputs  <span class="ansi-red-fg"># handle the corner case where self.layers is empty</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/network.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, training, mask)</span>
<span class="ansi-green-intense-fg ansi-bold">    749</span>                                 &#39; implement a `call` method.&#39;)
<span class="ansi-green-intense-fg ansi-bold">    750</span>
<span class="ansi-green-fg">--&gt; 751</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_run_internal_graph<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> training<span class="ansi-blue-fg">=</span>training<span class="ansi-blue-fg">,</span> mask<span class="ansi-blue-fg">=</span>mask<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    752</span>
<span class="ansi-green-intense-fg ansi-bold">    753</span>   <span class="ansi-green-fg">def</span> compute_output_shape<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input_shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/network.py</span> in <span class="ansi-cyan-fg">_run_internal_graph</span><span class="ansi-blue-fg">(self, inputs, training, mask)</span>
<span class="ansi-green-intense-fg ansi-bold">    891</span>
<span class="ansi-green-intense-fg ansi-bold">    892</span>           <span class="ansi-red-fg"># Compute outputs.</span>
<span class="ansi-green-fg">--&gt; 893</span><span class="ansi-red-fg">           </span>output_tensors <span class="ansi-blue-fg">=</span> layer<span class="ansi-blue-fg">(</span>computed_tensors<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    894</span>
<span class="ansi-green-intense-fg ansi-bold">    895</span>           <span class="ansi-red-fg"># Update tensor_dict.</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/recurrent.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, inputs, initial_state, constants, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    617</span>
<span class="ansi-green-intense-fg ansi-bold">    618</span>     <span class="ansi-green-fg">if</span> initial_state <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> constants <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 619</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> super<span class="ansi-blue-fg">(</span>RNN<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    620</span>
<span class="ansi-green-intense-fg ansi-bold">    621</span>     <span class="ansi-red-fg"># If any of `initial_state` or `constants` are specified and are Keras</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, inputs, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    677</span>           with base_layer_utils.autocast_context_manager(
<span class="ansi-green-intense-fg ansi-bold">    678</span>               input_list, self._mixed_precision_policy.should_cast_variables):
<span class="ansi-green-fg">--&gt; 679</span><span class="ansi-red-fg">             </span>outputs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>call<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    680</span>           self<span class="ansi-blue-fg">.</span>_handle_activity_regularization<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> outputs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    681</span>           self<span class="ansi-blue-fg">.</span>_set_mask_metadata<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> outputs<span class="ansi-blue-fg">,</span> previous_mask<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/recurrent.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, mask, training, initial_state)</span>
<span class="ansi-green-intense-fg ansi-bold">   1905</span>     self<span class="ansi-blue-fg">.</span>cell<span class="ansi-blue-fg">.</span>reset_recurrent_dropout_mask<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1906</span>     return super(GRU, self).call(
<span class="ansi-green-fg">-&gt; 1907</span><span class="ansi-red-fg">         inputs, mask=mask, training=training, initial_state=initial_state)
</span><span class="ansi-green-intense-fg ansi-bold">   1908</span>
<span class="ansi-green-intense-fg ansi-bold">   1909</span>   <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/recurrent.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, mask, training, initial_state, constants)</span>
<span class="ansi-green-intense-fg ansi-bold">    741</span>         input_length<span class="ansi-blue-fg">=</span>timesteps<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    742</span>         time_major<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>time_major<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 743</span><span class="ansi-red-fg">         zero_output_for_mask=self.zero_output_for_mask)
</span><span class="ansi-green-intense-fg ansi-bold">    744</span>     <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>stateful<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    745</span>       updates <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py</span> in <span class="ansi-cyan-fg">rnn</span><span class="ansi-blue-fg">(step_function, inputs, initial_states, go_backwards, mask, constants, unroll, input_length, time_major, zero_output_for_mask)</span>
<span class="ansi-green-intense-fg ansi-bold">   3850</span>           body<span class="ansi-blue-fg">=</span>_step<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   3851</span>           loop_vars<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span>time<span class="ansi-blue-fg">,</span> output_ta<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> states<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 3852</span><span class="ansi-red-fg">           **while_loop_kwargs)
</span><span class="ansi-green-intense-fg ansi-bold">   3853</span>       new_states <span class="ansi-blue-fg">=</span> final_outputs<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   3854</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py</span> in <span class="ansi-cyan-fg">while_loop</span><span class="ansi-blue-fg">(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name, maximum_iterations, return_same_structure)</span>
<span class="ansi-green-intense-fg ansi-bold">   3461</span>
<span class="ansi-green-intense-fg ansi-bold">   3462</span>       <span class="ansi-green-fg">while</span> cond<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>loop_vars<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 3463</span><span class="ansi-red-fg">         </span>loop_vars <span class="ansi-blue-fg">=</span> body<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>loop_vars<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3464</span>         <span class="ansi-green-fg">if</span> try_to_pack <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>loop_vars<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>list<span class="ansi-blue-fg">,</span> _basetuple<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   3465</span>           packed <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py</span> in <span class="ansi-cyan-fg">&lt;lambda&gt;</span><span class="ansi-blue-fg">(i, lv)</span>
<span class="ansi-green-intense-fg ansi-bold">   3454</span>         cond = lambda i, lv: (  # pylint: disable=g-long-lambda
<span class="ansi-green-intense-fg ansi-bold">   3455</span>             math_ops.logical_and(i &lt; maximum_iterations, orig_cond(*lv)))
<span class="ansi-green-fg">-&gt; 3456</span><span class="ansi-red-fg">         </span>body <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">lambda</span> i<span class="ansi-blue-fg">,</span> lv<span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">(</span>i <span class="ansi-blue-fg">+</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> orig_body<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>lv<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3457</span>
<span class="ansi-green-intense-fg ansi-bold">   3458</span>     <span class="ansi-green-fg">if</span> executing_eagerly<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py</span> in <span class="ansi-cyan-fg">_step</span><span class="ansi-blue-fg">(time, output_ta_t, *states)</span>
<span class="ansi-green-intense-fg ansi-bold">   3834</span>         current_input <span class="ansi-blue-fg">=</span> nest<span class="ansi-blue-fg">.</span>pack_sequence_as<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> current_input<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3835</span>         output, new_states = step_function(current_input,
<span class="ansi-green-fg">-&gt; 3836</span><span class="ansi-red-fg">                                            tuple(states) + tuple(constants))
</span><span class="ansi-green-intense-fg ansi-bold">   3837</span>         flat_state <span class="ansi-blue-fg">=</span> nest<span class="ansi-blue-fg">.</span>flatten<span class="ansi-blue-fg">(</span>states<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3838</span>         flat_new_state <span class="ansi-blue-fg">=</span> nest<span class="ansi-blue-fg">.</span>flatten<span class="ansi-blue-fg">(</span>new_states<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/recurrent.py</span> in <span class="ansi-cyan-fg">step</span><span class="ansi-blue-fg">(inputs, states)</span>
<span class="ansi-green-intense-fg ansi-bold">    726</span>       <span class="ansi-green-fg">def</span> step<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> states<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    727</span>         states <span class="ansi-blue-fg">=</span> states<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>states<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">1</span> <span class="ansi-green-fg">and</span> is_tf_rnn_cell <span class="ansi-green-fg">else</span> states
<span class="ansi-green-fg">--&gt; 728</span><span class="ansi-red-fg">         </span>output<span class="ansi-blue-fg">,</span> new_states <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>cell<span class="ansi-blue-fg">.</span>call<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> states<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    729</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> nest<span class="ansi-blue-fg">.</span>is_sequence<span class="ansi-blue-fg">(</span>new_states<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    730</span>           new_states <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>new_states<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/recurrent.py</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, states, training)</span>
<span class="ansi-green-intense-fg ansi-bold">   1636</span>
<span class="ansi-green-intense-fg ansi-bold">   1637</span>       x_z <span class="ansi-blue-fg">=</span> K<span class="ansi-blue-fg">.</span>dot<span class="ansi-blue-fg">(</span>inputs_z<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>kernel<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">:</span>self<span class="ansi-blue-fg">.</span>units<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1638</span><span class="ansi-red-fg">       </span>x_r <span class="ansi-blue-fg">=</span> K<span class="ansi-blue-fg">.</span>dot<span class="ansi-blue-fg">(</span>inputs_r<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>kernel<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>units<span class="ansi-blue-fg">:</span>self<span class="ansi-blue-fg">.</span>units <span class="ansi-blue-fg">*</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1639</span>       x_h <span class="ansi-blue-fg">=</span> K<span class="ansi-blue-fg">.</span>dot<span class="ansi-blue-fg">(</span>inputs_h<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>kernel<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>units <span class="ansi-blue-fg">*</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1640</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py</span> in <span class="ansi-cyan-fg">dot</span><span class="ansi-blue-fg">(x, y)</span>
<span class="ansi-green-intense-fg ansi-bold">   1631</span>     out <span class="ansi-blue-fg">=</span> sparse_ops<span class="ansi-blue-fg">.</span>sparse_tensor_dense_matmul<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1632</span>   <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1633</span><span class="ansi-red-fg">     </span>out <span class="ansi-blue-fg">=</span> math_ops<span class="ansi-blue-fg">.</span>matmul<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1634</span>   <span class="ansi-green-fg">return</span> out
<span class="ansi-green-intense-fg ansi-bold">   1635</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/dispatch.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span>     <span class="ansi-blue-fg">&#34;&#34;&#34;Call target, and fall back on dispatchers if there is a TypeError.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    179</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 180</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">return</span> target<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    181</span>     <span class="ansi-green-fg">except</span> <span class="ansi-blue-fg">(</span>TypeError<span class="ansi-blue-fg">,</span> ValueError<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    182</span>       <span class="ansi-red-fg"># Note: convert_to_eager_tensor currently raises a ValueError, not a</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py</span> in <span class="ansi-cyan-fg">matmul</span><span class="ansi-blue-fg">(a, b, transpose_a, transpose_b, adjoint_a, adjoint_b, a_is_sparse, b_is_sparse, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   2645</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2646</span>       return gen_math_ops.mat_mul(
<span class="ansi-green-fg">-&gt; 2647</span><span class="ansi-red-fg">           a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)
</span><span class="ansi-green-intense-fg ansi-bold">   2648</span>
<span class="ansi-green-intense-fg ansi-bold">   2649</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_math_ops.py</span> in <span class="ansi-cyan-fg">mat_mul</span><span class="ansi-blue-fg">(a, b, transpose_a, transpose_b, name)</span>
<span class="ansi-green-intense-fg ansi-bold">   5899</span>         _ctx<span class="ansi-blue-fg">.</span>_context_handle<span class="ansi-blue-fg">,</span> _ctx<span class="ansi-blue-fg">.</span>_thread_local_data<span class="ansi-blue-fg">.</span>device_name<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;MatMul&#34;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   5900</span>         name<span class="ansi-blue-fg">,</span> _ctx<span class="ansi-blue-fg">.</span>_post_execution_callbacks<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;transpose_a&#34;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 5901</span><span class="ansi-red-fg">         transpose_a, &#34;transpose_b&#34;, transpose_b)
</span><span class="ansi-green-intense-fg ansi-bold">   5902</span>       <span class="ansi-green-fg">return</span> _result
<span class="ansi-green-intense-fg ansi-bold">   5903</span>     <span class="ansi-green-fg">except</span> _core<span class="ansi-blue-fg">.</span>_FallbackException<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>