

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Aprendizaje batch, online, minibatch y Gradiente Descendente Estocástico (SGD) &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Algoritmos para modificar la tasa de aprendizaje" href="2-06-tasa-de-aprendizaje.html" />
    <link rel="prev" title="Regla delta generalizada y algoritmos con supermemoria" href="1-04-momentum.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Aprendizaje batch, online, minibatch y Gradiente Descendente Estocástico (SGD)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/fundamentals/2-05-apren-batch-online-SGD.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Aprendizaje-batch,-online,-minibatch-y-Gradiente-Descendente-Estocástico-(SGD)">
<h1>Aprendizaje batch, online, minibatch y Gradiente Descendente Estocástico (SGD)<a class="headerlink" href="#Aprendizaje-batch,-online,-minibatch-y-Gradiente-Descendente-Estocástico-(SGD)" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>30 min</em> | Ultima modificación: Marzo 17, 2020</p></li>
</ul>
<p>A continuación se presentan las diferencias entre aprendizaje batch, online y SGD.</p>
<div class="section" id="Aprendizaje-batch-o-aprendizaje-por-lotes">
<h2>Aprendizaje batch o aprendizaje por lotes<a class="headerlink" href="#Aprendizaje-batch-o-aprendizaje-por-lotes" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Es el que se ha usado en los casos anteriores. Se minimiza el error computado sobre la muestra de datos.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\text{SSE} &amp; = \sum_i (d_i - y_i)^2 \\
 &amp; = \sum_i (d_i - w_0 - w_1 x_i)^2
\end{split}\end{split}\]</div>
<p>Note que en este caso, el gradiente de la función SSE() es la suma del gradiente del error para cada punto (ejemplo) del conjunto de datos:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})
  &amp; = \frac{\partial}{\partial \mathbf{w}} \sum_i (d_i - y_{i, k-1})^2 \\
  &amp; = \sum_i \frac{\partial}{\partial \mathbf{w}}  (d_i - y_{i, k-1})^2 \\
  &amp; = \sum_i \frac{\partial}{\partial \mathbf{w}} (d_i - w_0 - w_1 x_i)^2 \\
  &amp; = \sum_i \frac{\partial}{\partial \mathbf{w}} e_i^2 \\
  &amp; = \sum_i 2 e_i \frac{\partial}{\partial \mathbf{w}} e_i
\end{split}\end{split}\]</div>
<p>Es decir, se calcula el gradiente neto (la sumatoria sobre todos los puntos) y luego se corrigen los pesos. Si tiene dudas o no comprende completamente el procedimiento, repase el material de las secciones anteriores.</p>
<p>Se llama aprendizaje batch o aprendizaje por lotes porque se presentan todos los datos en un solo lote antes de realizar la correción de los pesos.</p>
<p>A continuación se reproduce el código de las secciones anteriores para efectos comparativos.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.1087</span><span class="p">,</span>
    <span class="mf">0.2698</span><span class="p">,</span>
    <span class="mf">0.3765</span><span class="p">,</span>
    <span class="mf">0.2146</span><span class="p">,</span>
    <span class="mf">0.9155</span><span class="p">,</span>
    <span class="mf">0.0246</span><span class="p">,</span>
    <span class="mf">0.0221</span><span class="p">,</span>
    <span class="mf">0.8632</span><span class="p">,</span>
    <span class="mf">0.6460</span><span class="p">,</span>
    <span class="mf">0.2092</span><span class="p">,</span>
    <span class="mf">0.8567</span><span class="p">,</span>
    <span class="mf">0.1591</span><span class="p">,</span>
    <span class="mf">0.9647</span><span class="p">,</span>
    <span class="mf">0.6231</span><span class="p">,</span>
    <span class="mf">0.7460</span><span class="p">,</span>
    <span class="mf">0.3654</span><span class="p">,</span>
    <span class="mf">0.3065</span><span class="p">,</span>
    <span class="mf">0.6886</span><span class="p">,</span>
    <span class="mf">0.4966</span><span class="p">,</span>
    <span class="mf">0.2008</span><span class="p">,</span>
    <span class="mf">0.2618</span><span class="p">,</span>
    <span class="mf">0.7607</span><span class="p">,</span>
    <span class="mf">0.1563</span><span class="p">,</span>
    <span class="mf">0.4424</span><span class="p">,</span>
    <span class="mf">0.7731</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.9519</span><span class="p">,</span>
    <span class="mf">1.1237</span><span class="p">,</span>
    <span class="mf">1.2360</span><span class="p">,</span>
    <span class="mf">1.0526</span><span class="p">,</span>
    <span class="mf">2.0743</span><span class="p">,</span>
    <span class="mf">0.7906</span><span class="p">,</span>
    <span class="mf">0.7603</span><span class="p">,</span>
    <span class="mf">2.0533</span><span class="p">,</span>
    <span class="mf">1.6887</span><span class="p">,</span>
    <span class="mf">1.0563</span><span class="p">,</span>
    <span class="mf">2.0991</span><span class="p">,</span>
    <span class="mf">0.8953</span><span class="p">,</span>
    <span class="mf">2.1917</span><span class="p">,</span>
    <span class="mf">1.6266</span><span class="p">,</span>
    <span class="mf">1.8508</span><span class="p">,</span>
    <span class="mf">1.2828</span><span class="p">,</span>
    <span class="mf">1.2283</span><span class="p">,</span>
    <span class="mf">1.8722</span><span class="p">,</span>
    <span class="mf">1.4657</span><span class="p">,</span>
    <span class="mf">1.0418</span><span class="p">,</span>
    <span class="mf">1.1097</span><span class="p">,</span>
    <span class="mf">1.7826</span><span class="p">,</span>
    <span class="mf">0.9711</span><span class="p">,</span>
    <span class="mf">1.4267</span><span class="p">,</span>
    <span class="mf">1.8248</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">SSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)])</span>


<span class="n">W0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">W0</span><span class="p">,</span> <span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">W0</span><span class="p">,</span> <span class="n">W1</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">SSE</span><span class="p">(</span><span class="n">W0</span><span class="p">,</span> <span class="n">W1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_contour</span><span class="p">():</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">W0</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">gSSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)]</span>
    <span class="n">gw0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">gw1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">q</span> <span class="o">*</span> <span class="n">v</span> <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span> <span class="o">=</span> <span class="n">gSSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
    <span class="n">w0</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw0</span>
    <span class="n">w1</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>


<span class="c1"># Punto de inicio</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">history_w0</span> <span class="o">=</span> <span class="p">[</span><span class="n">w0</span><span class="p">]</span>
<span class="n">history_w1</span> <span class="o">=</span> <span class="p">[</span><span class="n">w1</span><span class="p">]</span>
<span class="n">history_f</span> <span class="o">=</span> <span class="p">[</span><span class="n">SSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">mejora</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
    <span class="n">history_w0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
    <span class="n">history_w1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
    <span class="n">history_f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SSE</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valores encontrados</span><span class="se">\n\n</span><span class="s2">  w0 = </span><span class="si">{:f}</span><span class="se">\n</span><span class="s2">  w1 = </span><span class="si">{:f}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>

<span class="n">plot_contour</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 = 0.675531
  w1 = 1.643269


</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_10_1.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_10_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_11_0.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_11_0.png" />
</div>
</div>
</div>
<div class="section" id="Aprendizaje-Online-(en-línea)">
<h2>Aprendizaje Online (en línea)<a class="headerlink" href="#Aprendizaje-Online-(en-línea)" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Note que en el aprendizaje por lotes, la función a mnimizar es la suma de errores instantaneos al cuadrado:</p>
<div class="math notranslate nohighlight">
\[\text{SSE}(\mathbf{w}_{k-1}) = \sum_i e_i^2\]</div>
<p>tal que la derivada del error es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{\partial}{\partial \mathbf{w}} \text{SSE}(\mathbf{w}_{k-1})
  &amp; = \sum_i \frac{\partial}{\partial \mathbf{w}} e_i^2 \\
  &amp; = \sum_i 2 e_i \frac{\partial}{\partial \mathbf{w}} e_i
\end{split}\end{split}\]</div>
<p>En el aprendizaje en línea se desea minimizar el cuadrado del error instantaneo <span class="math notranslate nohighlight">\(e_i\)</span>, o:</p>
<div class="math notranslate nohighlight">
\[e_{i,k}(w_{0,i,k}, w_{1,i,k}) = d_i - w_{0,i,k-1} - w_{1,i,k-1}\]</div>
<p>que es una función dependiente de los parámetros <span class="math notranslate nohighlight">\(\mathbf{w}\)</span>. De esta forma, la correción de los parámetros se realizar por cada patrón o ejemplo <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_{i,k}
  = \mathbf{w}_{i,k-1} - \mu \frac{\partial}{\partial \mathbf{w}} e_{i,k-1}^2(\mathbf{w}_{i, k-1})\]</div>
<p>En este algoritmo, los patrones o ejemplos de datos usualmente son recorridos secuencialmente (en orden).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">gOnline</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span>  <span class="c1"># se calcula el error instantaneo para el punto (u, v)</span>
    <span class="n">gw0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">e</span>  <span class="c1"># gradiente de w0</span>
    <span class="n">gw1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">e</span> <span class="o">*</span> <span class="n">u</span>  <span class="c1"># gradiente de w1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mejora</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">gw0</span><span class="p">,</span> <span class="n">gw1</span> <span class="o">=</span> <span class="n">gOnline</span><span class="p">(</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span>
    <span class="p">)</span>  <span class="c1"># computa el gradiente para los parámetros actuales</span>
    <span class="n">w0</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw0</span>  <span class="c1"># realiza la corrección de los parámetros</span>
    <span class="n">w1</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">gw1</span>  <span class="c1">#</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>  <span class="c1"># retorna los parámetros corregidos</span>


<span class="c1">#</span>
<span class="c1"># Punto de inicio</span>
<span class="c1">#</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">history_w0</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">history_w1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">history_f</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>  <span class="c1">#  se itera sobre los puntos del dataset</span>
        <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">mejora</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
        <span class="n">history_w0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="n">history_w1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
        <span class="n">history_f</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valores encontrados</span><span class="se">\n\n</span><span class="s2">  w0 = </span><span class="si">{:f}</span><span class="se">\n</span><span class="s2">  w1 = </span><span class="si">{:f}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>

<span class="n">plot_contour</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 = 0.654250
  w1 = 1.642800


</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_22_1.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_23_0.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_23_0.png" />
</div>
</div>
</div>
<div class="section" id="Gradiente-descendente-estocástico-(SDG)">
<h2>Gradiente descendente estocástico (SDG)<a class="headerlink" href="#Gradiente-descendente-estocástico-(SDG)" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El algoritmo de gradiente descendente estocástico (SDG) es un algoritmo de aprendizaje online, en que el conjunto de patrones o ejemplos es mezclado aleatoriamente para que los datos nunca se tomen de forma cíclica durante el proceso de optimización.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Punto de inicio</span>
<span class="c1">#</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">history_w0</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">history_w1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">history_f</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
        <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">mejora</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
        <span class="n">history_w0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="n">history_w1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span>
        <span class="n">history_f</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">-</span> <span class="n">w0</span> <span class="o">-</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valores encontrados</span><span class="se">\n\n</span><span class="s2">  w0 = </span><span class="si">{:f}</span><span class="se">\n</span><span class="s2">  w1 = </span><span class="si">{:f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">))</span>

<span class="n">plot_contour</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_w0</span><span class="p">,</span> <span class="n">history_w1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Valores encontrados

  w0 = 0.657837
  w1 = 1.661835
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_26_1.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_26_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history_f</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_27_0.png" src="../../../_images/notebooks_sklearn_fundamentals_2-05-apren-batch-online-SGD_27_0.png" />
</div>
</div>
</div>
<div class="section" id="Minibatch">
<h2>Minibatch<a class="headerlink" href="#Minibatch" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para conjuntos de datos muy grandes el aprendizaje batch es muy costoso computacionalmnete ya que deben recorrerse todos los datos, mientras que el aprendizaje online es muy lento en converger (compare los gráficos de los ejemplos anteriores). Es en este caso, donde se toma un punto intermedio:</p>
<ul class="simple">
<li><p>El conjunto de datos se divide en varios subconjuntos.</p></li>
<li><p>Se selecciona aleatoriamente un subconjunto y se computa el gradiente neto (tal como en el caso del aprendizaje batch).</p></li>
<li><p>Se realiza la corrección de los parámetros del modelo y se selecciona otro subconjunto que no haya sido seleccionado antes (tal como en el caso del SDG).</p></li>
</ul>
<p><strong>Ejercicio.—</strong> Implemente y ejecute el algoritmo nimibatch usando lotes de 5 ejemplos.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>