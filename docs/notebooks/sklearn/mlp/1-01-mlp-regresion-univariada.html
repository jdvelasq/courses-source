

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Regresión no lineal univariada con perceptrones multicapa &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Opcional — Regresión no lineal univariada con perceptrones multicapa en R" href="1-02-mlp-regresion-univariada-R.html" />
    <link rel="prev" title="Opcional — Ensambles de modelos en el Lenguaje R" href="../ensembles/1-03-ensambles-de-modelos-R.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Regresión no lineal univariada con perceptrones multicapa</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/mlp/1-01-mlp-regresion-univariada.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Regresión-no-lineal-univariada-con-perceptrones-multicapa">
<h1>Regresión no lineal univariada con perceptrones multicapa<a class="headerlink" href="#Regresión-no-lineal-univariada-con-perceptrones-multicapa" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>60 min</em> | Ultima modificación: Julio 3, 2019</p></li>
</ul>
<div class="section" id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Se desea construir un modelo de regresión no lineal para la siguiente muestra de 31 observaciones de <span class="math notranslate nohighlight">\((x, y)\)</span> con el fin de poder interpolar el valor de la variable de respuesta para valores de <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.5000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2941</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0882</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8824</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6765</span><span class="p">,</span>
     <span class="o">-</span><span class="mf">2.4706</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2647</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0588</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8529</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6471</span><span class="p">,</span>
     <span class="o">-</span><span class="mf">1.4412</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2353</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0294</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8235</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6176</span><span class="p">,</span>
     <span class="o">-</span><span class="mf">0.4118</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2059</span><span class="p">,</span>  <span class="mf">0.0000</span><span class="p">,</span>  <span class="mf">0.2059</span><span class="p">,</span>  <span class="mf">0.4118</span><span class="p">,</span>
      <span class="mf">0.6176</span><span class="p">,</span>  <span class="mf">0.8235</span><span class="p">,</span>  <span class="mf">1.0294</span><span class="p">,</span>  <span class="mf">1.2353</span><span class="p">,</span>  <span class="mf">1.4412</span><span class="p">,</span>
      <span class="mf">1.6471</span><span class="p">,</span>  <span class="mf">1.8529</span><span class="p">,</span>  <span class="mf">2.0588</span><span class="p">,</span>  <span class="mf">2.2647</span><span class="p">,</span>  <span class="mf">2.4706</span><span class="p">,</span>
      <span class="mf">2.6765</span><span class="p">,</span>  <span class="mf">2.8824</span><span class="p">,</span>  <span class="mf">3.0882</span><span class="p">,</span>  <span class="mf">3.2941</span><span class="p">,</span>  <span class="mf">3.5000</span><span class="p">]</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">0.0000</span><span class="p">,</span>  <span class="mf">0.0000</span><span class="p">,</span>  <span class="mf">0.0001</span><span class="p">,</span>  <span class="mf">0.0002</span><span class="p">,</span>  <span class="mf">0.0008</span><span class="p">,</span>
      <span class="mf">0.0022</span><span class="p">,</span>  <span class="mf">0.0059</span><span class="p">,</span>  <span class="mf">0.0144</span><span class="p">,</span>  <span class="mf">0.0323</span><span class="p">,</span>  <span class="mf">0.0664</span><span class="p">,</span>
      <span class="mf">0.1253</span><span class="p">,</span>  <span class="mf">0.2174</span><span class="p">,</span>  <span class="mf">0.3466</span><span class="p">,</span>  <span class="mf">0.5075</span><span class="p">,</span>  <span class="mf">0.6828</span><span class="p">,</span>
      <span class="mf">0.8440</span><span class="p">,</span>  <span class="mf">0.9585</span><span class="p">,</span>  <span class="mf">1.0000</span><span class="p">,</span>  <span class="mf">0.9585</span><span class="p">,</span>  <span class="mf">0.8440</span><span class="p">,</span>
      <span class="mf">0.6828</span><span class="p">,</span>  <span class="mf">0.5075</span><span class="p">,</span>  <span class="mf">0.3466</span><span class="p">,</span>  <span class="mf">0.2174</span><span class="p">,</span>  <span class="mf">0.1253</span><span class="p">,</span>
      <span class="mf">0.0664</span><span class="p">,</span>  <span class="mf">0.0323</span><span class="p">,</span>  <span class="mf">0.0144</span><span class="p">,</span>  <span class="mf">0.0059</span><span class="p">,</span>  <span class="mf">0.0022</span><span class="p">,</span>
      <span class="mf">0.0008</span><span class="p">,</span>  <span class="mf">0.0002</span><span class="p">,</span>  <span class="mf">0.0001</span><span class="p">,</span>  <span class="mf">0.0000</span><span class="p">,</span>  <span class="mf">0.0000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>La siguiente figura muestra que la relación es no lineal entre las variables de entrada (<span class="math notranslate nohighlight">\(x\)</span>) y salida (<span class="math notranslate nohighlight">\(y\)</span>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-01-mlp-regresion-univariada_6_0.png" src="../../../_images/notebooks_sklearn_mlp_1-01-mlp-regresion-univariada_6_0.png" />
</div>
</div>
</div>
<div class="section" id="Solución">
<h2>Solución<a class="headerlink" href="#Solución" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Arquitectura-del-modelo">
<h3>Arquitectura del modelo<a class="headerlink" href="#Arquitectura-del-modelo" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El perceptrón multicapa se obtiene al agrupar varios perceptrones continuos en capas para luego conectar las capas entre sí, una a continuación de la siguiente. Las neuronas de cada capa se conectan a todas y cada una de las neuronas de la siguiente capa. Un esquema ilustrativo es presentado a continuación.</p>
<p><img alt="MulticapaMLParq" src="../../../_images/MulticapaMLP.png" /></p>
<p>Se consideran tres tipos de capas por su ubicación (véase la figura de abajo):</p>
<ul class="simple">
<li><p>Capa de entrada: son nodos que simplemente capturan la información de entrada y la transmiten directamente a la siguiente capa sin realizar ningún tipo de procesamiento. Hay tantas neuronas de entrada como variables considere el modelo. Corresponden a la capa con las entradas <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> de la figura de abajo.</p></li>
<li><p>Capas ocultas de procesamiento: son capas internas usualmente no visibles por el usuario que realizan el procesamiento de la información. En la figura de abajo, hay una sola capa oculta con cuatro neuronas.</p></li>
<li><p>Capa de salida: Entrega la señal de salida al usuario. Tiene tantas neuronas como variables de salida tenga el sistema. En la figura de abajo, corresponde a la neurona de la derecha que da como salida la variable <span class="math notranslate nohighlight">\(z\)</span>.</p></li>
</ul>
<p>Tal como se indicó, en la figura de abajo se presenta el diagrama esquemático para un modelo con dos entradas <span class="math notranslate nohighlight">\((x, y)\)</span>, una capa oculta con cuatro neuronas, y una capa de salida.</p>
</div>
<div class="section" id="Capacidad-de-aprendizaje">
<h3>Capacidad de aprendizaje<a class="headerlink" href="#Capacidad-de-aprendizaje" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un perceptrón multicapa puede aproximar cualquier función arbitraria simplemente agregando neuronas a la capa oculta. En la siguiente figura, se muestran las superficies generadas para por cada una de las cuatro neuronas de la capa oculta (las cuatro superficies en forma de S), y como al combinarse en la capa de salida producen la figura de la derecha (que corresponde a la variable <span class="math notranslate nohighlight">\(z\)</span>).</p>
<p><img alt="MulticapaRegresionUniv-01" src="../../../_images/MulticapaRegresionUniv-01.png" /></p>
<p>Una pregunta fundamental en redes neuronales es la determinación de cuántas capas ocultas y cuántas neuronas por capa oculta deben usarse. En la figura de abajo se presentan las fronteras de decisión para diferentes configuraciones de una red neuronal para resolver un problema de clasificación.</p>
<ul class="simple">
<li><p>Un perceptrón simple puede generar una frontera de decisión lineal (figura de la izquierda).</p></li>
<li><p>Un perceptrón multicapa puede generar una superficie compacta donde la región sombreada representa una clase y el resto de la superficie representa la otra (figura del centro). Cada uno de los bordes del polígono es generado como la frontera de decisión que produce cada perceptrón de la capa oculta. La neurona de salida implementa la función lógica AND o la función lógica OR. Si cada perceptrón de la capa oculta indica la pertenencia de un punto cualquiera a la región sombreda, entonces la
neurona de salida representa un AND (todos los perceptrones de la capa oculta deben indicar que el punto pertenece a la región sombreada). De forma análoga, si los perceptrones de la capa oculta indican la no pertenencia a la región sombreada, entonces, la neurona de salida debe representar un OR. Esto implica (de forma intuitiva) que un perceptrón con una capa oculta puede aproximar cualquier función continua definida en un dominio compacto</p></li>
<li><p>Finalmente, una red con dos capas ocultas puede resolver problemas de clasificación donde los elementos de la clase de interés están aglomerados en distintas regiones (ya no hay un dominio compacto). Si se tiene en cuenta que cada región compacta puede ser generada por u perceptrón con una capa oculta, entonces se requieren dos percptrones los cuales son unidos mediante una capa adicional (al final) que representa un OR lógico.</p></li>
</ul>
<p><img alt="MulticapaRegresionUniv-02" src="../../../_images/MulticapaRegresionUniv-02.png" /></p>
</div>
<div class="section" id="Estimación-de-los-pesos-óptimos-de-la-red-neuronal">
<h3>Estimación de los pesos óptimos de la red neuronal<a class="headerlink" href="#Estimación-de-los-pesos-óptimos-de-la-red-neuronal" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La estimación de los parámetros óptimos se realiza mediante el método del descenso acelerado, usualmente minimizando el error cuadrático medio, tal como ya se ha realizado en muchos de los casos anteriores:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}(k+1) = \mathbf{w}(k) - \mu \frac{\partial}{\partial\mathbf{w}(k)} \left[ e^2(k)\right]\]</div>
<p>La dificultad subyace en la estimación del gradiente algebráico de los pesos de las conexiones respecto al error. La derivación del gradiente está fuera del alcance de este documento y se invita al lector a consultar libros especializados sobre el tema.</p>
</div>
<div class="section" id="Solución-numérica">
<h3>Solución numérica<a class="headerlink" href="#Solución-numérica" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Note que los parámetros que recibe la función <code class="docutils literal notranslate"><span class="pre">MLPRegressor</span></code> son similares a los recibidos por otras funciones ya usadas en otros tutoriales.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">##</span>
<span class="c1">## El parámetro hidden_layer_sizes recibe una tupla que</span>
<span class="c1">## indica la cantidad de neuronas de cada capa oculta. En</span>
<span class="c1">## el caso presentado, el valor (6,) indica que hay una sola</span>
<span class="c1">## capa oculta con 6 neuronas que usan la función sigmoidea.</span>
<span class="c1">## El parámetro solver = &#39;sgd&#39; indica que se usará el</span>
<span class="c1">## algoritmo de gradiente descendente estocástico para entrenar</span>
<span class="c1">## la red neuronal.</span>
<span class="c1">##</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span>
    <span class="n">hidden_layer_sizes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span>  <span class="c1"># Una capa oculta con una neurona</span>
    <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;logistic&#39;</span><span class="p">,</span>    <span class="c1">#  {‘identity’, ‘logistic’, ‘tanh’, ‘relu’}</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;sgd&#39;</span><span class="p">,</span>             <span class="c1">#  {‘lbfgs’, ‘sgd’, ‘adam’}</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>                <span class="c1">#</span>
    <span class="n">learning_rate_init</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>   <span class="c1"># Valor de la tasa de aprendizaje</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="c1"># La tasa no se adapta automáticamente</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>            <span class="c1"># Reporte del proceso de optimización</span>
    <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>             <span class="c1">#</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>                 <span class="c1">#</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">25000</span><span class="p">,</span>           <span class="c1"># Número máximo de iteraciones</span>
    <span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>             <span class="c1">#</span>
    <span class="n">nesterovs_momentum</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1">#</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>            <span class="c1"># Scikit espera una lista de listas</span>
<span class="n">m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>                     <span class="c1"># Entrena el modelo</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-01-mlp-regresion-univariada_28_0.png" src="../../../_images/notebooks_sklearn_mlp_1-01-mlp-regresion-univariada_28_0.png" />
</div>
</div>
<p><strong>Ejercicio.—</strong> ¿Qué resultados se obtienen cuando se usa <span class="math notranslate nohighlight">\(H\)</span> = 1, …, 5?</p>
<p><strong>Ejercicio.—</strong> Determine el número óptimo de neuronas en la capa oculta usando crossvalidation.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>