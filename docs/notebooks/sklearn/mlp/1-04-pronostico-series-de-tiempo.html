

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pronóstico de una serie de tiempo &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Taller — Clasificación del dataset artificial two-groups-four-clusters" href="1-05-taller.html" />
    <link rel="prev" title="Predicción de la resistencia del concreto" href="1-03-pronostico-de-la-resistencia-del-concreto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Pronóstico de una serie de tiempo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/mlp/1-04-pronostico-series-de-tiempo.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Pronóstico-de-una-serie-de-tiempo">
<h1>Pronóstico de una serie de tiempo<a class="headerlink" href="#Pronóstico-de-una-serie-de-tiempo" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>30 min</em> | Última modificación: Marzo 27, 2020.</p></li>
</ul>
<div class="section" id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La siguiente serie registra el número total de personas empleadas mensualmente como mano de obra en el condado de Sutter (California) entre 1946:1 y 1966:12. Tiene un total de 252 observaciones. Se desea contruir un modelo de pronóstico usando redes neuronales artificiales. Se deben usar los primeros 228 (de 1946:1 a 1964:12) datos para especificar el modelo y los 24 datos restantes (1965:1 a 1966:12) para evaluar el pronóstico un mes adelante por fuera de la muestra de calibración de los
parámetros.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
      <span class="mi">890</span><span class="p">,</span>  <span class="mi">992</span><span class="p">,</span>  <span class="mi">979</span><span class="p">,</span>  <span class="mi">959</span><span class="p">,</span> <span class="mi">1110</span><span class="p">,</span> <span class="mi">1546</span><span class="p">,</span> <span class="mi">1539</span><span class="p">,</span> <span class="mi">3401</span><span class="p">,</span> <span class="mi">2092</span><span class="p">,</span> <span class="mi">1436</span><span class="p">,</span> <span class="mi">1301</span><span class="p">,</span> <span class="mi">1287</span><span class="p">,</span>
     <span class="mi">1488</span><span class="p">,</span> <span class="mi">1517</span><span class="p">,</span> <span class="mi">1707</span><span class="p">,</span> <span class="mi">1729</span><span class="p">,</span> <span class="mi">1788</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2203</span><span class="p">,</span> <span class="mi">3713</span><span class="p">,</span> <span class="mi">2946</span><span class="p">,</span> <span class="mi">2082</span><span class="p">,</span> <span class="mi">2033</span><span class="p">,</span> <span class="mi">1937</span><span class="p">,</span>
     <span class="mi">1711</span><span class="p">,</span> <span class="mi">1775</span><span class="p">,</span> <span class="mi">1902</span><span class="p">,</span> <span class="mi">1846</span><span class="p">,</span> <span class="mi">2083</span><span class="p">,</span> <span class="mi">2262</span><span class="p">,</span> <span class="mi">2193</span><span class="p">,</span> <span class="mi">3792</span><span class="p">,</span> <span class="mi">2343</span><span class="p">,</span> <span class="mi">2313</span><span class="p">,</span> <span class="mi">2179</span><span class="p">,</span> <span class="mi">1975</span><span class="p">,</span>
     <span class="mi">1880</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2060</span><span class="p">,</span> <span class="mi">1843</span><span class="p">,</span> <span class="mi">2052</span><span class="p">,</span> <span class="mi">2039</span><span class="p">,</span> <span class="mi">2351</span><span class="p">,</span> <span class="mi">3394</span><span class="p">,</span> <span class="mi">3581</span><span class="p">,</span> <span class="mi">2489</span><span class="p">,</span> <span class="mi">2468</span><span class="p">,</span> <span class="mi">2134</span><span class="p">,</span>
     <span class="mi">1903</span><span class="p">,</span> <span class="mi">1719</span><span class="p">,</span> <span class="mi">1617</span><span class="p">,</span> <span class="mi">1818</span><span class="p">,</span> <span class="mi">2067</span><span class="p">,</span> <span class="mi">2457</span><span class="p">,</span> <span class="mi">2600</span><span class="p">,</span> <span class="mi">3530</span><span class="p">,</span> <span class="mi">2693</span><span class="p">,</span> <span class="mi">2448</span><span class="p">,</span> <span class="mi">2250</span><span class="p">,</span> <span class="mi">1972</span><span class="p">,</span>
     <span class="mi">1682</span><span class="p">,</span> <span class="mi">1730</span><span class="p">,</span> <span class="mi">1814</span><span class="p">,</span> <span class="mi">1900</span><span class="p">,</span> <span class="mi">2051</span><span class="p">,</span> <span class="mi">2290</span><span class="p">,</span> <span class="mi">2599</span><span class="p">,</span> <span class="mi">3428</span><span class="p">,</span> <span class="mi">2262</span><span class="p">,</span> <span class="mi">2242</span><span class="p">,</span> <span class="mi">2103</span><span class="p">,</span> <span class="mi">1825</span><span class="p">,</span>
     <span class="mi">1670</span><span class="p">,</span> <span class="mi">1681</span><span class="p">,</span> <span class="mi">1713</span><span class="p">,</span> <span class="mi">1954</span><span class="p">,</span> <span class="mi">1876</span><span class="p">,</span> <span class="mi">2272</span><span class="p">,</span> <span class="mi">2612</span><span class="p">,</span> <span class="mi">3590</span><span class="p">,</span> <span class="mi">2496</span><span class="p">,</span> <span class="mi">2441</span><span class="p">,</span> <span class="mi">2340</span><span class="p">,</span> <span class="mi">2090</span><span class="p">,</span>
     <span class="mi">1812</span><span class="p">,</span> <span class="mi">1788</span><span class="p">,</span> <span class="mi">1837</span><span class="p">,</span> <span class="mi">1993</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2199</span><span class="p">,</span> <span class="mi">2622</span><span class="p">,</span> <span class="mi">3787</span><span class="p">,</span> <span class="mi">2914</span><span class="p">,</span> <span class="mi">2487</span><span class="p">,</span> <span class="mi">2314</span><span class="p">,</span> <span class="mi">2139</span><span class="p">,</span>
     <span class="mi">2124</span><span class="p">,</span> <span class="mi">2214</span><span class="p">,</span> <span class="mi">2234</span><span class="p">,</span> <span class="mi">2279</span><span class="p">,</span> <span class="mi">2423</span><span class="p">,</span> <span class="mi">2290</span><span class="p">,</span> <span class="mi">2903</span><span class="p">,</span> <span class="mi">4485</span><span class="p">,</span> <span class="mi">3085</span><span class="p">,</span> <span class="mi">2852</span><span class="p">,</span> <span class="mi">2629</span><span class="p">,</span> <span class="mi">2435</span><span class="p">,</span>
     <span class="mi">2227</span><span class="p">,</span> <span class="mi">1944</span><span class="p">,</span> <span class="mi">2125</span><span class="p">,</span> <span class="mi">2260</span><span class="p">,</span> <span class="mi">2299</span><span class="p">,</span> <span class="mi">2323</span><span class="p">,</span> <span class="mi">2659</span><span class="p">,</span> <span class="mi">3761</span><span class="p">,</span> <span class="mi">2779</span><span class="p">,</span> <span class="mi">2761</span><span class="p">,</span> <span class="mi">2446</span><span class="p">,</span> <span class="mi">2278</span><span class="p">,</span>
     <span class="mi">1879</span><span class="p">,</span> <span class="mi">1881</span><span class="p">,</span> <span class="mi">2165</span><span class="p">,</span> <span class="mi">2199</span><span class="p">,</span> <span class="mi">2308</span><span class="p">,</span> <span class="mi">2529</span><span class="p">,</span> <span class="mi">2573</span><span class="p">,</span> <span class="mi">3946</span><span class="p">,</span> <span class="mi">3200</span><span class="p">,</span> <span class="mi">2574</span><span class="p">,</span> <span class="mi">2422</span><span class="p">,</span> <span class="mi">2446</span><span class="p">,</span>
     <span class="mi">2828</span><span class="p">,</span> <span class="mi">2879</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">2835</span><span class="p">,</span> <span class="mi">2585</span><span class="p">,</span> <span class="mi">2787</span><span class="p">,</span> <span class="mi">3334</span><span class="p">,</span> <span class="mi">4746</span><span class="p">,</span> <span class="mi">3613</span><span class="p">,</span> <span class="mi">3463</span><span class="p">,</span> <span class="mi">3274</span><span class="p">,</span> <span class="mi">2801</span><span class="p">,</span>
     <span class="mi">2488</span><span class="p">,</span> <span class="mi">2386</span><span class="p">,</span> <span class="mi">2428</span><span class="p">,</span> <span class="mi">2678</span><span class="p">,</span> <span class="mi">2744</span><span class="p">,</span> <span class="mi">2772</span><span class="p">,</span> <span class="mi">3520</span><span class="p">,</span> <span class="mi">3833</span><span class="p">,</span> <span class="mi">3377</span><span class="p">,</span> <span class="mi">3013</span><span class="p">,</span> <span class="mi">2871</span><span class="p">,</span> <span class="mi">2592</span><span class="p">,</span>
     <span class="mi">2375</span><span class="p">,</span> <span class="mi">2304</span><span class="p">,</span> <span class="mi">2464</span><span class="p">,</span> <span class="mi">2557</span><span class="p">,</span> <span class="mi">2739</span><span class="p">,</span> <span class="mi">2714</span><span class="p">,</span> <span class="mi">3102</span><span class="p">,</span> <span class="mi">3961</span><span class="p">,</span> <span class="mi">3772</span><span class="p">,</span> <span class="mi">3245</span><span class="p">,</span> <span class="mi">3104</span><span class="p">,</span> <span class="mi">2869</span><span class="p">,</span>
     <span class="mi">2513</span><span class="p">,</span> <span class="mi">2385</span><span class="p">,</span> <span class="mi">2756</span><span class="p">,</span> <span class="mi">2927</span><span class="p">,</span> <span class="mi">2940</span><span class="p">,</span> <span class="mi">3180</span><span class="p">,</span> <span class="mi">3791</span><span class="p">,</span> <span class="mi">4093</span><span class="p">,</span> <span class="mi">4309</span><span class="p">,</span> <span class="mi">3532</span><span class="p">,</span> <span class="mi">3408</span><span class="p">,</span> <span class="mi">2839</span><span class="p">,</span>
     <span class="mi">2792</span><span class="p">,</span> <span class="mi">2798</span><span class="p">,</span> <span class="mi">3007</span><span class="p">,</span> <span class="mi">3086</span><span class="p">,</span> <span class="mi">3201</span><span class="p">,</span> <span class="mi">3428</span><span class="p">,</span> <span class="mi">3754</span><span class="p">,</span> <span class="mi">4917</span><span class="p">,</span> <span class="mi">3760</span><span class="p">,</span> <span class="mi">3609</span><span class="p">,</span> <span class="mi">3471</span><span class="p">,</span> <span class="mi">3347</span><span class="p">,</span>
     <span class="mi">3333</span><span class="p">,</span> <span class="mi">3456</span><span class="p">,</span> <span class="mi">3569</span><span class="p">,</span> <span class="mi">3900</span><span class="p">,</span> <span class="mi">3909</span><span class="p">,</span> <span class="mi">4098</span><span class="p">,</span> <span class="mi">4826</span><span class="p">,</span> <span class="mi">5770</span><span class="p">,</span> <span class="mi">5108</span><span class="p">,</span> <span class="mi">4360</span><span class="p">,</span> <span class="mi">4100</span><span class="p">,</span> <span class="mi">3562</span><span class="p">,</span>
     <span class="mi">3284</span><span class="p">,</span> <span class="mi">3278</span><span class="p">,</span> <span class="mi">3424</span><span class="p">,</span> <span class="mi">3843</span><span class="p">,</span> <span class="mi">3614</span><span class="p">,</span> <span class="mi">3536</span><span class="p">,</span> <span class="mi">4505</span><span class="p">,</span> <span class="mi">5456</span><span class="p">,</span> <span class="mi">4881</span><span class="p">,</span> <span class="mi">4041</span><span class="p">,</span> <span class="mi">3724</span><span class="p">,</span> <span class="mi">3525</span><span class="p">,</span>
     <span class="mi">3437</span><span class="p">,</span> <span class="mi">3324</span><span class="p">,</span> <span class="mi">3977</span><span class="p">,</span> <span class="mi">4025</span><span class="p">,</span> <span class="mi">4016</span><span class="p">,</span> <span class="mi">4031</span><span class="p">,</span> <span class="mi">4489</span><span class="p">,</span> <span class="mi">5563</span><span class="p">,</span> <span class="mi">5709</span><span class="p">,</span> <span class="mi">4620</span><span class="p">,</span> <span class="mi">4160</span><span class="p">,</span> <span class="mi">4012</span><span class="p">,</span>
     <span class="mi">3987</span><span class="p">,</span> <span class="mi">4155</span><span class="p">,</span> <span class="mi">4054</span><span class="p">,</span> <span class="mi">4485</span><span class="p">,</span> <span class="mi">4558</span><span class="p">,</span> <span class="mi">4462</span><span class="p">,</span> <span class="mi">4594</span><span class="p">,</span> <span class="mi">6481</span><span class="p">,</span> <span class="mi">6345</span><span class="p">,</span> <span class="mi">5142</span><span class="p">,</span> <span class="mi">4824</span><span class="p">,</span> <span class="mi">4573</span><span class="p">,</span>
     <span class="mi">4158</span><span class="p">,</span> <span class="mi">4140</span><span class="p">,</span> <span class="mi">4251</span><span class="p">,</span> <span class="mi">4734</span><span class="p">,</span> <span class="mi">4858</span><span class="p">,</span> <span class="mi">4798</span><span class="p">,</span> <span class="mi">5080</span><span class="p">,</span> <span class="mi">6905</span><span class="p">,</span> <span class="mi">5504</span><span class="p">,</span> <span class="mi">5457</span><span class="p">,</span> <span class="mi">5198</span><span class="p">,</span> <span class="mi">4890</span> <span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># linea vertical para dividir el entrenamiento</span>
<span class="c1"># del pronóstico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_4_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_4_0.png" />
</div>
</div>
</div>
<div class="section" id=" Solución">
<h2> Solución<a class="headerlink" href="# Solución" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Análisis-exploratorio">
<h3>Análisis exploratorio<a class="headerlink" href="#Análisis-exploratorio" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La inspección visual revela que la serie tiene un componente cíclico con un año de periodo, lo cual se explica porque la contratación de mano de obra es estacionaria (por periodos en el año); la serie presenta también una tendencia creciente en el largo plazo, cuya pendiente cambia aproximadamente sobre la mitad derecha de la gráfica.</p>
<p>La función de autocorrelación (ACF) simple, definida como:</p>
<div class="math notranslate nohighlight">
\[\text{acf}(k) = \frac{1}{T-k} \sum (z_{t+k} - \bar{z})(z_t - \bar{z})\]</div>
<p>donde:</p>
<div class="math notranslate nohighlight">
\[\bar{z} = \frac{1}{T} \sum_t z_t\]</div>
<p>presenta el siguiente comportamiento:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span><span class="p">,</span> <span class="n">pacf</span>

<span class="k">def</span> <span class="nf">acf_plot</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="n">acf_data</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">fft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acf_data</span><span class="p">)),</span> <span class="n">acf_data</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>

<span class="k">def</span> <span class="nf">pacf_plot</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="n">pacf_data</span> <span class="o">=</span> <span class="n">pacf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pacf_data</span><span class="p">)),</span> <span class="n">pacf_data</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>

<span class="n">acf_plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_13_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_13_0.png" />
</div>
</div>
<p>que se interpreta de la siguiente manera:</p>
<ul class="simple">
<li><p>El comportamiento cíclico corresponde a la componente periodica dentro del año, y tiene un periodo de 12 meses.</p></li>
<li><p>La tendencia decreciente que muere en el largo plazo representa la tendencia de largo plazo.</p></li>
</ul>
<p>Existen dos tendencias para modelar la serie usando una red neuronal artificial:</p>
<ul class="simple">
<li><p>Usar directamente los datos de la serie y dejar que el modelo capture tanto la tendencia como el patrón cíclico.</p></li>
<li><p>Remover la tendencia y el ciclo, y la serie que queda es pronósticada usando el modelo de redes neuronales artificiales.</p></li>
</ul>
<p>En el pronóstico de series de tiempo, el valor actual de la serie <span class="math notranslate nohighlight">\(z_t\)</span> es función de sus valores pasados <span class="math notranslate nohighlight">\(z_{t-1}\)</span>, …, <span class="math notranslate nohighlight">\(z_{t-P}\)</span>; estos últimos son la entrada a la red neuronal.</p>
</div>
<div class="section" id="Modelo-1:-Pronostico-de-la-serie-sin-transformar">
<h3>Modelo 1: Pronostico de la serie sin transformar<a class="headerlink" href="#Modelo-1:-Pronostico-de-la-serie-sin-transformar" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En este caso se tomará a <span class="math notranslate nohighlight">\(P\)</span> = 13. En la práctica deberían tantearse diferentes valores de <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Como primer paso se escala la serie al intervalo [0, 1]</span>
<span class="c1"># ya que esto facilita el entrenamiento del modelo</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># crea el transformador</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="c1"># escala la serie</span>
<span class="n">data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1"># z es un array de listas como efecto</span>
<span class="c1"># del escalamiento</span>
<span class="n">data_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">data_scaled</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_19_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_19_0.png" />
</div>
</div>
<p>Ya que la implementación dispobible en <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> es para modelos de regresión, se debe armar una matrix donde las variables independientes son <span class="math notranslate nohighlight">\(z_{t-1}\)</span>, …, <span class="math notranslate nohighlight">\(z_{t-P}\)</span> y la variable dependiente es <span class="math notranslate nohighlight">\(z_t\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">P</span> <span class="o">=</span> <span class="mi">13</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">252</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data_scaled</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="p">])</span>

<span class="n">observed_scaled</span> <span class="o">=</span> <span class="n">data_scaled</span><span class="p">[</span><span class="n">P</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Numero total de patrones al convertir</span>
<span class="c1"># los datos a un modelo de regresión</span>
<span class="c1">#</span>
<span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
239
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Se escoge arbitrariamente</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span>
    <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">),</span>
    <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;logistic&#39;</span><span class="p">,</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">,</span>
    <span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">learning_rate_init</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Entrenamiento</span>
<span class="n">mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">215</span><span class="p">],</span>  <span class="c1"># 239 - 24 = 215</span>
    <span class="n">observed_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">215</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Pronostico</span>
<span class="n">y_scaled_m1</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># No hay pronóstico para los primeros 13 valores</span>
<span class="c1"># de la serie</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">y_scaled_m1</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="s1">&#39;-r&#39;</span><span class="p">);</span>

<span class="c1"># linea vertical para dividir el entrenamiento</span>
<span class="c1"># del pronóstico. Se ubica en el ultimo dato</span>
<span class="c1"># usando para entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_23_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_23_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se desescala para llevar los valores a la escala de los datos originales</span>
<span class="c1">#</span>
<span class="n">y_m1</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([[</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">y_scaled_m1</span><span class="p">])</span>
<span class="n">y_m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">y_m1</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">y_m1</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_24_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_24_0.png" />
</div>
</div>
<p><strong>Ejercicio.—</strong> Determine el número óptimo de neuronas en la capa oculta y la cantidad de rezagos <span class="math notranslate nohighlight">\(P\)</span>. Recuerde que los resultados son sensibles a los parámetros de la optimización y el punto de arranque.</p>
</div>
<div class="section" id="Modelo-2:-Pronóstico-de-la-serie-transformada">
<h3>Modelo 2: Pronóstico de la serie transformada<a class="headerlink" href="#Modelo-2:-Pronóstico-de-la-serie-transformada" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Este es el procedimiento común usado en Estadística Aplicada y Econometría. Acá se juzga el modelo por la precisión, no por el cumplimiento de criterios estadísticos.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Se remueve la tendencia</span>
<span class="n">data_d1</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))]</span>

<span class="c1"># En la gráfica queda la componente cíclica</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_d1</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_d1</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_d1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_d1</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_28_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_28_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Se remueve la componente cíclica</span>
<span class="c1"># restando z[t] - z[t-12]</span>
<span class="n">data_d1d12</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_d1</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_d1</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">12</span><span class="p">]</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1</span><span class="p">))]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_29_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_29_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">acf_plot</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_30_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_30_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pacf_plot</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_31_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_31_0.png" />
</div>
</div>
<p>A partir de la gráfica del PACF, se deduce que un valor apropiado para <span class="math notranslate nohighlight">\(P\)</span> podría ser 12.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se escalan los valores como en el caso anaterior</span>
<span class="c1">#</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">data_d1d12_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_d1d12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">data_d1d12_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">data_d1d12_scaled</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># Se verifica visualmente el escalamiento</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_33_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_33_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La longitud de la serie cambia</span>
<span class="c1">#</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
239
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se construye la matriz de regresores</span>
<span class="c1">#</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">13</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data_d1d12_scaled</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="p">)])</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">data_d1d12_scaled</span><span class="p">[</span><span class="n">P</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Numero total de patrones al convertir</span>
<span class="c1"># los datos a un modelo de regresión</span>
<span class="c1">#</span>
<span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
226
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
226
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">H</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># Se escoge arbitrariamente</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span>
    <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">),</span>
    <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;logistic&#39;</span><span class="p">,</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">,</span>
    <span class="n">momentum</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">learning_rate_init</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Entrenamiento</span>
<span class="n">mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">202</span><span class="p">],</span>  <span class="c1"># 226 - 24 = 202</span>
    <span class="n">data_d1d12_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">202</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Pronostico</span>
<span class="n">y_d1d12_scaled_m2</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># No hay pronóstico para los primeros 13 valores</span>
<span class="c1"># de la serie</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">y_d1d12_scaled_m2</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="s1">&#39;-r&#39;</span><span class="p">);</span>

<span class="c1"># linea vertical para dividir el entrenamiento</span>
<span class="c1"># del pronóstico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_38_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_38_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_d1d12_scaled_m2</span><span class="p">),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_d1d12_scaled</span><span class="p">)</span><span class="o">-</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
226 , 226
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># La gráfica anterior no es comparativa. Se realizan las</span>
<span class="c1"># transformaciones inversas a las realizadas</span>
<span class="c1">#</span>
<span class="n">y_d1d12_scaled_m2</span> <span class="o">=</span> <span class="n">data_d1d12_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">P</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_d1d12_scaled_m2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">y_d1d12_m2</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([[</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">y_d1d12_scaled_m2</span><span class="p">])</span>
<span class="n">y_d1d12_m2</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">y_d1d12_m2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

<span class="n">y_d1_m2</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_d1d12_m2</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">data_d1</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_d1d12_m2</span><span class="p">))]</span>
<span class="n">y_d1_m2</span> <span class="o">=</span> <span class="n">data_d1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_d1_m2</span>

<span class="n">y_m2</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_d1_m2</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_d1_m2</span><span class="p">))]</span>

<span class="n">y_m2</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">y_m2</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;.-k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_m2</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">);</span>

<span class="c1"># linea vertical para dividir el entrenamiento</span>
<span class="c1"># del pronóstico. Se ubica en el ultimo dato</span>
<span class="c1"># usando para entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_41_0.png" src="../../../_images/notebooks_sklearn_mlp_1-04-pronostico-series-de-tiempo_41_0.png" />
</div>
</div>
<p><strong>Ejercicio.—</strong> Determine el número óptimo de neuronas en la capa oculta y la cantidad de rezagos <span class="math notranslate nohighlight">\(P\)</span>. Recuerde que los resultados son sensibles a los parámetros de la optimización y el punto de arranque.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>