

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Identificación de créditos riesgosos &mdash; documentación de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="Taller — Clasificación del dataset artificial two-groups-four-clusters" href="1-04-taller.html" />
    <link rel="prev" title="Árboles de Clasificación" href="1-01-arboles-de-clasificacion.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Analítica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Analítica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/course-info.html">Información del curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/programming-labs.html">Laboratorios de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/complement.html">Material Complementario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Analítica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Identificación de créditos riesgosos</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/trees/1-03-identificacion-de-creditos-riesgosos.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Identificación-de-créditos-riesgosos">
<h1>Identificación de créditos riesgosos<a class="headerlink" href="#Identificación-de-créditos-riesgosos" title="Enlazar permanentemente con este título">¶</a></h1>
<ul class="simple">
<li><p><em>60 min</em> | Ultima modificación: Junio 22, 2019</p></li>
</ul>
<p>En el tutorial anterior se discutieron los fundamentos del uso de árboles de clasificación. En este tutorial, se presenta la identificación de créditos potencialmente riesgosos en una identidad crediticia.</p>
<div class="section" id="Descripción-del-problema">
<h2>Descripción del problema<a class="headerlink" href="#Descripción-del-problema" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las entidades financieras desean mejorar sus procedimientos de aprobación de créditos con el fin de disminuir los riesgos de no pago de la deuda, lo que acarrea pérdidas a la entidad. El problema real consiste en poder decidir si se aprueba o no un crédito particular con base en información que puede ser fácilmente recolectada por teléfono o en la web.</p>
<p>Se tiene una muestra de 1000 observaciones. Cada registro contiene 20 atributos que recopilan información tanto sobre el crédito como sobre la salud financiera del solicitante. La información fue recolectada por una firma alemana y se puede descargar de <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data">https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data</a>).</p>
<p>Los atributos y sus valores son los siguientes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Attribute 1:  (qualitative)
         Status of existing checking account
         A11 :      ... &lt;    0 DM
         A12 : 0 &lt;= ... &lt;  200 DM
         A13 :      ... &gt;= 200 DM /
               salary assignments for at least 1 year
         A14 : no checking account

Attribute 2:  (numerical)
         Duration in month

Attribute 3:  (qualitative)
         Credit history
         A30 : no credits taken/
               all credits paid back duly
         A31 : all credits at this bank paid back duly
         A32 : existing credits paid back duly till now
         A33 : delay in paying off in the past
         A34 : critical account/
               other credits existing (not at this bank)

Attribute 4:  (qualitative)
         Purpose
         A40 : car (new)
         A41 : car (used)
         A42 : furniture/equipment
         A43 : radio/television
         A44 : domestic appliances
         A45 : repairs
         A46 : education
         A47 : (vacation - does not exist?)
         A48 : retraining
         A49 : business
         A410 : others

Attribute 5:  (numerical)
         Credit amount

Attribute 6:  (qualitative)
         Savings account/bonds
         A61 :          ... &lt;  100 DM
         A62 :   100 &lt;= ... &lt;  500 DM
         A63 :   500 &lt;= ... &lt; 1000 DM
         A64 :          .. &gt;= 1000 DM
         A65 :   unknown/ no savings account

Attribute 7:  (qualitative)
         Present employment since
         A71 : unemployed
         A72 :       ... &lt; 1 year
         A73 : 1  &lt;= ... &lt; 4 years
         A74 : 4  &lt;= ... &lt; 7 years
         A75 :       .. &gt;= 7 years

Attribute 8:  (numerical)
         Installment rate in percentage of disposable income

Attribute 9:  (qualitative)
         Personal status and sex
         A91 : male   : divorced/separated
         A92 : female : divorced/separated/married
         A93 : male   : single
         A94 : male   : married/widowed
         A95 : female : single

Attribute 10: (qualitative)
         Other debtors / guarantors
         A101 : none
         A102 : co-applicant
         A103 : guarantor

Attribute 11: (numerical)
         Present residence since

Attribute 12: (qualitative)
         Property
         A121 : real estate
         A122 : if not A121 : building society savings agreement/
                  life insurance
         A123 : if not A121/A122 : car or other, not in attribute 6
         A124 : unknown / no property

Attribute 13: (numerical)
         Age in years

Attribute 14: (qualitative)
         Other installment plans
         A141 : bank
         A142 : stores
         A143 : none

Attribute 15: (qualitative)
         Housing
         A151 : rent
         A152 : own
         A153 : for free

Attribute 16: (numerical)
         Number of existing credits at this bank

Attribute 17: (qualitative)
         Job
         A171 : unemployed/ unskilled  - non-resident
         A172 : unskilled - resident
         A173 : skilled employee / official
         A174 : management/ self-employed/
                highly qualified employee/ officer

Attribute 18: (numerical)
         Number of people being liable to provide maintenance for

Attribute 19: (qualitative)
         Telephone
         A191 : none
         A192 : yes, registered under the customers name

Attribute 20: (qualitative)
         foreign worker
         A201 : yes
         A202 : no
</pre></div>
</div>
</div>
<div class="section" id="Preparación">
<h2>Preparación<a class="headerlink" href="#Preparación" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
</pre></div>
</div>
</div>
</div>
<div class="section" id="Carga-de-datos">
<h2>Carga de datos<a class="headerlink" href="#Carga-de-datos" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Lee el archivo.</span>
<span class="c1">##</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/credit.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span>           <span class="c1"># separador de campos</span>
    <span class="n">thousands</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1"># separador de miles para números</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>       <span class="c1"># separador de los decimales para números</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>  <span class="c1"># idioma</span>

<span class="c1">##</span>
<span class="c1">## Verifica la lectura de los datos</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 21 columns):
checking_balance        1000 non-null object
months_loan_duration    1000 non-null int64
credit_history          1000 non-null object
purpose                 1000 non-null object
amount                  1000 non-null int64
savings_balance         1000 non-null object
employment_length       1000 non-null object
installment_rate        1000 non-null int64
personal_status         1000 non-null object
other_debtors           1000 non-null object
residence_history       1000 non-null int64
property                1000 non-null object
age                     1000 non-null int64
installment_plan        1000 non-null object
housing                 1000 non-null object
existing_credits        1000 non-null int64
default                 1000 non-null int64
dependents              1000 non-null int64
telephone               1000 non-null object
foreign_worker          1000 non-null object
job                     1000 non-null object
dtypes: int64(8), object(13)
memory usage: 164.1+ KB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Contenido del archivo</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>checking_balance</th>
      <th>months_loan_duration</th>
      <th>credit_history</th>
      <th>purpose</th>
      <th>amount</th>
      <th>savings_balance</th>
      <th>employment_length</th>
      <th>installment_rate</th>
      <th>personal_status</th>
      <th>other_debtors</th>
      <th>...</th>
      <th>property</th>
      <th>age</th>
      <th>installment_plan</th>
      <th>housing</th>
      <th>existing_credits</th>
      <th>default</th>
      <th>dependents</th>
      <th>telephone</th>
      <th>foreign_worker</th>
      <th>job</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt; 0 DM</td>
      <td>6</td>
      <td>critical</td>
      <td>radio/tv</td>
      <td>1169</td>
      <td>unknown</td>
      <td>&gt; 7 yrs</td>
      <td>4</td>
      <td>single male</td>
      <td>none</td>
      <td>...</td>
      <td>real estate</td>
      <td>67</td>
      <td>none</td>
      <td>own</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>yes</td>
      <td>yes</td>
      <td>skilled employee</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1 - 200 DM</td>
      <td>48</td>
      <td>repaid</td>
      <td>radio/tv</td>
      <td>5951</td>
      <td>&lt; 100 DM</td>
      <td>1 - 4 yrs</td>
      <td>2</td>
      <td>female</td>
      <td>none</td>
      <td>...</td>
      <td>real estate</td>
      <td>22</td>
      <td>none</td>
      <td>own</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>none</td>
      <td>yes</td>
      <td>skilled employee</td>
    </tr>
    <tr>
      <th>2</th>
      <td>unknown</td>
      <td>12</td>
      <td>critical</td>
      <td>education</td>
      <td>2096</td>
      <td>&lt; 100 DM</td>
      <td>4 - 7 yrs</td>
      <td>2</td>
      <td>single male</td>
      <td>none</td>
      <td>...</td>
      <td>real estate</td>
      <td>49</td>
      <td>none</td>
      <td>own</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>none</td>
      <td>yes</td>
      <td>unskilled resident</td>
    </tr>
    <tr>
      <th>3</th>
      <td>&lt; 0 DM</td>
      <td>42</td>
      <td>repaid</td>
      <td>furniture</td>
      <td>7882</td>
      <td>&lt; 100 DM</td>
      <td>4 - 7 yrs</td>
      <td>2</td>
      <td>single male</td>
      <td>guarantor</td>
      <td>...</td>
      <td>building society savings</td>
      <td>45</td>
      <td>none</td>
      <td>for free</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>none</td>
      <td>yes</td>
      <td>skilled employee</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&lt; 0 DM</td>
      <td>24</td>
      <td>delayed</td>
      <td>car (new)</td>
      <td>4870</td>
      <td>&lt; 100 DM</td>
      <td>1 - 4 yrs</td>
      <td>3</td>
      <td>single male</td>
      <td>none</td>
      <td>...</td>
      <td>unknown/none</td>
      <td>53</td>
      <td>none</td>
      <td>for free</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>none</td>
      <td>yes</td>
      <td>skilled employee</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se verifican los tipos de datos de las columnas</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
checking_balance        object
months_loan_duration     int64
credit_history          object
purpose                 object
amount                   int64
savings_balance         object
employment_length       object
installment_rate         int64
personal_status         object
other_debtors           object
residence_history        int64
property                object
age                      int64
installment_plan        object
housing                 object
existing_credits         int64
default                  int64
dependents               int64
telephone               object
foreign_worker          object
job                     object
dtype: object
</pre></div></div>
</div>
<div class="section" id="Análisis-Exploratorio">
<h3>Análisis Exploratorio<a class="headerlink" href="#Análisis-Exploratorio" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Algunas de las columnas son numéricas y</span>
<span class="c1">## las otras son factores.</span>
<span class="c1">## DM corresponde a Deutsche Marks</span>
<span class="c1">## se verifican algunos valores versus el code book.</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">checking_balance</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
unknown       394
&lt; 0 DM        274
1 - 200 DM    269
&gt; 200 DM       63
Name: checking_balance, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">savings_balance</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt; 100 DM         603
unknown          183
101 - 500 DM     103
501 - 1000 DM     63
&gt; 1000 DM         48
Name: savings_balance, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## El monto del préstamo va desde 250 DM hasta 18.424 DM</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
count     1000.000000
mean      3271.258000
std       2822.736876
min        250.000000
25%       1365.500000
50%       2319.500000
75%       3972.250000
max      18424.000000
Name: amount, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La duración del préstamo va desde 4 hasta 72 meses</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">months_loan_duration</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
count    1000.000000
mean       20.903000
std        12.058814
min         4.000000
25%        12.000000
50%        18.000000
75%        24.000000
max        72.000000
Name: months_loan_duration, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## La columna default indica si hubo problemas</span>
<span class="c1">## en el pago del préstamo (1- pago, 2- no pago)</span>
<span class="c1">## esta es la columna que se desea pronosticar</span>
<span class="c1">## 1-si, 2-no</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1    700
2    300
Name: default, dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Preprocesamiento">
<h3>Preprocesamiento<a class="headerlink" href="#Preprocesamiento" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1">##</span>
<span class="c1">## Se construye un codificador para transformar</span>
<span class="c1">## los strings a enteros (similar a factores en R)</span>
<span class="c1">##</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

<span class="c1">##</span>
<span class="c1">## Se aplica el codificador a las columnas</span>
<span class="c1">## del dataset</span>
<span class="c1">##</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;checking_balance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;checking_balance&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;credit_history&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;credit_history&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;purpose&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;purpose&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;savings_balance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;savings_balance&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;employment_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;employment_length&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;personal_status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;personal_status&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;other_debtors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;other_debtors&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;property&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;property&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;installment_plan&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;installment_plan&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;housing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;housing&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;telephone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;telephone&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;foreign_worker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;foreign_worker&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;job&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Entrenamiento-del-modelo">
<h3>Entrenamiento del modelo<a class="headerlink" href="#Entrenamiento-del-modelo" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Se usa el 90% de los datos para entrenamiento</span>
<span class="c1">## y el 10% restante para prueba</span>
<span class="c1">##</span>
<span class="n">train_sample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">900</span><span class="p">))</span>
<span class="n">test_sample</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1">##</span>
<span class="c1">## Genera los conjuntos de entrenamiento y prueba</span>
<span class="c1">##</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_sample</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_test</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_sample</span><span class="p">,:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">##</span>
<span class="c1">## Se elimina la columna default que</span>
<span class="c1">## corresponde a la variable de salida</span>
<span class="c1">##</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Se genera la variable dependiente</span>
<span class="c1">##</span>
<span class="n">y_train_true</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">default</span><span class="p">[</span><span class="n">train_sample</span><span class="p">]</span>
<span class="n">y_test_true</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">default</span><span class="p">[</span><span class="n">test_sample</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Construcción del arbol de clasificación</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="c1">##</span>
<span class="c1">## Se construye el arbol</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="c1">##</span>
<span class="c1">## Se entrena para los datos de prueba</span>
<span class="c1">##</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_true</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Se pronostica para la muestra de prueba</span>
<span class="c1">##</span>
<span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Métricas de desempeño</span>
<span class="c1">##</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[48, 20],
       [20, 12]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">y_test_true</span> <span class="o">-</span><span class="n">i</span> <span class="n">y_test_pred</span>
<span class="c1">##</span>
<span class="c1">## La función CrossTable del paquete gmodels</span>
<span class="c1">## entrega información más detallada.</span>
<span class="c1">## install.packages(&quot;gmodels&quot;)</span>
<span class="c1">##</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gmodels</span><span class="p">)</span>
<span class="nf">CrossTable</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">y_test_true</span><span class="p">,</span>
           <span class="n">y</span> <span class="o">=</span> <span class="n">y_test_pred</span><span class="p">,</span>
           <span class="n">prop.chisq</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


   Cell Contents
|-------------------------|
|                       N |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|


Total Observations in Table:  100


             | y_test_pred
 y_test_true |         1 |         2 | Row Total |
-------------|-----------|-----------|-----------|
           1 |        48 |        20 |        68 |
             |     0.706 |     0.294 |     0.680 |
             |     0.706 |     0.625 |           |
             |     0.480 |     0.200 |           |
-------------|-----------|-----------|-----------|
           2 |        20 |        12 |        32 |
             |     0.625 |     0.375 |     0.320 |
             |     0.294 |     0.375 |           |
             |     0.200 |     0.120 |           |
-------------|-----------|-----------|-----------|
Column Total |        68 |        32 |       100 |
             |     0.680 |     0.320 |           |
-------------|-----------|-----------|-----------|


</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Solución-usando-R">
<h2>Solución usando R<a class="headerlink" href="#Solución-usando-R" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">df</span>
<span class="nf">str</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;data.frame&#39;:   1000 obs. of  21 variables:
 $ checking_balance    : int  1 0 3 1 1 3 3 0 3 0 ...
 $ months_loan_duration: int  6 48 12 42 24 36 24 36 12 30 ...
 $ credit_history      : int  0 4 0 4 1 4 4 4 4 0 ...
 $ purpose             : int  7 7 4 5 1 4 5 2 7 1 ...
 $ amount              : int  1169 5951 2096 7882 4870 9055 2835 6948 3059 5234 ...
 $ savings_balance     : int  4 2 2 2 2 4 1 2 3 2 ...
 $ employment_length   : int  3 1 2 2 1 1 3 1 2 4 ...
 $ installment_rate    : int  4 2 2 2 3 2 3 2 2 4 ...
 $ personal_status     : int  3 1 3 3 3 3 3 3 0 2 ...
 $ other_debtors       : int  2 2 2 1 2 2 2 2 2 2 ...
 $ residence_history   : int  4 2 3 4 4 4 4 2 4 2 ...
 $ property            : int  2 2 2 0 3 3 0 1 2 1 ...
 $ age                 : int  67 22 49 45 53 35 53 35 61 28 ...
 $ installment_plan    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ housing             : int  1 1 1 0 0 0 1 2 1 1 ...
 $ existing_credits    : int  2 1 1 1 2 1 1 1 1 2 ...
 $ default             : int  1 2 1 1 2 1 1 1 1 2 ...
 $ dependents          : int  1 1 2 2 2 2 1 1 1 1 ...
 $ telephone           : int  1 0 0 0 0 1 0 1 0 0 ...
 $ foreign_worker      : int  1 1 1 1 1 1 1 1 1 1 ...
 $ job                 : int  1 1 3 1 1 3 1 0 3 0 ...
</pre></div></div>
</div>
<div class="section" id="Análisis-exploratorio">
<h3>Análisis exploratorio<a class="headerlink" href="#Análisis-exploratorio" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## Algunas de las columnas son numéricas y</span>
<span class="c1">## las otras son factores.</span>
<span class="c1">## DM corresponde a Deutsche Marks</span>
<span class="c1">## se verifican algunos valores versus el code book.</span>
<span class="c1">##</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">checking_balance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  0   1   2   3
269 274  63 394
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">savings_balance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  0   1   2   3   4
103  63 603  48 183
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## El monto del préstamo va desde 250 DM hasta 18.424 DM</span>
<span class="c1">##</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">amount</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
    250    1366    2320    3271    3972   18424
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## La duración del préstamo va desde 4 hasta 72 meses</span>
<span class="c1">##</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">months_loan_duration</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
    4.0    12.0    18.0    20.9    24.0    72.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## La columna default indica si hubo problemas</span>
<span class="c1">## en el pago del préstamo (1- pago, 2- no pago)</span>
<span class="c1">## esta es la columna que se desea pronosticar</span>
<span class="c1">## 1-si, 2-no</span>
<span class="c1">##</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  1   2
700 300
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## Se convierte la columna default a</span>
<span class="c1">## factores para su manejo en R</span>
<span class="c1">##</span>
<span class="n">df</span><span class="o">$</span><span class="n">default</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">default</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">,</span> <span class="s">&quot;Yes&quot;</span><span class="p">))</span>
<span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 No Yes
700 300
</pre></div></div>
</div>
</div>
<div class="section" id="id2">
<h3>Entrenamiento del modelo<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## Se usa el 90% de los datos para entrenamiento</span>
<span class="c1">## y el 10% restante para prueba</span>
<span class="c1">##</span>
<span class="n">train_sample</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">900</span>

<span class="c1">##</span>
<span class="c1">## Genera los conjuntos de entrenamiento y prueba. La</span>
<span class="c1">## columna 17 es la variable dependiente</span>
<span class="c1">##</span>
<span class="n">df_train</span>     <span class="o">&lt;-</span> <span class="n">df[train_sample</span><span class="p">,</span><span class="n">]</span>
<span class="n">df_test</span>      <span class="o">&lt;-</span> <span class="n">df[</span><span class="o">-</span><span class="n">train_sample</span><span class="p">,</span><span class="n">]</span>

<span class="c1">##</span>
<span class="c1">## Se verifica la proporción entre créditos pagados</span>
<span class="c1">## y no pagados en los dos conjuntos de datos</span>
<span class="c1">## conjunto de entrenamiento</span>
<span class="c1">##</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">df_train</span><span class="o">$</span><span class="n">defaul</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

       No       Yes
0.7022222 0.2977778
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## Proporción de casos para el conjunto de prueba</span>
<span class="c1">##</span>
<span class="nf">prop.table</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">df_test</span><span class="o">$</span><span class="n">default</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  No  Yes
0.68 0.32
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rpart</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">&lt;-</span> <span class="nf">rpart</span><span class="p">(</span><span class="n">default</span> <span class="o">~</span> <span class="n">.,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Call:
rpart(formula = default ~ ., data = df_train)
  n= 900

          CP nsplit rel error    xerror       xstd
1 0.03482587      0 1.0000000 1.0000000 0.05118820
2 0.02238806      5 0.7873134 0.9962687 0.05113302
3 0.01492537      7 0.7425373 0.8805970 0.04923614
4 0.01368159      9 0.7126866 0.8582090 0.04882534
5 0.01119403     12 0.6716418 0.8619403 0.04889484
6 0.01000000     13 0.6604478 0.8395522 0.04847157

Variable importance
    checking_balance months_loan_duration               amount
                  30                   17                   15
      credit_history      savings_balance        other_debtors
                   8                    6                    5
    installment_rate                  age     existing_credits
                   4                    4                    4
             purpose            telephone    employment_length
                   4                    1                    1
          dependents             property
                   1                    1

Node number 1: 900 observations,    complexity param=0.03482587
  predicted class=No   expected loss=0.2977778  P(node) =1
    class counts:   632   268
   probabilities: 0.702 0.298
  left son=2 (414 obs) right son=3 (486 obs)
  Primary splits:
      checking_balance     &lt; 1.5     to the right, improve=44.187500, (0 missing)
      credit_history       &lt; 0.5     to the left,  improve=12.332640, (0 missing)
      months_loan_duration &lt; 34.5    to the left,  improve=12.180660, (0 missing)
      amount               &lt; 10918   to the left,  improve= 9.173089, (0 missing)
      savings_balance      &lt; 2.5     to the right, improve= 7.320726, (0 missing)
  Surrogate splits:
      credit_history       &lt; 0.5     to the left,  agree=0.594, adj=0.118, (0 split)
      savings_balance      &lt; 2.5     to the right, agree=0.581, adj=0.089, (0 split)
      purpose              &lt; 6.5     to the right, agree=0.556, adj=0.034, (0 split)
      months_loan_duration &lt; 6.5     to the left,  agree=0.553, adj=0.029, (0 split)
      existing_credits     &lt; 1.5     to the right, agree=0.551, adj=0.024, (0 split)

Node number 2: 414 observations
  predicted class=No   expected loss=0.1280193  P(node) =0.46
    class counts:   361    53
   probabilities: 0.872 0.128

Node number 3: 486 observations,    complexity param=0.03482587
  predicted class=No   expected loss=0.4423868  P(node) =0.54
    class counts:   271   215
   probabilities: 0.558 0.442
  left son=6 (77 obs) right son=7 (409 obs)
  Primary splits:
      months_loan_duration &lt; 11.5    to the left,  improve=10.070930, (0 missing)
      credit_history       &lt; 1.5     to the left,  improve= 7.089452, (0 missing)
      amount               &lt; 10841.5 to the left,  improve= 5.029148, (0 missing)
      savings_balance      &lt; 2.5     to the right, improve= 4.808546, (0 missing)
      property             &lt; 2.5     to the left,  improve= 4.383809, (0 missing)
  Surrogate splits:
      amount         &lt; 527.5   to the left,  agree=0.856, adj=0.091, (0 split)
      age            &lt; 66.5    to the right, agree=0.846, adj=0.026, (0 split)
      foreign_worker &lt; 0.5     to the left,  agree=0.844, adj=0.013, (0 split)

Node number 6: 77 observations
  predicted class=No   expected loss=0.2077922  P(node) =0.08555556
    class counts:    61    16
   probabilities: 0.792 0.208

Node number 7: 409 observations,    complexity param=0.03482587
  predicted class=No   expected loss=0.4865526  P(node) =0.4544444
    class counts:   210   199
   probabilities: 0.513 0.487
  left son=14 (311 obs) right son=15 (98 obs)
  Primary splits:
      months_loan_duration &lt; 31.5    to the left,  improve=6.297416, (0 missing)
      savings_balance      &lt; 2.5     to the right, improve=5.725306, (0 missing)
      credit_history       &lt; 1.5     to the left,  improve=5.511386, (0 missing)
      installment_rate     &lt; 2.5     to the left,  improve=4.479824, (0 missing)
      checking_balance     &lt; 0.5     to the left,  improve=3.451949, (0 missing)
  Surrogate splits:
      amount   &lt; 6648    to the left,  agree=0.817, adj=0.235, (0 split)
      property &lt; 2.5     to the left,  agree=0.765, adj=0.020, (0 split)

Node number 14: 311 observations,    complexity param=0.03482587
  predicted class=No   expected loss=0.437299  P(node) =0.3455556
    class counts:   175   136
   probabilities: 0.563 0.437
  left son=28 (222 obs) right son=29 (89 obs)
  Primary splits:
      amount           &lt; 1381.5  to the right, improve=7.159329, (0 missing)
      credit_history   &lt; 1.5     to the left,  improve=5.254683, (0 missing)
      checking_balance &lt; 0.5     to the left,  improve=3.284545, (0 missing)
      installment_rate &lt; 2.5     to the left,  improve=3.112680, (0 missing)
      personal_status  &lt; 2.5     to the right, improve=2.872844, (0 missing)
  Surrogate splits:
      months_loan_duration &lt; 12.5    to the right, agree=0.730, adj=0.056, (0 split)
      purpose              &lt; 8.5     to the left,  agree=0.720, adj=0.022, (0 split)
      existing_credits     &lt; 3.5     to the left,  agree=0.717, adj=0.011, (0 split)

Node number 15: 98 observations,    complexity param=0.02238806
  predicted class=Yes  expected loss=0.3571429  P(node) =0.1088889
    class counts:    35    63
   probabilities: 0.357 0.643
  left son=30 (14 obs) right son=31 (84 obs)
  Primary splits:
      savings_balance   &lt; 3.5     to the right, improve=4.166667, (0 missing)
      age               &lt; 29.5    to the right, improve=2.688889, (0 missing)
      installment_rate  &lt; 2.5     to the left,  improve=1.507168, (0 missing)
      job               &lt; 1.5     to the right, improve=1.399225, (0 missing)
      residence_history &lt; 1.5     to the left,  improve=1.399225, (0 missing)

Node number 28: 222 observations,    complexity param=0.02238806
  predicted class=No   expected loss=0.3693694  P(node) =0.2466667
    class counts:   140    82
   probabilities: 0.631 0.369
  left son=56 (214 obs) right son=57 (8 obs)
  Primary splits:
      amount          &lt; 8724.5  to the left,  improve=4.243517, (0 missing)
      credit_history  &lt; 1.5     to the left,  improve=3.784535, (0 missing)
      savings_balance &lt; 2.5     to the right, improve=2.491677, (0 missing)
      personal_status &lt; 2.5     to the right, improve=2.306306, (0 missing)
      other_debtors   &lt; 0.5     to the right, improve=2.242471, (0 missing)

Node number 29: 89 observations,    complexity param=0.03482587
  predicted class=Yes  expected loss=0.3932584  P(node) =0.09888889
    class counts:    35    54
   probabilities: 0.393 0.607
  left son=58 (12 obs) right son=59 (77 obs)
  Primary splits:
      other_debtors        &lt; 1.5     to the left,  improve=7.599616, (0 missing)
      checking_balance     &lt; 0.5     to the left,  improve=3.569869, (0 missing)
      months_loan_duration &lt; 22.5    to the left,  improve=3.441434, (0 missing)
      purpose              &lt; 3.5     to the right, improve=3.391626, (0 missing)
      amount               &lt; 1324.5  to the left,  improve=2.718824, (0 missing)

Node number 30: 14 observations
  predicted class=No   expected loss=0.2857143  P(node) =0.01555556
    class counts:    10     4
   probabilities: 0.714 0.286

Node number 31: 84 observations,    complexity param=0.01368159
  predicted class=Yes  expected loss=0.297619  P(node) =0.09333333
    class counts:    25    59
   probabilities: 0.298 0.702
  left son=62 (53 obs) right son=63 (31 obs)
  Primary splits:
      age                  &lt; 29.5    to the right, improve=3.963844, (0 missing)
      months_loan_duration &lt; 43.5    to the left,  improve=3.174603, (0 missing)
      installment_rate     &lt; 2.5     to the left,  improve=1.456236, (0 missing)
      employment_length    &lt; 1.5     to the right, improve=1.052686, (0 missing)
      residence_history    &lt; 3.5     to the left,  improve=1.052686, (0 missing)
  Surrogate splits:
      property             &lt; 0.5     to the right, agree=0.679, adj=0.129, (0 split)
      employment_length    &lt; 0.5     to the right, agree=0.655, adj=0.065, (0 split)
      months_loan_duration &lt; 57      to the left,  agree=0.643, adj=0.032, (0 split)
      credit_history       &lt; 0.5     to the right, agree=0.643, adj=0.032, (0 split)
      amount               &lt; 7973.5  to the left,  agree=0.643, adj=0.032, (0 split)

Node number 56: 214 observations,    complexity param=0.01492537
  predicted class=No   expected loss=0.3504673  P(node) =0.2377778
    class counts:   139    75
   probabilities: 0.650 0.350
  left son=112 (70 obs) right son=113 (144 obs)
  Primary splits:
      credit_history   &lt; 1.5     to the left,  improve=3.091414, (0 missing)
      housing          &lt; 1.5     to the left,  improve=2.070713, (0 missing)
      savings_balance  &lt; 2.5     to the right, improve=1.938212, (0 missing)
      installment_rate &lt; 2.5     to the left,  improve=1.816577, (0 missing)
      personal_status  &lt; 2.5     to the right, improve=1.754505, (0 missing)
  Surrogate splits:
      existing_credits &lt; 1.5     to the right, agree=0.790, adj=0.357, (0 split)
      job              &lt; 0.5     to the left,  agree=0.687, adj=0.043, (0 split)
      amount           &lt; 1409.5  to the left,  agree=0.678, adj=0.014, (0 split)
      age              &lt; 65.5    to the right, agree=0.678, adj=0.014, (0 split)
      foreign_worker   &lt; 0.5     to the left,  agree=0.678, adj=0.014, (0 split)

Node number 57: 8 observations
  predicted class=Yes  expected loss=0.125  P(node) =0.008888889
    class counts:     1     7
   probabilities: 0.125 0.875

Node number 58: 12 observations
  predicted class=No   expected loss=0.08333333  P(node) =0.01333333
    class counts:    11     1
   probabilities: 0.917 0.083

Node number 59: 77 observations
  predicted class=Yes  expected loss=0.3116883  P(node) =0.08555556
    class counts:    24    53
   probabilities: 0.312 0.688

Node number 62: 53 observations,    complexity param=0.01368159
  predicted class=Yes  expected loss=0.4150943  P(node) =0.05888889
    class counts:    22    31
   probabilities: 0.415 0.585
  left son=124 (34 obs) right son=125 (19 obs)
  Primary splits:
      months_loan_duration &lt; 47.5    to the left,  improve=3.918512, (0 missing)
      installment_rate     &lt; 2.5     to the left,  improve=3.544940, (0 missing)
      residence_history    &lt; 3.5     to the left,  improve=2.673171, (0 missing)
      age                  &lt; 56      to the left,  improve=2.003526, (0 missing)
      credit_history       &lt; 1.5     to the left,  improve=1.075532, (0 missing)
  Surrogate splits:
      amount   &lt; 6048.5  to the left,  agree=0.698, adj=0.158, (0 split)
      age      &lt; 57.5    to the left,  agree=0.698, adj=0.158, (0 split)
      purpose  &lt; 0.5     to the right, agree=0.679, adj=0.105, (0 split)
      property &lt; 2.5     to the left,  agree=0.660, adj=0.053, (0 split)

Node number 63: 31 observations
  predicted class=Yes  expected loss=0.09677419  P(node) =0.03444444
    class counts:     3    28
   probabilities: 0.097 0.903

Node number 112: 70 observations
  predicted class=No   expected loss=0.2285714  P(node) =0.07777778
    class counts:    54    16
   probabilities: 0.771 0.229

Node number 113: 144 observations,    complexity param=0.01492537
  predicted class=No   expected loss=0.4097222  P(node) =0.16
    class counts:    85    59
   probabilities: 0.590 0.410
  left son=226 (118 obs) right son=227 (26 obs)
  Primary splits:
      existing_credits &lt; 1.5     to the left,  improve=3.781852, (0 missing)
      credit_history   &lt; 3.5     to the right, improve=2.308216, (0 missing)
      installment_rate &lt; 2.5     to the left,  improve=2.188430, (0 missing)
      amount           &lt; 2478    to the right, improve=1.862991, (0 missing)
      housing          &lt; 1.5     to the left,  improve=1.403523, (0 missing)
  Surrogate splits:
      credit_history &lt; 2.5     to the right, agree=0.896, adj=0.423, (0 split)
      amount         &lt; 7915.5  to the left,  agree=0.840, adj=0.115, (0 split)

Node number 124: 34 observations,    complexity param=0.01368159
  predicted class=No   expected loss=0.4411765  P(node) =0.03777778
    class counts:    19    15
   probabilities: 0.559 0.441
  left son=248 (19 obs) right son=249 (15 obs)
  Primary splits:
      installment_rate     &lt; 3.5     to the left,  improve=4.582250, (0 missing)
      amount               &lt; 4625    to the right, improve=3.122601, (0 missing)
      months_loan_duration &lt; 37.5    to the right, improve=1.568939, (0 missing)
      credit_history       &lt; 1.5     to the left,  improve=1.355615, (0 missing)
      residence_history    &lt; 3.5     to the left,  improve=0.807563, (0 missing)
  Surrogate splits:
      purpose           &lt; 6.5     to the left,  agree=0.794, adj=0.533, (0 split)
      amount            &lt; 4210    to the right, agree=0.794, adj=0.533, (0 split)
      age               &lt; 56      to the left,  agree=0.676, adj=0.267, (0 split)
      employment_length &lt; 0.5     to the right, agree=0.647, adj=0.200, (0 split)
      dependents        &lt; 1.5     to the right, agree=0.647, adj=0.200, (0 split)

Node number 125: 19 observations
  predicted class=Yes  expected loss=0.1578947  P(node) =0.02111111
    class counts:     3    16
   probabilities: 0.158 0.842

Node number 226: 118 observations
  predicted class=No   expected loss=0.3559322  P(node) =0.1311111
    class counts:    76    42
   probabilities: 0.644 0.356

Node number 227: 26 observations,    complexity param=0.01119403
  predicted class=Yes  expected loss=0.3461538  P(node) =0.02888889
    class counts:     9    17
   probabilities: 0.346 0.654
  left son=454 (15 obs) right son=455 (11 obs)
  Primary splits:
      amount               &lt; 3106.5  to the right, improve=4.569231, (0 missing)
      installment_rate     &lt; 2.5     to the left,  improve=2.507326, (0 missing)
      housing              &lt; 1.5     to the left,  improve=1.969231, (0 missing)
      months_loan_duration &lt; 25      to the right, improve=1.797009, (0 missing)
      age                  &lt; 29      to the right, improve=1.435897, (0 missing)
  Surrogate splits:
      months_loan_duration &lt; 22.5    to the right, agree=0.808, adj=0.545, (0 split)
      credit_history       &lt; 2.5     to the left,  agree=0.731, adj=0.364, (0 split)
      installment_rate     &lt; 2.5     to the left,  agree=0.731, adj=0.364, (0 split)
      telephone            &lt; 0.5     to the right, agree=0.692, adj=0.273, (0 split)
      purpose              &lt; 6       to the left,  agree=0.654, adj=0.182, (0 split)

Node number 248: 19 observations
  predicted class=No   expected loss=0.2105263  P(node) =0.02111111
    class counts:    15     4
   probabilities: 0.789 0.211

Node number 249: 15 observations
  predicted class=Yes  expected loss=0.2666667  P(node) =0.01666667
    class counts:     4    11
   probabilities: 0.267 0.733

Node number 454: 15 observations
  predicted class=No   expected loss=0.4  P(node) =0.01666667
    class counts:     9     6
   probabilities: 0.600 0.400

Node number 455: 11 observations
  predicted class=Yes  expected loss=0  P(node) =0.01222222
    class counts:     0    11
   probabilities: 0.000 1.000

</pre></div></div>
</div>
<p>El último resultado indica que hay 135 errores en 900 ejemplos.</p>
</div>
<div class="section" id="Evaluación-del-modelo">
<h3>Evaluación del modelo<a class="headerlink" href="#Evaluación-del-modelo" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## Se evaluar el modelo con los datos de prueba</span>
<span class="c1">## install.packages(&quot;gmodels&quot;)</span>
<span class="c1">##</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gmodels</span><span class="p">)</span>
<span class="n">y_test_pred</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#39;class&#39;</span><span class="p">)</span>
<span class="nf">CrossTable</span><span class="p">(</span><span class="n">df_test</span><span class="o">$</span><span class="n">default</span><span class="p">,</span>
           <span class="n">y_test_pred</span><span class="p">,</span>
           <span class="n">prop.chisq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.c</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.r</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">dnn</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;actual default&#39;</span><span class="p">,</span> <span class="s">&#39;predicted default&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


   Cell Contents
|-------------------------|
|                       N |
|         N / Table Total |
|-------------------------|


Total Observations in Table:  100


               | predicted default
actual default |        No |       Yes | Row Total |
---------------|-----------|-----------|-----------|
            No |        60 |         8 |        68 |
               |     0.600 |     0.080 |           |
---------------|-----------|-----------|-----------|
           Yes |        23 |         9 |        32 |
               |     0.230 |     0.090 |           |
---------------|-----------|-----------|-----------|
  Column Total |        83 |        17 |       100 |
---------------|-----------|-----------|-----------|


</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Mejora-del-modelo">
<h2>Mejora del modelo<a class="headerlink" href="#Mejora-del-modelo" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="Adaptive-Boosting">
<h3>Adaptive Boosting<a class="headerlink" href="#Adaptive-Boosting" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ya que la precisión del modelo presentado para este caso no es suficiente, se aplica la técnica de adaptive boosting. En esta técnica se entrenan muchos árboles simultáneamente sobre los datos; cuando hay un nuevo ejemplo, cada árbol pronóstica la clase y la clasificación final se obtiene por voto (mayoría).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">clf10</span> <span class="o">&lt;-</span> <span class="nf">C5.0</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
              <span class="n">y_train_true</span><span class="p">,</span>
              <span class="n">trials</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>    <span class="c1"># cantidad de árboles a considerar</span>

<span class="n">clf10</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
R[write to console]: Error in C5.0(X_train, y_train_true, trials = 10) :
  could not find function &#34;C5.0&#34;
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Error in C5.0(X_train, y_train_true, trials = 10) :
  could not find function &#34;C5.0&#34;
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">## imprime todos los arboles</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">clf10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
R[write to console]: Error in summary(clf10) : object &#39;clf10&#39; not found
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible -&gt; summary

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Error in summary(clf10) : object &#39;clf10&#39; not found
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible -&gt; summary
</pre></div></div>
</div>
<p>El resultado anterior indica que hay 29 errores en 900 patrones de entrenamiento.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">y_test_pred10</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">clf10</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>

<span class="nf">CrossTable</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span>
           <span class="n">y_test_pred10</span><span class="p">,</span>
           <span class="n">prop.chisq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.c</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.r</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">dnn</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;actual default&#39;</span><span class="p">,</span> <span class="s">&#39;predicted default&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
R[write to console]: Error in predict(clf10, X_test) : object &#39;clf10&#39; not found
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible -&gt; predict

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Error in predict(clf10, X_test) : object &#39;clf10&#39; not found
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible -&gt; predict
</pre></div></div>
</div>
</div>
<div class="section" id="Uso-de-pesos-por-tipo-de-error">
<h3>Uso de pesos por tipo de error<a class="headerlink" href="#Uso-de-pesos-por-tipo-de-error" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Es posible introducir pesos para hacer más costoso un tipo de error que otro.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">matrix_dimensions</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="n">predicted</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">,</span> <span class="s">&quot;Yes&quot;</span><span class="p">),</span> <span class="n">actual</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;No&quot;</span><span class="p">,</span> <span class="s">&quot;Yes&quot;</span><span class="p">))</span>
<span class="nf">str</span><span class="p">(</span><span class="n">matrix_dimensions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
List of 2
 $ predicted: chr [1:2] &#34;No&#34; &#34;Yes&#34;
 $ actual   : chr [1:2] &#34;No&#34; &#34;Yes&#34;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">error_cost</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="c1"># pesos por tipo de error</span>
                     <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                     <span class="n">dimnames</span> <span class="o">=</span> <span class="n">matrix_dimensions</span><span class="p">)</span>
<span class="n">error_cost</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         actual
predicted No Yes
      No   0   4
      Yes  1   0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">clf_cost</span> <span class="o">&lt;-</span> <span class="nf">C5.0</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
                 <span class="n">y_train_true</span><span class="p">,</span>
                 <span class="n">costs</span> <span class="o">=</span> <span class="n">error_cost</span><span class="p">)</span>

<span class="n">y_test_pred_cost</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">clf_cost</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>

<span class="nf">CrossTable</span><span class="p">(</span><span class="n">y_test_true</span><span class="p">,</span>
           <span class="n">y_test_pred_cost</span><span class="p">,</span>
           <span class="n">prop.chisq</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.c</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">prop.r</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           <span class="n">dnn</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;actual default&#39;</span><span class="p">,</span> <span class="s">&#39;predicted default&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
R[write to console]: Error in C5.0(X_train, y_train_true, costs = error_cost) :
  could not find function &#34;C5.0&#34;
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Error in C5.0(X_train, y_train_true, costs = error_cost) :
  could not find function &#34;C5.0&#34;
Calls: &lt;Anonymous&gt; -&gt; &lt;Anonymous&gt; -&gt; withVisible
</pre></div></div>
</div>
<p><strong>Actividad.—</strong> Respecto a los dos casos anteriores, ¿Cómo se interpreta la tabla anterior?</p>
<p><strong>Actividad.—</strong> Compute metricas de error y compare los resultados obtenidos?</p>
<p><strong>Actividad.—</strong> Haga la estimación robusta del mdoelo usando cross-validation.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>