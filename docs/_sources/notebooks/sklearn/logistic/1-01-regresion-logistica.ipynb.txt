{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Regresión Logística\n",
    "===\n",
    "\n",
    "* *45 min* | Ultima modificación: Junio 22, 2019"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Descripción del problema"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Se desea determinar a cuál clase ($A$, $B$ o $C$) pertenece un elemento, a partir de resultados previamente recolectados."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.datasets import make_blobs\n",
    "\n",
    "NPOINTS = 150\n",
    "\n",
    "X, d = make_blobs(\n",
    "    n_samples=NPOINTS, \n",
    "    n_features=2,\n",
    "    centers=3,\n",
    "    cluster_std=0.8, \n",
    "    shuffle=False,  \n",
    "    random_state=12345)\n",
    "\n",
    "plt.scatter(X[:50,0], X[:50,1], color='red')\n",
    "plt.scatter(X[50:100,0], X[50:100,1], color='blue')\n",
    "plt.scatter(X[100:,0], X[100:,1], color='green')\n",
    "plt.gca().set_aspect('equal', adjustable='box')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Regresión Logística"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "La solución anterior muestra los inconvenientes de abordar problemas de clasificación como problemas de regresión. Un problema similar ocurrio con la clasificación usando perceptrones bipolares. Este impase puede ser resuelto si se tiene en cuenta que un perceptrón continuo con función sigmoidea es equivalente a un modelo de regresión logística.\n",
    "\n",
    "En este caso, la ecuación del perceptrón \n",
    "\n",
    "$$y = \\sigma \\left( \\sum_{i=0}^n w_{i,k} x_{i,k} \\right)$$\n",
    "\n",
    "puede interpretarse como la probabilidad de que el punto $\\mathbf{x}_i$ pertenezca a la clase de interés."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En la regresión logística, los parámetros del modelo se estiman a través de la minimización de la función de entropía cruzada, definida como:\n",
    "\n",
    "$$ \\frac{1}{P} \\sum_i^P d_i \\cdot \\log(\\text{prob}(y_i)) + \n",
    "(1-d_i) \\cdot \\log(1- \\text{prob}(y_i))\n",
    "$$ "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En la regresión logística se desea construir un modelo que permite determinar si un patrón ($x_1$, $x_2$) pertenece a una clase determinada o no. Ya que el ejemplo presentado contiene más de dos clases debe ser recodificado; una forma es especificar un modelo que indique si ($x_1$, $x_2$) pertenece a la clase $A$ o al resto (las clases {$A$, $B$}); y otro modelo que indique si pertenece a la clase $B$ o no. Si el patrón no pertenece ni a $A$ ni a $B$, entonces pertenece a $C$. La secuencia de decisiones descrita puede ser representada por un árbol de decisiones."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A partir de este punto, el problema consiste en determinar si un patrón pertenece a una de dos clases mutuamente exclusivas y colectivamente exhaustivas (un patrón no puede pertenecer a las dos clases simultáneamente y cada patrón debe pertenecer a una clase de las dos clases posibles). Si se usa una variable indicadora $y$ que vale $1$ cuando el patrón pertenece a la clase $A$ y cero cuando no pertenece, entonces se podría plantear un modelo lineal de la forma:\n",
    "\n",
    "$$ y =\n",
    "   \\begin{cases}\n",
    "      1, & \\text{if $\\theta_0 + \\theta_1 x_1 + \\theta_2 x_2 > 0$} \\\\\n",
    "      \\\\\n",
    "      0, &\\text{en caso contrario.}\n",
    "   \\end{cases}\n",
    "$$\n",
    "\n",
    "La estimación de los parámetros del modelo de regresión en la ecuación anterior no puede realizarse usando regresión lineal.\n",
    "\n",
    "En la siguiente figura, se presenta un ejemplo con un grupo de puntos en el eje $X$ que pertenecen a una de dos clases; si $y=1$ el punto pertenece a la clase $A$ y en caso contrario a la clase $B$. Si se ajusta un modelo de regresión lineal de la forma:\n",
    "\n",
    "$$y = \\theta_0 + \\theta_1 x$$\n",
    "\n",
    "se obtiene la línea recta que aparece en dicha figura."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![assets/logreg-1.jpg](assets/logreg-1.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Como puede observarse, el modelo no permite realizar la discriminación entre las clases de cada punto. Para ello, los valores de $y$ deben limitarse al intervalo $[0, 1]$.  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "La función logística es definida como:\n",
    "\n",
    "$$\\sigma(u) = \\frac{1}{1+\\exp(-u)}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![assets/logreg-2.jpg](assets/logreg-2.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "La regresión logística se define como:\n",
    "\n",
    "$$y = \\sigma(\\theta_0 + \\theta_1 x_1 + \\theta_2 x_2)$$\n",
    "\n",
    "La cual puede interpretarse como la probabilidad de que el punto ($x_1$, $x_2$) pertenezca a la clase $A$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Al aplicar la regresión logística al segundo ejemplo planteado se obtiene la línea roja de la figura de abajo, la cual representa la probabilidad de pertenencia de un punto a la clase $A$. Para $y$ = 0.5, hay una probabilidad del 50% de que el patrón pertenezca a la clase $A$ y 50% de que no pertenezca; este es un punto de indeterminación, de tal forma que el punto $x$ en que se da esta valor se conoce como frontera de decisión.  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![assets/logreg-3.jpg](assets/logreg-3.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En la siguiente figura se presenta un problema de clasificación para tres clases diferentes. Cada línea representa la frontera de decisión entre un grupo y los demás. Si las flechas indican la probabilidad de pertenencia a un grupo, noté que hay una región de indeterminación en el centro."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![assets/logreg-4.jpg](assets/logreg-4.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Solución usando Python"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n",
       "       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n",
       "       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n",
       "       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n",
       "       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.metrics import log_loss\n",
    "\n",
    "logisticRegression = LogisticRegression(\n",
    "    penalty='l2',            # ‘l1’, ‘l2’, ‘elasticnet’, ‘none’\n",
    "    tol=0.0001,              # stop criteria\n",
    "    C=1.0,                   # factor inverso para regularizacion (SVM)\n",
    "    fit_intercept=True,      #\n",
    "    class_weight=None,       # None, dict or ‘balanced’\n",
    "    random_state=None,       # \n",
    "    solver='lbfgs',          # 'newton-cg’, ‘lbfgs’, ‘liblinear’, ‘sag’, ‘saga’\n",
    "    max_iter=100,            #\n",
    "    multi_class='auto',      # ‘ovr’, ‘multinomial’, ‘auto’\n",
    "    verbose=0,               # \n",
    "    warm_start=False,        # ?re-usa la solución previa\n",
    "    l1_ratio=None            # Elastic-Net mixing parameter, with 0 <= l1_ratio <= 1\n",
    ")\n",
    "\n",
    "logisticRegression.fit(X, d)\n",
    "\n",
    "logisticRegression.predict(X)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logisticRegression.predict([[2.5, -4.0]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([-2.3011144 , -0.84597237,  3.14708678])"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logisticRegression.intercept_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 0.72852127, -0.43464882],\n",
       "       [-0.59331499, -0.4699242 ],\n",
       "       [-0.13520628,  0.90457302]])"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logisticRegression.coef_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(X[:50,0], X[:50,1], color='red')\n",
    "plt.scatter(X[50:100,0], X[50:100,1], color='blue')\n",
    "plt.scatter(X[100:,0], X[100:,1], color='green')\n",
    "plt.gca().set_aspect('equal', adjustable='box')\n",
    "\n",
    "xlim = plt.gca().get_xlim()\n",
    "ylim = plt.gca().get_ylim()\n",
    "\n",
    "xplot = np.linspace(start=xlim[0], stop=xlim[1], num=20)\n",
    "\n",
    "fronteraA = (- logisticRegression.intercept_[0] / logisticRegression.coef_[0][1] \n",
    "             - logisticRegression.coef_[0][0] / logisticRegression.coef_[0][1] * xplot)\n",
    "\n",
    "fronteraB = (- logisticRegression.intercept_[1] / logisticRegression.coef_[1][1] \n",
    "             - logisticRegression.coef_[1][0] / logisticRegression.coef_[1][1] * xplot)\n",
    "\n",
    "fronteraC = (- logisticRegression.intercept_[2] / logisticRegression.coef_[2][1] \n",
    "             - logisticRegression.coef_[2][0] / logisticRegression.coef_[2][1] * xplot)\n",
    "\n",
    "plt.plot(xplot, fronteraA, color='red', linewidth=3)\n",
    "plt.plot(xplot, fronteraB, color='blue', linewidth=3)\n",
    "plt.plot(xplot, fronteraC, color='green', linewidth=3);\n",
    "\n",
    "plt.xlim(xlim)\n",
    "plt.ylim(ylim);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[9.98661503e-01, 5.11632194e-05, 1.28733409e-03],\n",
       "       [9.97709742e-01, 2.43339689e-05, 2.26592371e-03],\n",
       "       [9.99853268e-01, 2.03670814e-05, 1.26364523e-04],\n",
       "       [9.98884814e-01, 4.22746463e-05, 1.07291161e-03],\n",
       "       [9.98956200e-01, 1.32743179e-05, 1.03052555e-03],\n",
       "       [9.96811239e-01, 4.76528501e-04, 2.71223203e-03],\n",
       "       [9.99789658e-01, 9.87278646e-06, 2.00468825e-04],\n",
       "       [9.97446880e-01, 9.92161954e-05, 2.45390423e-03],\n",
       "       [9.99962062e-01, 1.88831023e-06, 3.60493693e-05],\n",
       "       [9.98169070e-01, 1.04321247e-04, 1.72660864e-03]])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "logisticRegression.predict_proba(X)[0:10]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Solución usando R"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "%load_ext rpy2.ipython"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.DataFrame(X, columns=['x1', 'x2'])\n",
    "df['y'] = d"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t150 obs. of  3 variables:\n",
      " $ x1: num  8.67 9.21 9.4 8.81 9.67 ...\n",
      " $ x2: num  -3.45 -2.68 -4.71 -3.49 -2.96 ...\n",
      " $ y : int  0 0 0 0 0 0 0 0 0 0 ...\n"
     ]
    }
   ],
   "source": [
    "%%R -i df\n",
    "str(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Actividad.--** Para los datos propuestos, estime tres regresiones logísticas que permitan determinar si un punto pertenece a un clase o al resto. Grafique los puntos y las fronteras de decisión.\n",
    "\n",
    "A continuación se utilizará el lenguaje R para realizar la actividad:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "R[write to console]: Loading required package: Matrix\n",
      "\n",
      "R[write to console]: Loading required package: foreach\n",
      "\n",
      "R[write to console]: Loaded glmnet 2.0-18\n",
      "\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "          x1        x2 y\n",
      "144 1.402550 1.7304749 2\n",
      "145 2.434281 2.9911338 2\n",
      "146 1.045178 2.6036857 2\n",
      "147 2.752287 0.7826971 2\n",
      "148 1.051907 1.6342375 2\n",
      "149 1.658551 2.0620898 2\n"
     ]
    }
   ],
   "source": [
    "%%R\n",
    "##\n",
    "## se carga la librería\n",
    "##\n",
    "library(glmnet)\n",
    "\n",
    "##\n",
    "## Modelo 1.\n",
    "## A contra otros (B y C)\n",
    "##  \n",
    "df1 <- df                        ## se crea una copia del dataframe original\n",
    "df1$y <- gsub(\"A\", 1, df1$y)     ## se cambia la clase A por el número 1\n",
    "df1$y <- gsub(\"B\", 2, df1$y)     ## se cambia la clase B por el número 2\n",
    "df1$y <- gsub(\"C\", 2, df1$y)     ## se cambia la clase C por el número 2\n",
    "tail(df1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%R\n",
    "x <- as.matrix(df1[,c('x1','x2')])   ## se genera una matriz con las variables regresoras (x1, x2)\n",
    "y <- df1$y                           ## se crea un vector que contenga la variable de decisión (clase)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "La función `gmlnet` entrena la regresión logística a partir de la iteración del modelo con diferentes lambdas, en donde trata de minimizar la suma de errores al cuadrado, por defecto. La salida sería aproximadamente 100 valores estimados de parámetros para diferentes niveles de lambda, como se muestra a continuación:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Call:  glmnet(x = x, y = y, family = \"multinomial\") \n",
      "\n",
      "      Df       %Dev    Lambda\n",
      " [1,]  0 -1.213e-15 0.4398000\n",
      " [2,]  2  8.146e-02 0.4008000\n",
      " [3,]  2  2.059e-01 0.3652000\n",
      " [4,]  2  3.081e-01 0.3327000\n",
      " [5,]  2  3.923e-01 0.3032000\n",
      " [6,]  2  4.630e-01 0.2762000\n",
      " [7,]  2  5.232e-01 0.2517000\n",
      " [8,]  2  5.750e-01 0.2293000\n",
      " [9,]  2  6.199e-01 0.2090000\n",
      "[10,]  2  6.592e-01 0.1904000\n",
      "[11,]  2  6.937e-01 0.1735000\n",
      "[12,]  2  7.242e-01 0.1581000\n",
      "[13,]  2  7.513e-01 0.1440000\n",
      "[14,]  2  7.754e-01 0.1312000\n",
      "[15,]  2  7.969e-01 0.1196000\n",
      "[16,]  2  8.161e-01 0.1089000\n",
      "[17,]  2  8.334e-01 0.0992700\n",
      "[18,]  2  8.489e-01 0.0904500\n",
      "[19,]  2  8.629e-01 0.0824200\n",
      "[20,]  2  8.755e-01 0.0750900\n",
      "[21,]  2  8.869e-01 0.0684200\n",
      "[22,]  2  8.972e-01 0.0623500\n",
      "[23,]  2  9.065e-01 0.0568100\n",
      "[24,]  2  9.149e-01 0.0517600\n",
      "[25,]  2  9.225e-01 0.0471600\n",
      "[26,]  2  9.295e-01 0.0429700\n",
      "[27,]  2  9.357e-01 0.0391500\n",
      "[28,]  2  9.415e-01 0.0356800\n",
      "[29,]  2  9.467e-01 0.0325100\n",
      "[30,]  2  9.514e-01 0.0296200\n",
      "[31,]  2  9.557e-01 0.0269900\n",
      "[32,]  2  9.596e-01 0.0245900\n",
      "[33,]  2  9.631e-01 0.0224100\n",
      "[34,]  2  9.664e-01 0.0204200\n",
      "[35,]  2  9.693e-01 0.0186000\n",
      "[36,]  2  9.720e-01 0.0169500\n",
      "[37,]  2  9.745e-01 0.0154400\n",
      "[38,]  2  9.767e-01 0.0140700\n",
      "[39,]  2  9.787e-01 0.0128200\n",
      "[40,]  2  9.806e-01 0.0116800\n",
      "[41,]  2  9.823e-01 0.0106400\n",
      "[42,]  2  9.838e-01 0.0096990\n",
      "[43,]  2  9.852e-01 0.0088370\n",
      "[44,]  2  9.865e-01 0.0080520\n",
      "[45,]  2  9.877e-01 0.0073370\n",
      "[46,]  2  9.887e-01 0.0066850\n",
      "[47,]  2  9.897e-01 0.0060910\n",
      "[48,]  2  9.906e-01 0.0055500\n",
      "[49,]  2  9.914e-01 0.0050570\n",
      "[50,]  2  9.922e-01 0.0046080\n",
      "[51,]  2  9.928e-01 0.0041980\n",
      "[52,]  2  9.935e-01 0.0038250\n",
      "[53,]  2  9.940e-01 0.0034860\n",
      "[54,]  2  9.946e-01 0.0031760\n",
      "[55,]  2  9.950e-01 0.0028940\n",
      "[56,]  2  9.955e-01 0.0026370\n",
      "[57,]  2  9.958e-01 0.0024020\n",
      "[58,]  2  9.962e-01 0.0021890\n",
      "[59,]  2  9.965e-01 0.0019950\n",
      "[60,]  2  9.968e-01 0.0018170\n",
      "[61,]  2  9.971e-01 0.0016560\n",
      "[62,]  2  9.974e-01 0.0015090\n",
      "[63,]  2  9.976e-01 0.0013750\n",
      "[64,]  2  9.978e-01 0.0012530\n",
      "[65,]  2  9.980e-01 0.0011410\n",
      "[66,]  2  9.982e-01 0.0010400\n",
      "[67,]  2  9.983e-01 0.0009476\n",
      "[68,]  2  9.985e-01 0.0008634\n",
      "[69,]  2  9.986e-01 0.0007867\n",
      "[70,]  2  9.987e-01 0.0007168\n",
      "[71,]  2  9.988e-01 0.0006531\n",
      "[72,]  2  9.989e-01 0.0005951\n",
      "[73,]  2  9.990e-01 0.0005422\n"
     ]
    }
   ],
   "source": [
    "%%R\n",
    "##\n",
    "## Se entra el modelo.\n",
    "##\n",
    "glm.fit <- glmnet(x, y, family = 'multinomial')\n",
    "glm.fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "$`0`\n",
      "3 x 1 sparse Matrix of class \"dgCMatrix\"\n",
      "                    1\n",
      "(Intercept) -1.405481\n",
      "x1           0.504727\n",
      "x2           .       \n",
      "\n",
      "$`1`\n",
      "3 x 1 sparse Matrix of class \"dgCMatrix\"\n",
      "                     1\n",
      "(Intercept) -0.6727753\n",
      "x1          -0.1576664\n",
      "x2           .        \n",
      "\n",
      "$`2`\n",
      "3 x 1 sparse Matrix of class \"dgCMatrix\"\n",
      "                   1\n",
      "(Intercept) 2.078256\n",
      "x1          .       \n",
      "x2          1.150638\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%%R\n",
    "##\n",
    "## es posible acceder a diferentes modelos para diferentes niveles de lambda\n",
    "## en este caso se escoge un nivel de 0.01\n",
    "## la salida corresponde a los parametros teta estudiados anteriormente en módulo\n",
    "##\n",
    "c <- coef(glm.fit,s =0.01)\n",
    "c"
   ]
  }
 ],
 "metadata": {
  "kernel_info": {
   "name": "python3"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.9"
  },
  "nteract": {
   "version": "0.7.1"
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
